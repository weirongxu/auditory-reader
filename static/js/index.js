(() => { // webpackBootstrap
"use strict";
var __webpack_modules__ = ({
"./src/web/app.scss?28ee": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
// extracted by css-extract-rspack-plugin

    if(true) {
      (function() {
        var localsJsonString = undefined;
        // 1727937534673
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/common/hint-text.module.scss?893b": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"hint":"src-web-common-hint-text-module__hint-cMFGU8"});
    if(true) {
      (function() {
        var localsJsonString = "{\"hint\":\"src-web-common-hint-text-module__hint-cMFGU8\"}";
        // 1727937534697
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/components/file-input.module.scss?dcfe": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"fileInput":"src-web-components-file-input-module__fileInput-jzkJ9C"});
    if(true) {
      (function() {
        var localsJsonString = "{\"fileInput\":\"src-web-components-file-input-module__fileInput-jzkJ9C\"}";
        // 1727937534712
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/components/pinch-zoom-pan.module.scss?da6f": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"overlay":"src-web-components-pinch-zoom-pan-module__overlay-RAuidH","container":"src-web-components-pinch-zoom-pan-module__container-s1K_V6","center":"src-web-components-pinch-zoom-pan-module__center-V6m0hj"});
    if(true) {
      (function() {
        var localsJsonString = "{\"overlay\":\"src-web-components-pinch-zoom-pan-module__overlay-RAuidH\",\"container\":\"src-web-components-pinch-zoom-pan-module__container-s1K_V6\",\"center\":\"src-web-components-pinch-zoom-pan-module__center-V6m0hj\"}";
        // 1727937534697
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/hotkey/hotkey-state.module.scss?d255": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"hotkeyList":"src-web-hotkey-hotkey-state-module__hotkeyList-X2vODR"});
    if(true) {
      (function() {
        var localsJsonString = "{\"hotkeyList\":\"src-web-hotkey-hotkey-state-module__hotkeyList-X2vODR\"}";
        // 1727937534672
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/pages/books/index.module.scss?58d9": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"hover":"src-web-pages-books-index-module__hover-MhvhD5","table":"src-web-pages-books-index-module__table-OXXVHq"});
    if(true) {
      (function() {
        var localsJsonString = "{\"hover\":\"src-web-pages-books-index-module__hover-MhvhD5\",\"table\":\"src-web-pages-books-index-module__table-OXXVHq\"}";
        // 1727937534710
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/pages/books/view.module.scss?b37e": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"contentWrapper":"src-web-pages-books-view-module__contentWrapper-xRbIAt"});
    if(true) {
      (function() {
        var localsJsonString = "{\"contentWrapper\":\"src-web-pages-books-view-module__contentWrapper-xRbIAt\"}";
        // 1727937534701
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/pages/books/view/book-search.module.scss?2c98": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"bookSearchResult":"src-web-pages-books-view-book-search-module__bookSearchResult-wN3fTI"});
    if(true) {
      (function() {
        var localsJsonString = "{\"bookSearchResult\":\"src-web-pages-books-view-book-search-module__bookSearchResult-wN3fTI\"}";
        // 1727937534714
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/pages/layout/layout.module.scss?68dd": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return __WEBPACK_DEFAULT_EXPORT__; }
});
// extracted by css-extract-rspack-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"appBar":"src-web-pages-layout-layout-module__appBar-h5IaFg"});
    if(true) {
      (function() {
        var localsJsonString = "{\"appBar\":\"src-web-pages-layout-layout-module__appBar-h5IaFg\"}";
        // 1727937534672
        var cssReload = (__webpack_require__("./node_modules/.pnpm/@rspack+core@1.0.8_@swc+helpers@0.5.13/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/web/pages/books/view/sound/keyboard.mp3": (function (module, __unused_webpack_exports, __webpack_require__) {
module.exports = __webpack_require__.p + "static/media/keyboard.983b6fe1.mp3";

}),
"./src/web/pages/books/view/sound/next-page.mp3": (function (module, __unused_webpack_exports, __webpack_require__) {
module.exports = __webpack_require__.p + "static/media/next-page.2cb810bd.mp3";

}),
"./src/web/pages/books/view/sound/rain-loop.mp3": (function (module, __unused_webpack_exports, __webpack_require__) {
module.exports = __webpack_require__.p + "static/media/rain-loop.769e8d4a.mp3";

}),
"./src/web/pages/books/view/sound/rewind.mp3": (function (module, __unused_webpack_exports, __webpack_require__) {
module.exports = __webpack_require__.p + "static/media/rewind.3bbb7b0e.mp3";

}),
"./src/web/pages/books/view/sound/shutter.mp3": (function (module, __unused_webpack_exports, __webpack_require__) {
module.exports = __webpack_require__.p + "static/media/shutter.37b7999d.mp3";

}),
"./src/core/book/enums.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  sortOrders: function() { return sortOrders; }
});
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
const sortOrders = [
    'default',
    'reverse',
    'name',
    'name-reverse'
];

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/route/use-fetch.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useFetch: function() { return useFetch; },
  useFetchBase: function() { return useFetchBase; }
});
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

function useFetchBase(callback, option) {
    const refCallback = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(callback);
    const [data, setData] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)();
    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)();
    const load = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((signal)=>{
        refCallback.current().then((res)=>{
            if (signal.aborted) return;
            setData(res);
        }).catch((error)=>{
            if (signal.aborted) return;
            setError(error);
        });
    }, []);
    const reload = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(function() {
        let { signal, clean = true } = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        if (clean) setData(undefined);
        setError(undefined);
        load(signal ?? new AbortController().signal);
    }, [
        load
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        refCallback.current = callback;
    }, [
        callback
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        const abort = new AbortController();
        load(abort.signal);
        return ()=>{
            abort.abort();
        };
    }, // eslint-disable-next-line react-hooks/exhaustive-deps
    (option === null || option === void 0 ? void 0 : option.deps) ?? []);
    return {
        data,
        error,
        reload
    };
}
function useFetch(args, callback) {
    return useFetchBase(()=>callback(...args), {
        deps: [
            JSON.stringify(args)
        ]
    });
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/util/antd.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  filterOptionLabel: function() { return filterOptionLabel; }
});
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
const filterOptionLabel = (search, option)=>{
    if (!option) return false;
    if (typeof option.label !== 'string') return false;
    return option.label.toLowerCase().includes(search.toLowerCase());
};

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/util/emitter.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  ChangedEmitter: function() { return ChangedEmitter; },
  Emitter: function() { return Emitter; },
  SingleEmitter: function() { return SingleEmitter; }
});
/* harmony import */var _swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_get.js");
/* harmony import */var _swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_init.js");
/* harmony import */var _swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_set.js");
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");




var _callbacks = /*#__PURE__*/ new WeakMap();
class SingleEmitter {
    on(callback) {
        let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        const listener = {
            cb: callback,
            options: {
                ...this.defaultOptions,
                ...options
            }
        };
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _callbacks).push(listener);
        return ()=>{
            this.off(listener);
        };
    }
    fire(value) {
        const callbacks = [
            ...(0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _callbacks)
        ];
        for (const callback of callbacks){
            if (callback.options.once) this.off(callback);
            Promise.resolve(callback.cb(value)).catch(console.error);
        }
    }
    off(callback) {
        const idx = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _callbacks).findIndex(()=>callback);
        if (idx === -1) return;
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _callbacks).splice(idx, 1);
    }
    constructor(defaultOptions = {}){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_1__._)(this, "defaultOptions", void 0);
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_2__._)(this, _callbacks, {
            writable: true,
            value: void 0
        });
        this.defaultOptions = defaultOptions;
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__._)(this, _callbacks, []);
    }
}
var _listeners = /*#__PURE__*/ new WeakMap();
class Emitter {
    on(name, callback) {
        let sEmitter = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _listeners).get(name);
        if (!sEmitter) {
            sEmitter = new SingleEmitter();
            (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _listeners).set(name, sEmitter);
        }
        return sEmitter.on(callback);
    }
    fire(name, value) {
        const sEmitter = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _listeners).get(name);
        if (!sEmitter) return;
        Promise.resolve(sEmitter.fire(value)).catch(console.error);
    }
    off(name) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _listeners).delete(name);
    }
    constructor(){
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_2__._)(this, _listeners, {
            writable: true,
            value: new Map()
        });
    }
}
var _lastValues = /*#__PURE__*/ new WeakMap();
/**
 * Emitter only fired when value changed
 */ class ChangedEmitter extends Emitter {
    on(name, callback) {
        return super.on(name, (value)=>callback(value, (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _lastValues).get(name)));
    }
    fire(name, value) {
        if (!(0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _lastValues).has(name) || (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _lastValues).get(name) !== value) {
            (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_0__._)(this, _lastValues).set(name, value);
            super.fire(name, value);
        }
    }
    constructor(...args){
        super(...args), (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_2__._)(this, _lastValues, {
            writable: true,
            value: new Map()
        });
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/util/promise.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  async: function() { return async; },
  nextTick: function() { return nextTick; },
  sleep: function() { return sleep; }
});
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
const async = (fn)=>{
    fn().catch(console.error);
};
const sleep = (ms)=>{
    return new Promise((resolve)=>{
        setTimeout(resolve, ms);
    });
};
const nextTick = ()=>{
    return new Promise((resolve)=>{
        setTimeout(()=>{
            resolve();
        });
    });
};

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/util/speech.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Speech: function() { return Speech; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _web_pages_books_view_sound_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/web/pages/books/view/sound.ts");
/* harmony import */var _consts_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/collection.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");




function replacePersonText(text) {
    for (const [key, value] of Object.entries(_consts_js__WEBPACK_IMPORTED_MODULE_1__.ZH_PERSON_RULES)){
        text = text.replaceAll(key, value.word);
    }
    return text;
}
function getQuotePositions(text) {
    const pos = [];
    for (const [i, m] of [
        ...text.matchAll(/"|'/g)
    ].entries()){
        if (i % 2 === 0) {
            pos.push({
                type: 'start',
                charIndex: m.index
            });
        } else {
            pos.push({
                type: 'end',
                charIndex: m.index
            });
        }
    }
    for (const m of text.matchAll(/“|‘|「|『/g)){
        pos.push({
            type: 'start',
            charIndex: m.index
        });
    }
    for (const m of text.matchAll(/”|’|」|』/g)){
        pos.push({
            type: 'end',
            charIndex: m.index
        });
    }
    return (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.orderBy)(pos, 'asc', (p)=>p.charIndex);
}
class Speech {
    aliasReplace(text, aliasArray) {
        if (!aliasArray.length) return {
            text,
            highlightOffsets: []
        };
        const highlightOffsets = [];
        const indexMap = new Map();
        for (const alias of aliasArray){
            let i = -1;
            // eslint-disable-next-line no-constant-condition, @typescript-eslint/no-unnecessary-condition
            while(true){
                i = text.indexOf(alias.source, i + 1);
                if (i === -1) break;
                else if (!indexMap.has(i)) {
                    indexMap.set(i, alias);
                }
            }
        }
        const orderedIndexes = (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.orderBy)([
            ...indexMap.entries()
        ], 'asc', (param)=>{
            let [i] = param;
            return i;
        });
        let accOffset = 0;
        for (const [i, { source, target }] of orderedIndexes){
            text = text.replace(source, target);
            const unitOffset = source.length - target.length;
            if (unitOffset === 0) continue;
            const afterI = i - accOffset;
            highlightOffsets.push([
                afterI,
                accOffset
            ]);
            for (const j of (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.range)(1, target.length)){
                highlightOffsets.push([
                    afterI + j,
                    accOffset + Math.floor(unitOffset * (j / target.length))
                ]);
            }
            accOffset = accOffset + unitOffset;
        }
        return {
            text,
            highlightOffsets
        };
    }
    cancel() {
        this.state = 'cancel';
        if (speechSynthesis.speaking) speechSynthesis.cancel();
    }
    async speak(text, param) {
        let { speed, voice, isPersonReplace, quote = true, alias, onBoundary } = param;
        this.state = 'speaking';
        text = isPersonReplace ? replacePersonText(text) : text;
        // boundary
        const boundaryListeners = [];
        if (quote) {
            const quotePositions = getQuotePositions(text);
            boundaryListeners.push((event)=>{
                // quote & rain
                const quotePosIndex = (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.findLastIndex)(quotePositions, (p)=>p.charIndex <= event.charIndex);
                if (quotePosIndex === undefined) return (0,_web_pages_books_view_sound_js__WEBPACK_IMPORTED_MODULE_0__.rainStop)();
                const posPass = quotePositions.slice(0, quotePosIndex + 1);
                const startPosList = posPass.filter((p)=>p.type === 'start');
                const endPosList = posPass.filter((p)=>p.type === 'end');
                if (startPosList.length > endPosList.length) {
                    (0,_web_pages_books_view_sound_js__WEBPACK_IMPORTED_MODULE_0__.rainStart)();
                } else {
                    (0,_web_pages_books_view_sound_js__WEBPACK_IMPORTED_MODULE_0__.rainStop)();
                }
            });
        }
        if (onBoundary) if (alias && alias.length) {
            const aliasResult = this.aliasReplace(text, alias);
            text = aliasResult.text;
            const highlightOffsetTable = aliasResult.highlightOffsets;
            const highlightOffsetFn = highlightOffsetTable.length ? (event)=>{
                const startOffset = (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.findLast)(highlightOffsetTable, (param)=>{
                    let [i] = param;
                    return i <= event.charIndex;
                });
                if (!startOffset) return event;
                const charEndIndex = event.charIndex + event.charLength;
                const endOffset = (0,_collection_js__WEBPACK_IMPORTED_MODULE_2__.findLast)(highlightOffsetTable, (param)=>{
                    let [i] = param;
                    return i <= charEndIndex;
                });
                if (!endOffset) return event;
                const charIndex = event.charIndex + (startOffset.at(1) ?? 0);
                const charLength = charEndIndex + (endOffset.at(1) ?? 0) - charIndex;
                return {
                    charIndex,
                    charLength
                };
            } : (event)=>event;
            boundaryListeners.push((event)=>{
                onBoundary(highlightOffsetFn(event));
            });
        } else {
            boundaryListeners.push((event)=>{
                onBoundary(event);
            });
        }
        for (const boundaryListener of boundaryListeners){
            this.utterance.addEventListener('boundary', boundaryListener);
        }
        this.utterance.rate = speed;
        this.utterance.voice = voice;
        this.utterance.text = text;
        speechSynthesis.speak(this.utterance);
        const result = await new Promise((resolve, reject)=>{
            this.utterance.addEventListener('end', ()=>{
                resolve(this.state === 'cancel' ? 'cancel' : 'done');
            }, {
                once: true
            });
            this.utterance.addEventListener('error', (error)=>{
                if (this.state === 'cancel') resolve('cancel');
                else reject(error);
            }, {
                once: true
            });
        });
        for (const boundaryListener of boundaryListeners){
            this.utterance.removeEventListener('boundary', boundaryListener);
        }
        (0,_web_pages_books_view_sound_js__WEBPACK_IMPORTED_MODULE_0__.rainStop)();
        this.state = 'none';
        return result;
    }
    constructor(){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "utterance", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "state", 'none');
        this.utterance = new SpeechSynthesisUtterance();
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/core/util/timer.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  debounceFn: function() { return debounceFn; },
  iterateAnimate: function() { return iterateAnimate; },
  throttleFn: function() { return throttleFn; },
  throttleTailFn: function() { return throttleTailFn; }
});
/* harmony import */var _collection_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/util/collection.ts");
/* harmony import */var _promise_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/promise.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");


function debounceFn(delay, fn) {
    let timer;
    return function() {
        for(var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++){
            args[_key] = arguments[_key];
        }
        clearTimeout(timer);
        timer = setTimeout(()=>fn(...args), delay);
    };
}
function throttleFn(delay, fn) {
    let isThrottled = false;
    return function() {
        for(var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++){
            args[_key] = arguments[_key];
        }
        if (!isThrottled) {
            const result = fn(...args);
            isThrottled = true;
            setTimeout(()=>isThrottled = false, delay);
            return result;
        }
    };
}
function throttleTailFn(delay, fn) {
    let timer;
    let isThrottled = false;
    return function() {
        for(var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++){
            args[_key] = arguments[_key];
        }
        clearTimeout(timer);
        if (isThrottled) {
            timer = setTimeout(()=>fn(...args), delay);
        } else {
            const result = fn(...args);
            isThrottled = true;
            setTimeout(()=>isThrottled = false, delay);
            return result;
        }
    };
}
async function iterateAnimate(param, callback) {
    let { iteration = 10, duration = 100, abortCtrl } = param;
    let aborted = false;
    abortCtrl === null || abortCtrl === void 0 ? void 0 : abortCtrl.signal.addEventListener('abort', ()=>{
        aborted = true;
    });
    const unitTime = duration / iteration;
    for (const i of (0,_collection_js__WEBPACK_IMPORTED_MODULE_0__.range)(0, iteration + 1)){
        await (0,_promise_js__WEBPACK_IMPORTED_MODULE_1__.sleep)(unitTime);
        if (aborted) break;
        await callback(i);
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/api.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  API: function() { return API; }
});
/* harmony import */var _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/api/books/create-by-url.ts");
/* harmony import */var _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/api/books/create.ts");
/* harmony import */var _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/api/books/fetch-url-info.ts");
/* harmony import */var _core_api_books_move_top_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/move-top.ts");
/* harmony import */var _core_api_books_search_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/search.ts");
/* harmony import */var _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/api/books/update.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");






const API = {
    book: {
        async add (params) {
            return await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_1__.booksCreateRouter.action(params);
        },
        async fetchUrlInfo (params) {
            return await _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_2__.booksFetchUrlInfoRouter.action(params);
        },
        async addByUrl (params) {
            return await _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_0__.booksCreateByUrlRouter.action(params);
        },
        async update (params) {
            await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_5__.booksUpdateRouter.action(params);
        },
        async top (params) {
            await _core_api_books_move_top_js__WEBPACK_IMPORTED_MODULE_3__.booksMoveTopRouter.action(params);
        },
        async search (params) {
            return await _core_api_books_search_js__WEBPACK_IMPORTED_MODULE_4__.booksSearchRouter.action(params);
        }
    }
};
window.API = API;

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/app.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  App: function() { return App; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _app_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/app.scss?28ee");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/alert/index.js");
/* harmony import */var antd_dist_reset_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/dist/reset.css?e375");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */var react_dnd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./node_modules/.pnpm/react-dnd@16.0.1_@types+node@22.7.3_@types+react@18.3.9_react@18.3.1/node_modules/react-dnd/dist/core/DndProvider.js");
/* harmony import */var react_dnd_html5_backend__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__("./node_modules/.pnpm/react-dnd-html5-backend@16.0.1/node_modules/react-dnd-html5-backend/dist/index.js");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _common_confirm_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/common/confirm.tsx");
/* harmony import */var _common_hint_text_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/common/hint-text.tsx");
/* harmony import */var _common_notification_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/common/notification.tsx");
/* harmony import */var _common_preview_image_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/common/preview-image.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/components/spin.tsx");
/* harmony import */var _hooks_use_style_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/hooks/use-style.ts");
/* harmony import */var _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/web/hooks/use-title.tsx");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _pages_entry_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/web/pages/entry.tsx");
/* harmony import */var _service_worker_register_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/web/service-worker/register.ts");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _style_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/web/style.tsx");
/* harmony import */var _theme_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./src/web/theme.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
// styles

var _s = $RefreshSig$();

// modules




















function AppEntry() {
    _s();
    const theme = (0,_theme_js__WEBPACK_IMPORTED_MODULE_17__.useColorScheme)();
    const [loadedStatus, setLoadedStatus] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        (0,_service_worker_register_js__WEBPACK_IMPORTED_MODULE_14__.registerAPI)().then((status)=>{
            if (status === 'unsupported') setLoadedStatus('Service worker is unsupported');
            else if (status === 'failed') setLoadedStatus('Service worker load failed');
            else setLoadedStatus(true);
        }).catch((err)=>{
            setLoadedStatus('Service worker load failed');
            console.error(err);
        });
    }, []);
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        if (theme === 'dark') document.documentElement.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS);
        else document.documentElement.classList.remove(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS);
    }, [
        theme
    ]);
    (0,_hooks_use_style_js__WEBPACK_IMPORTED_MODULE_10__.useStyle)(_style_js__WEBPACK_IMPORTED_MODULE_16__.globalStyle);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: [
            loadedStatus === true && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_pages_entry_js__WEBPACK_IMPORTED_MODULE_13__.RootEntry, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                lineNumber: 54,
                columnNumber: 33
            }, this),
            loadedStatus === false && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_9__.SpinFullscreen, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                lineNumber: 55,
                columnNumber: 34
            }, this),
            typeof loadedStatus === 'string' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_18__["default"], {
                type: "error",
                message: loadedStatus
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                lineNumber: 57,
                columnNumber: 9
            }, this)
        ]
    }, void 0, true);
}
_s(AppEntry, "ER1zbB6nkrGc3dzh7a0r+jhrH6M=", false, function() {
    return [
        _theme_js__WEBPACK_IMPORTED_MODULE_17__.useColorScheme,
        _hooks_use_style_js__WEBPACK_IMPORTED_MODULE_10__.useStyle
    ];
});
_c = AppEntry;
function AppProvider() {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_theme_js__WEBPACK_IMPORTED_MODULE_17__.AntdConfigProvider, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_dnd__WEBPACK_IMPORTED_MODULE_19__.DndProvider, {
            backend: react_dnd_html5_backend__WEBPACK_IMPORTED_MODULE_20__.HTML5Backend,
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AppEntry, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 67,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_notification_js__WEBPACK_IMPORTED_MODULE_7__.NotificationProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 68,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_notification_js__WEBPACK_IMPORTED_MODULE_7__.MessageProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 69,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_hint_text_js__WEBPACK_IMPORTED_MODULE_6__.HintTextProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 70,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_preview_image_js__WEBPACK_IMPORTED_MODULE_8__.PreviewImageProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 71,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_confirm_js__WEBPACK_IMPORTED_MODULE_5__.ConfirmProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 72,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_hooks_use_title_js__WEBPACK_IMPORTED_MODULE_11__.TitleProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 73,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_12__.HotkeysProvider, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
                    lineNumber: 74,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
            lineNumber: 66,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
        lineNumber: 65,
        columnNumber: 5
    }, this);
}
_c1 = AppProvider;
function App() {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(jotai__WEBPACK_IMPORTED_MODULE_21__.Provider, {
        store: _store_global_js__WEBPACK_IMPORTED_MODULE_15__.globalStore,
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AppProvider, {}, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
            lineNumber: 83,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/app.tsx",
        lineNumber: 82,
        columnNumber: 5
    }, this);
}
_c2 = App;
var _c, _c1, _c2;
$RefreshReg$(_c, "AppEntry");
$RefreshReg$(_c1, "AppProvider");
$RefreshReg$(_c2, "App");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/atoms.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  iframeWinAtom: function() { return iframeWinAtom; }
});
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

const iframeWinAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_0__.atom)({
    win: null
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/common/confirm.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  ConfirmProvider: function() { return ConfirmProvider; },
  uiConfirm: function() { return uiConfirm; },
  useConfirm: function() { return useConfirm; },
  useConfirmHotkey: function() { return useConfirmHotkey; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useSyncedRef/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/hooks/use-escape.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$();










const confirmAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_7__.atom)(null);
function uiConfirm(options) {
    return new Promise((resolve)=>{
        _store_global_js__WEBPACK_IMPORTED_MODULE_5__.globalStore.set(confirmAtom, {
            ...options,
            okCallback: ()=>resolve(true),
            cancelCallback: ()=>resolve(false)
        });
    });
}
function useConfirm() {
    _s();
    const [, setConfirm] = (0,jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom)(confirmAtom);
    const confirm = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((options)=>{
        return new Promise((resolve)=>{
            setConfirm({
                ...options,
                okCallback: ()=>resolve(true),
                cancelCallback: ()=>resolve(false)
            });
        });
    }, [
        setConfirm
    ]);
    return confirm;
}
_s(useConfirm, "M/Alzq5lRposWRvpt1bpA1FjXk0=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom
    ];
});
const useConfirmHotkey = (param)=>{
    let { enable = true, onOk, onClose, level = 100 } = param;
    _s1();
    const { addHotkey } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys)();
    const onOkRef = (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useSyncedRef)(onOk);
    const onCloseRef = (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useSyncedRef)(onClose);
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (enable) {
            return addHotkey('Enter', (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.ok'), ()=>{
                onOkRef.current();
            }, {
                level
            });
        }
    }, [
        addHotkey,
        enable,
        level,
        onOkRef
    ]);
    (0,_hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_3__.useKeyEscape)(()=>{
        var _onCloseRef_current;
        (_onCloseRef_current = onCloseRef.current) === null || _onCloseRef_current === void 0 ? void 0 : _onCloseRef_current.call(onCloseRef);
    }, {
        enable: !!enable && !!onClose
    });
};
_s1(useConfirmHotkey, "8XfOtU/7Dd/alWZxmfK8kVisMH4=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys,
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useSyncedRef,
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useSyncedRef,
        _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_3__.useKeyEscape
    ];
});
function ConfirmDialog() {
    _s2();
    const [confirm, setConfirm] = (0,jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom)(confirmAtom);
    const onClose = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        setConfirm(null);
    }, [
        setConfirm
    ]);
    const onCancel = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        confirm === null || confirm === void 0 ? void 0 : confirm.cancelCallback();
        onClose();
    }, [
        confirm,
        onClose
    ]);
    const onOk = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        confirm === null || confirm === void 0 ? void 0 : confirm.okCallback();
        onClose();
    }, [
        confirm,
        onClose
    ]);
    useConfirmHotkey({
        enable: !!confirm,
        onOk,
        onClose: onCancel
    });
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"], {
            open: !!confirm,
            onOk: onOk,
            onCancel: onClose,
            title: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_6__.Icon, {
                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_12__.faQuestionCircle,
                        size: "lg",
                        color: "#ff4d4f"
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                        lineNumber: 118,
                        columnNumber: 13
                    }, void 0),
                    confirm === null || confirm === void 0 ? void 0 : confirm.title
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                lineNumber: 117,
                columnNumber: 11
            }, void 0),
            footer: false,
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                direction: "vertical",
                children: [
                    confirm === null || confirm === void 0 ? void 0 : confirm.description,
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_13__["default"], {
                                type: "primary",
                                onClick: onClose,
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('confirm.cancel')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                                lineNumber: 127,
                                columnNumber: 13
                            }, this),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_13__["default"], {
                                type: "primary",
                                onClick: onOk,
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('confirm.ok')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                                lineNumber: 130,
                                columnNumber: 13
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                        lineNumber: 126,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
                lineNumber: 124,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
            lineNumber: 112,
            columnNumber: 7
        }, this)
    }, void 0, false);
}
_s2(ConfirmDialog, "6XjNbK0yg6g9Dyv8ksZeOUkZi4s=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom,
        useConfirmHotkey
    ];
});
_c = ConfirmDialog;
function ConfirmProvider() {
    _s3();
    const [confirm] = (0,jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom)(confirmAtom);
    if (!confirm) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {}, void 0, false);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ConfirmDialog, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/confirm.tsx",
        lineNumber: 145,
        columnNumber: 10
    }, this);
}
_s3(ConfirmProvider, "BjOmVD/X6dcJVz7qeoz2LPt6D7I=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_8__.useAtom
    ];
});
_c1 = ConfirmProvider;
var _c, _c1;
$RefreshReg$(_c, "ConfirmDialog");
$RefreshReg$(_c1, "ConfirmProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/common/hint-text.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  HintTextProvider: function() { return HintTextProvider; },
  useHintText: function() { return useHintText; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var _hint_text_module_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/common/hint-text.module.scss?893b");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$();



const hintTextAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_3__.atom)(null);
let timer = undefined;
function useHintText() {
    _s();
    const [, setHint] = (0,jotai__WEBPACK_IMPORTED_MODULE_4__.useAtom)(hintTextAtom);
    const openHint = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(hint) {
        let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        clearTimeout(timer);
        const timeout = options.timeout ?? 3;
        setHint(hint);
        timer = setTimeout(()=>{
            setHint(null);
        }, timeout * 1000);
    }, [
        setHint
    ]);
    return (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>({
            openHint
        }), [
        openHint
    ]);
}
_s(useHintText, "yNbCLJyZwBljmX+X7rW8ruPsBSI=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_4__.useAtom
    ];
});
function HintTextProvider() {
    _s1();
    const [hint] = (0,jotai__WEBPACK_IMPORTED_MODULE_4__.useAtom)(hintTextAtom);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        className: _hint_text_module_scss__WEBPACK_IMPORTED_MODULE_2__["default"].hint,
        style: {
            display: hint ? 'inline-block' : 'none'
        },
        children: hint
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/hint-text.tsx",
        lineNumber: 35,
        columnNumber: 5
    }, this);
}
_s1(HintTextProvider, "MLLMJ5tkugsNe4uWB8Y4w2s2a7U=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_4__.useAtom
    ];
});
_c = HintTextProvider;
var _c;
$RefreshReg$(_c, "HintTextProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/common/preview-image.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PreviewImageProvider: function() { return PreviewImageProvider; },
  previewImgSrcAtom: function() { return previewImgSrcAtom; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var _components_pinch_zoom_pan_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/components/pinch-zoom-pan.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();


const previewImgSrcAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.atom)(null);
function PreviewImageProvider() {
    _s();
    const [src, setSrc] = (0,jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom)(previewImgSrcAtom);
    if (!src) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {}, void 0, false);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_pinch_zoom_pan_js__WEBPACK_IMPORTED_MODULE_1__.PinchZoomPan, {
        onClose: ()=>{
            setSrc(null);
        },
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("img", {
            src: src,
            onLoad: (event)=>{
                const img = event.currentTarget;
                const imgRate = img.naturalWidth / img.naturalHeight;
                const winRate = window.innerWidth / window.innerHeight;
                if (imgRate > winRate) {
                    if (img.naturalWidth > window.innerWidth) {
                        img.width = window.innerWidth;
                        img.height = window.innerWidth / imgRate;
                    }
                } else {
                    if (img.naturalHeight > window.innerHeight) {
                        img.height = window.innerHeight;
                        img.width = window.innerHeight * imgRate;
                    }
                }
            },
            alt: "preview"
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/preview-image.tsx",
            lineNumber: 17,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/preview-image.tsx",
        lineNumber: 12,
        columnNumber: 5
    }, this);
}
_s(PreviewImageProvider, "hJzt9NNr2jBEzwkkHz9biCSzB7w=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom
    ];
});
_c = PreviewImageProvider;
var _c;
$RefreshReg$(_c, "PreviewImageProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/common/swipe-action.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  SwipeAction: function() { return SwipeAction; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/dom.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();


function mountSwipe(element, param) {
    let { left, leftElement, right, rightElement } = param;
    if (!left && !right) return;
    let start = null;
    let curX = null;
    const getXY = (touch)=>{
        const { clientX, clientY } = touch;
        return [
            clientX,
            clientY
        ];
    };
    const onStart = (event)=>{
        if (!event.touches[0]) return;
        start = {
            x: event.touches[0].clientX,
            y: event.touches[0].clientY
        };
        curX = 0;
    };
    const onMove = (event)=>{
        if (!start) return;
        const touch = event.touches[0];
        if (!touch) return;
        const [x, y] = getXY(touch);
        const oX = x - start.x;
        const dX = Math.abs(oX);
        const oY = y - start.y;
        const dY = Math.abs(oY);
        if (dY > 30) return;
        if (dX > 5) (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_2__.eventBan)(event);
        if (left && leftElement && oX > 0) {
            const mX = Math.min(dX, left.width + 10);
            curX = mX;
            element.style.transform = `translateX(${mX}px)`;
            leftElement.style.opacity = dX > left.width ? '1' : '0.5';
        } else if (right && rightElement && oX < 0) {
            const mX = Math.min(dX, right.width + 10);
            curX = -mX;
            element.style.transform = `translateX(${-mX}px)`;
            rightElement.style.opacity = dX > right.width ? '1' : '0.5';
        }
    };
    const onEnd = ()=>{
        if (!start) return;
        start = null;
        element.style.transform = '';
        if (leftElement) leftElement.style.opacity = '0';
        if (rightElement) rightElement.style.opacity = '0';
        if (!curX) return;
        if (left && curX > left.width) {
            left.trigger();
        } else if (right && rightElement && curX < -right.width) {
            right.trigger();
        }
        curX = null;
    };
    element.addEventListener('touchstart', onStart);
    element.addEventListener('touchmove', onMove);
    element.addEventListener('touchend', onEnd);
    return ()=>{
        element.removeEventListener('touchstart', onStart);
        element.removeEventListener('touchmove', onMove);
        element.removeEventListener('touchend', onEnd);
    };
}
const getNodeStyle = (node)=>({
        position: 'absolute',
        top: 0,
        width: node.width + 10,
        height: '100%',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        color: node.color ?? 'var(--main-fg-blue)',
        background: node.background ?? 'var(--main-bg-blue)',
        opacity: 0
    });
function SwipeAction(param) {
    let { children, left, right } = param;
    _s();
    const refElement = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);
    const [leftElement, setLeftElement] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();
    const [rightElement, setRightElement] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        if (!refElement.current) return;
        return mountSwipe(refElement.current, {
            left,
            leftElement,
            right,
            rightElement
        });
    }, [
        left,
        leftElement,
        right,
        rightElement
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        style: {
            position: 'relative',
            willChange: 'transform'
        },
        ref: refElement,
        children: [
            left && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                ref: (element)=>setLeftElement(element ?? undefined),
                className: "swipe-left-node",
                style: {
                    ...getNodeStyle(left),
                    right: '100%'
                },
                children: left.node
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/swipe-action.tsx",
                lineNumber: 150,
                columnNumber: 9
            }, this),
            children,
            right && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                ref: (element)=>setRightElement(element ?? undefined),
                className: "swipe-right-node",
                style: {
                    ...getNodeStyle(right),
                    left: '100%'
                },
                children: right.node
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/swipe-action.tsx",
                lineNumber: 163,
                columnNumber: 9
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/common/swipe-action.tsx",
        lineNumber: 142,
        columnNumber: 5
    }, this);
}
_s(SwipeAction, "m8nRFEKbP6TyFKUge3WwAdOKRaQ=");
_c = SwipeAction;
var _c;
$RefreshReg$(_c, "SwipeAction");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/file-input.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  FileInput: function() { return FileInput; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var _flex_box_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _icon_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _file_input_module_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/file-input.module.scss?dcfe");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






const FileInput = (param)=>{
    let { accept, prompt, value, onChange } = param;
    _s();
    const [acceptedFiles, setAcceptedFiles] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        setAcceptedFiles(value ?? []);
    }, [
        value
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("label", {
        className: _file_input_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].fileInput,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("input", {
                style: {
                    display: 'none'
                },
                accept: accept,
                multiple: true,
                type: "file",
                onChange: (event)=>{
                    const files = [
                        ...event.target.files ?? []
                    ];
                    setAcceptedFiles(files);
                    onChange === null || onChange === void 0 ? void 0 : onChange(files);
                }
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                lineNumber: 26,
                columnNumber: 7
            }, undefined),
            acceptedFiles.length ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_flex_box_js__WEBPACK_IMPORTED_MODULE_2__.FlexBox, {
                gap: 5,
                children: acceptedFiles.map((file, i)=>{
                    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_flex_box_js__WEBPACK_IMPORTED_MODULE_2__.FlexBox, {
                        dir: "row",
                        gap: 5,
                        style: {
                            alignItems: 'center'
                        },
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_icon_js__WEBPACK_IMPORTED_MODULE_3__.Icon, {
                                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_5__.faUpload
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                                lineNumber: 47,
                                columnNumber: 17
                            }, undefined),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                children: file.name
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                                lineNumber: 48,
                                columnNumber: 17
                            }, undefined)
                        ]
                    }, i, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                        lineNumber: 41,
                        columnNumber: 15
                    }, undefined);
                })
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                lineNumber: 38,
                columnNumber: 9
            }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_flex_box_js__WEBPACK_IMPORTED_MODULE_2__.FlexBox, {
                gap: 2,
                style: {
                    justifyContent: 'center'
                },
                children: prompt && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
                    children: prompt
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                    lineNumber: 55,
                    columnNumber: 22
                }, undefined)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
                lineNumber: 54,
                columnNumber: 9
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/file-input.tsx",
        lineNumber: 25,
        columnNumber: 5
    }, undefined);
};
_s(FileInput, "xZCDFFqF0sQeE4a+h4aZ4amjj5o=");
_c = FileInput;
var _c;
$RefreshReg$(_c, "FileInput");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/flex-box.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  FlexBox: function() { return FlexBox; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

function FlexBox(param) {
    let { dir = 'column', gap = 0, flex, style, children, ...props } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        style: {
            display: 'flex',
            flexDirection: dir,
            gap,
            flex,
            ...style
        },
        ...props,
        children: children
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/flex-box.tsx",
        lineNumber: 17,
        columnNumber: 5
    }, this);
}
_c = FlexBox;
var _c;
$RefreshReg$(_c, "FlexBox");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/icon.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Icon: function() { return Icon; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+react-fontawesome@0.2.2_@fortawesome+fontawesome-svg-core@6.6.0_react@18.3.1/node_modules/@fortawesome/react-fontawesome/index.es.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");


function Icon(param) {
    let { icon, size, style, onClick, color } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.FontAwesomeIcon, {
        icon: icon,
        size: size ?? 'lg',
        color: color,
        style: {
            paddingLeft: '6px',
            paddingRight: '6px',
            ...style
        },
        onClick: onClick
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/icon.tsx",
        lineNumber: 14,
        columnNumber: 5
    }, this);
}
_c = Icon;
var _c;
$RefreshReg$(_c, "Icon");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/input-number.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  RInputNumber: function() { return RInputNumber; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var _fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+react-fontawesome@0.2.2_@fortawesome+fontawesome-svg-core@6.6.0_react@18.3.1/node_modules/@fortawesome/react-fontawesome/index.es.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input-number/index.js");
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/browser.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");





function RInputNumber(props) {
    if (_core_util_browser_js__WEBPACK_IMPORTED_MODULE_2__.isMobile) {
        let step = 1;
        if (props.step !== undefined) {
            if (typeof props.step === 'number') step = props.step;
            else if (typeof props.step === 'string') step = parseFloat(props.step);
        }
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_3__["default"].Compact, {
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_4__["default"], {
                    size: props.size,
                    onClick: ()=>{
                        var _props_onChange;
                        const value = props.value ?? 0;
                        (_props_onChange = props.onChange) === null || _props_onChange === void 0 ? void 0 : _props_onChange.call(props, value - step);
                    },
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.FontAwesomeIcon, {
                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_5__.faArrowDown
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
                        lineNumber: 21,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
                    lineNumber: 14,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
                    ...props
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
                    lineNumber: 23,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_4__["default"], {
                    size: props.size,
                    onClick: ()=>{
                        var _props_onChange;
                        const value = props.value ?? 0;
                        (_props_onChange = props.onChange) === null || _props_onChange === void 0 ? void 0 : _props_onChange.call(props, value + step);
                    },
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.FontAwesomeIcon, {
                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_5__.faArrowUp
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
                        lineNumber: 31,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
                    lineNumber: 24,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
            lineNumber: 13,
            columnNumber: 7
        }, this);
    }
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
        ...props
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/input-number.tsx",
        lineNumber: 36,
        columnNumber: 10
    }, this);
}
_c = RInputNumber;
var _c;
$RefreshReg$(_c, "RInputNumber");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/language-select.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  LanguageSelect: function() { return LanguageSelect; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/select/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _core_lang_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/lang.ts");
/* harmony import */var _core_util_antd_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/antd.tsx");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();





function LanguageSelect(param) {
    let { value, onChange } = param;
    _s();
    const langOptions = (0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.useOrderedLangOptions)();
    const [search, setSearch] = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)('');
    const filteredLangOptions = (0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(()=>{
        if (!search) return langOptions;
        const lcSearch = search.toLowerCase();
        const matchOptions = langOptions.filter((o)=>o.value === lcSearch);
        if (matchOptions.length) return matchOptions;
        return langOptions;
    }, [
        langOptions,
        search
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_5__["default"], {
        showSearch: true,
        filterOption: (search, option)=>{
            setSearch(search);
            return (0,_core_util_antd_js__WEBPACK_IMPORTED_MODULE_3__.filterOptionLabel)(search, option);
        },
        popupMatchSelectWidth: false,
        value: value,
        onChange: onChange,
        placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.selectLanguage'),
        options: filteredLangOptions
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/language-select.tsx",
        lineNumber: 25,
        columnNumber: 5
    }, this);
}
_s(LanguageSelect, "pnAu2JP4rU7Zv8DPLyv3pOXJh4w=", false, function() {
    return [
        _core_lang_js__WEBPACK_IMPORTED_MODULE_2__.useOrderedLangOptions
    ];
});
_c = LanguageSelect;
var _c;
$RefreshReg$(_c, "LanguageSelect");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/link-wrap.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  LinkWrap: function() { return LinkWrap; }
});
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
var _s = $RefreshSig$();

function LinkWrap(param) {
    let { to, children } = param;
    _s();
    const href = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_0__.useHref)(to);
    return children(href);
}
_s(LinkWrap, "poxAiN1OfsF9dHA3WDpgZhER4jU=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_0__.useHref
    ];
});
_c = LinkWrap;
var _c;
$RefreshReg$(_c, "LinkWrap");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/pinch-zoom-pan.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PinchZoomPan: function() { return PinchZoomPan; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/hooks/use-escape.ts");
/* harmony import */var _pinch_zoom_pan_module_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/components/pinch-zoom-pan.module.scss?da6f");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






function getTouchesPageCenter(a, b) {
    return {
        pageX: (a.pageX + b.pageX) / 2,
        pageY: (a.pageY + b.pageY) / 2
    };
}
function getTouchesDistance(a, b) {
    return Math.hypot(b.clientX - a.clientX, b.clientY - a.clientY);
}
function getRectCenter(rect) {
    return {
        x: rect.left + rect.width / 2,
        y: rect.top + rect.height / 2
    };
}
const getWheelRate = (event)=>{
    const delta = event.deltaY;
    return delta === 0 ? 0 : delta < 0 ? 1.1 : 0.9;
};
const mountPinchZoomPan = (overlay, container, onClick)=>{
    let moved = false;
    let action = null;
    const overlayRect = overlay.getBoundingClientRect();
    let current = {
        x: 0,
        y: 0,
        scale: 1
    };
    let cumulative = {
        x: 0,
        y: 0,
        scale: 1
    };
    const setTransform = ()=>{
        container.style.transform = `translate(${current.x}px, ${current.y}px) scale(${current.scale})`;
    };
    const resetState = ()=>{
        current = {
            ...getRectCenter(overlayRect),
            scale: 1
        };
        cumulative = {
            ...current
        };
        setTransform();
    };
    resetState();
    const moving = (offset)=>{
        if (Math.hypot(offset.x, offset.y) >= 10) moved = true;
        current.x = cumulative.x + offset.x;
        current.y = cumulative.y + offset.y;
        setTransform();
    };
    const scaling = (offset)=>{
        const scale = cumulative.scale * offset.rate;
        if (scale < 0.01) return;
        current.scale = scale;
        const rect = overlay.getBoundingClientRect();
        const offsetX = offset.pageX - rect.left - cumulative.x;
        const offsetY = offset.pageY - rect.top - cumulative.y;
        current.x = cumulative.x + offsetX * (1 - offset.rate);
        current.y = cumulative.y + offsetY * (1 - offset.rate);
        setTransform();
    };
    const touchEnd = ()=>{
        cumulative.x = current.x;
        cumulative.y = current.y;
        cumulative.scale = current.scale;
    };
    const disposes = [];
    function addEventListener(type, listener) {
        overlay.addEventListener(type, listener);
        disposes.push(()=>overlay.removeEventListener(type, listener));
    }
    // touch
    addEventListener('touchstart', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        const touch1 = event.touches[0];
        if (!touch1) return;
        const touch2 = event.touches[1];
        if (touch2) action = {
            type: 'pinch',
            range: getTouchesDistance(touch1, touch2)
        };
        else action = {
            type: 'move',
            x: touch1.clientX,
            y: touch1.clientY
        };
        moved = false;
    });
    addEventListener('touchmove', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        if (!action) return;
        const touch1 = event.touches[0];
        if (!touch1) return;
        const touch2 = event.touches[1];
        switch(action.type){
            case 'move':
                {
                    moving({
                        x: touch1.clientX - action.x,
                        y: touch1.clientY - action.y
                    });
                    break;
                }
            case 'pinch':
                {
                    if (touch2) scaling({
                        ...getTouchesPageCenter(touch1, touch2),
                        rate: getTouchesDistance(touch1, touch2) / action.range
                    });
                    break;
                }
        }
    });
    addEventListener('touchend', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        if (!action) return;
        if (action.type === 'move' && !moved) onClick();
        action = null;
        touchEnd();
    });
    // mouse
    addEventListener('mousedown', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        action = {
            type: 'move',
            x: event.clientX,
            y: event.clientY
        };
        moved = false;
    });
    addEventListener('mousemove', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        if (!action) return;
        if (action.type === 'move') {
            moving({
                x: event.clientX - action.x,
                y: event.clientY - action.y
            });
        }
    });
    addEventListener('mouseup', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        if (!action) return;
        if (action.type === 'move' && !moved) onClick();
        action = null;
        touchEnd();
        if (!moved) onClick();
    });
    addEventListener('wheel', (event)=>{
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(event);
        scaling({
            pageX: event.pageX,
            pageY: event.pageY,
            rate: getWheelRate(event)
        });
        touchEnd();
    });
    const dispose = ()=>{
        disposes.forEach((dispose)=>dispose());
    };
    return {
        move: (offset)=>{
            moving(offset);
            touchEnd();
        },
        scale: (offset)=>{
            const center = getRectCenter(overlayRect);
            scaling({
                ...offset,
                pageX: center.x,
                pageY: center.y
            });
            touchEnd();
        },
        reset: ()=>{
            resetState();
        },
        dispose
    };
};
function PinchZoomPan(param) {
    let { onClose, children } = param;
    _s();
    const refOverlay = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);
    const refContainer = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);
    const refOnClose = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__.useHotkeys)();
    (0,_hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_2__.useKeyEscape)(()=>{
        var _refOnClose_current;
        return (_refOnClose_current = refOnClose.current) === null || _refOnClose_current === void 0 ? void 0 : _refOnClose_current.call(refOnClose);
    });
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        refOnClose.current = onClose;
    }, [
        onClose
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        const overlay = refOverlay.current;
        const container = refContainer.current;
        if (!overlay || !container) return;
        const { move, scale, reset, dispose: disposePinch } = mountPinchZoomPan(overlay, container, ()=>{
            var _refOnClose_current;
            return (_refOnClose_current = refOnClose.current) === null || _refOnClose_current === void 0 ? void 0 : _refOnClose_current.call(refOnClose);
        });
        const up = ()=>{
            move({
                x: 0,
                y: -10
            });
        };
        const down = ()=>{
            move({
                x: 0,
                y: 10
            });
        };
        const left = ()=>{
            move({
                x: -10,
                y: 0
            });
        };
        const right = ()=>{
            move({
                x: 10,
                y: 0
            });
        };
        const zoomIn = ()=>{
            scale({
                rate: 1.1
            });
        };
        const zoomOut = ()=>{
            scale({
                rate: 0.9
            });
        };
        const disposeHotkeys = addHotkeys([
            [
                'k',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchUp'),
                up
            ],
            [
                'j',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchDown'),
                down
            ],
            [
                'h',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchLeft'),
                left
            ],
            [
                'l',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchRight'),
                right
            ],
            [
                'ArrowUp',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchUp'),
                up
            ],
            [
                'ArrowDown',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchDown'),
                down
            ],
            [
                'ArrowLeft',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchLeft'),
                left
            ],
            [
                'ArrowRight',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchRight'),
                right
            ],
            [
                '=',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchZoomIn'),
                zoomIn
            ],
            [
                '-',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchZoomOut'),
                zoomOut
            ],
            [
                'Backspace',
                (0,i18next__WEBPACK_IMPORTED_MODULE_6__.t)('hotkey.pinchReset'),
                reset
            ]
        ], {
            level: 100
        });
        return ()=>{
            disposePinch();
            disposeHotkeys();
        };
    }, [
        addHotkeys
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{}, [
        addHotkeys
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        ref: refOverlay,
        className: _pinch_zoom_pan_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].overlay,
        onKeyDown: (event)=>{
            var _refOnClose_current;
            if (event.key.toLowerCase() === 'escape') (_refOnClose_current = refOnClose.current) === null || _refOnClose_current === void 0 ? void 0 : _refOnClose_current.call(refOnClose);
        },
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
            className: _pinch_zoom_pan_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].container,
            ref: refContainer,
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                className: _pinch_zoom_pan_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].center,
                children: children
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/pinch-zoom-pan.tsx",
                lineNumber: 300,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/pinch-zoom-pan.tsx",
            lineNumber: 299,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/pinch-zoom-pan.tsx",
        lineNumber: 292,
        columnNumber: 5
    }, this);
}
_s(PinchZoomPan, "mRwM+N+1KWOTxOtirVEes+9q9Xs=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__.useHotkeys,
        _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_2__.useKeyEscape
    ];
});
_c = PinchZoomPan;
var _c;
$RefreshReg$(_c, "PinchZoomPan");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/spin.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  SpinCenter: function() { return SpinCenter; },
  SpinFullscreen: function() { return SpinFullscreen; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/spin/index.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");


function SpinFullscreen(props) {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_1__["default"], {
        fullscreen: true,
        size: "large",
        ...props
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/spin.tsx",
        lineNumber: 4,
        columnNumber: 10
    }, this);
}
_c = SpinFullscreen;
function SpinCenter(props) {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_1__["default"], {
        ...props,
        style: {
            width: '100%',
            padding: 20,
            ...props.style
        }
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/spin.tsx",
        lineNumber: 9,
        columnNumber: 5
    }, this);
}
_c1 = SpinCenter;
var _c, _c1;
$RefreshReg$(_c, "SpinFullscreen");
$RefreshReg$(_c1, "SpinCenter");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/components/textarea.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Textarea: function() { return Textarea; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/dom.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



function Textarea(param) {
    let { ...props } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_2__["default"].TextArea, {
        rows: 4,
        onKeyDown: (e)=>{
            if (e.ctrlKey && e.key === 'Enter') {
                var _elem_closest;
                const elem = e.target;
                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_1__.eventBan)(e);
                (_elem_closest = elem.closest('form')) === null || _elem_closest === void 0 ? void 0 : _elem_closest.dispatchEvent(new Event('submit', {
                    bubbles: true,
                    cancelable: true
                }));
            }
        },
        ...props
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/components/textarea.tsx",
        lineNumber: 7,
        columnNumber: 5
    }, this);
}
_c = Textarea;
var _c;
$RefreshReg$(_c, "Textarea");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/hooks/use-escape.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useKeyEscape: function() { return useKeyEscape; }
});
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



function useKeyEscape(callback) {
    let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    const { enable = true, level = 100 } = options;
    const refCallback = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(callback);
    const { addHotkey } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_1__.useHotkeys)();
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        refCallback.current = callback;
    }, [
        callback
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        if (enable) {
            return addHotkey('escape', (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('hotkey.escape'), ()=>{
                refCallback.current();
            }, {
                level
            });
        }
    }, [
        addHotkey,
        enable,
        level
    ]);
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/hooks/use-style.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useStyle: function() { return useStyle; }
});
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useMountEffect/index.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

function useStyle(styleCSS) {
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_0__.useMountEffect)(()=>{
        const style = document.createElement('style');
        style.innerHTML = styleCSS;
        const title = document.head.querySelector('title');
        if (title && title.nextSibling) document.head.insertBefore(style, title.nextSibling);
        else document.head.prepend(style);
    });
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/hooks/use-synced-debounce.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useSyncedDebounced: function() { return useSyncedDebounced; }
});
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useDebouncedState/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");


function useSyncedDebounced(value, delay, maxWait) {
    const [state, setState] = (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_1__.useDebouncedState)(value, delay, maxWait);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        setState(value);
    }, [
        setState,
        value
    ]);
    return state;
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/hooks/use-title.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  TitleProvider: function() { return TitleProvider; },
  defaultTitle: function() { return defaultTitle; },
  usePushTitle: function() { return usePushTitle; },
  useTitle: function() { return useTitle; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$();


const defaultTitle = 'Auditory Reader';
const titleStackAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.atom)([]);
const titleAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.atom)((get)=>{
    const titleStack = get(titleStackAtom);
    const titleItem = titleStack.at(0);
    return titleItem === null || titleItem === void 0 ? void 0 : titleItem.title;
});
function useTitle() {
    _s();
    const [title] = (0,jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom)(titleAtom);
    return title;
}
_s(useTitle, "ntE0L1bMeD1BIZmw78VLoLzf4AI=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom
    ];
});
function TitleProvider() {
    _s1();
    const title = useTitle();
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        document.title = title ? `${title}: ${defaultTitle}` : defaultTitle;
    }, [
        title
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {}, void 0, false);
}
_s1(TitleProvider, "ybBad1dZBvg6K9zc05RCBJXiUk4=", false, function() {
    return [
        useTitle
    ];
});
_c = TitleProvider;
function usePushTitle() {
    _s2();
    const id = (0,react__WEBPACK_IMPORTED_MODULE_1__.useId)();
    const [, setTitleStack] = (0,jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom)(titleStackAtom);
    // pop titles
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        return ()=>{
            setTitleStack((stack)=>stack.filter((item)=>id !== item.id));
        };
    }, [
        id,
        setTitleStack
    ]);
    // push title
    const pushTitle = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((title)=>{
        setTitleStack((stack)=>[
                {
                    title,
                    id
                },
                ...stack
            ]);
    }, [
        id,
        setTitleStack
    ]);
    return pushTitle;
}
_s2(usePushTitle, "a8QkBMlW3JuF1n5N606uT3xOpYs=", false, function() {
    return [
        react__WEBPACK_IMPORTED_MODULE_1__.useId,
        jotai__WEBPACK_IMPORTED_MODULE_3__.useAtom
    ];
});
var _c;
$RefreshReg$(_c, "TitleProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/hotkey/hotkey-state.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  HotkeysProvider: function() { return HotkeysProvider; },
  useHotkeys: function() { return useHotkeys; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_util_collection_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/collection.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _core_util_text_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/text.ts");
/* harmony import */var _atoms_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/atoms.tsx");
/* harmony import */var _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/hooks/use-escape.ts");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _hotkey_state_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/hotkey/hotkey-state.module.scss?d255");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$();











const sequenceSymbol = ' ';
const hotkeyItemsAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_10__.atom)([]);
let curKeySeq = '';
const seqTimeout = 1000;
function getHotkeyKey(hotkey) {
    if (Array.isArray(hotkey)) {
        return hotkey.map(getHotkeyKey).join(sequenceSymbol);
    } else if (typeof hotkey === 'string') {
        return hotkey.toLowerCase();
    } else {
        let s = '';
        if (hotkey.shift) s += 'shift+';
        if (hotkey.ctrl) s += 'ctrl+';
        if (hotkey.alt) s += 'alt+';
        s += hotkey.key.toLowerCase();
        return s;
    }
}
function getKeyDesc(key) {
    let s = '';
    if (key.length > 1) s += (0,_core_util_text_js__WEBPACK_IMPORTED_MODULE_5__.capitalize)(key);
    else if (key === ' ') s += 'Space';
    else s += key;
    return s;
}
function getHotkeyDesc(hotkey) {
    if (Array.isArray(hotkey)) {
        return hotkey.map(getHotkeyDesc).flat();
    } else if (typeof hotkey === 'string') {
        return [
            getKeyDesc(hotkey)
        ];
    } else {
        let s = '';
        const hasModifier = hotkey.shift || hotkey.ctrl || hotkey.alt;
        if (hasModifier) s += '<';
        if (hotkey.shift) s += 'Shift-';
        if (hotkey.ctrl) s += 'Ctrl-';
        if (hotkey.alt) s += 'Alt-';
        s += getKeyDesc(hotkey.key);
        if (hasModifier) s += '>';
        return [
            s
        ];
    }
}
function useHotkeys() {
    _s();
    const addHotkeys = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(function(hotkeys) {
        let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        const hotkeyItems = _store_global_js__WEBPACK_IMPORTED_MODULE_8__.globalStore.get(hotkeyItemsAtom);
        const updatedItems = [];
        for (const [hotkey, description, callback] of hotkeys){
            const key = getHotkeyKey(hotkey);
            const keyDescs = getHotkeyDesc(hotkey);
            const level = options.level ?? 1;
            let item = hotkeyItems.find((param)=>{
                let [k] = param;
                return k === key;
            });
            if (!item) {
                const callbackMap = new Map([
                    [
                        level,
                        callback
                    ]
                ]);
                item = [
                    key,
                    keyDescs,
                    description,
                    callbackMap
                ];
                hotkeyItems.push(item);
            } else {
                if (item[3].has(level)) throw new Error(`Hotkey ${JSON.stringify(hotkey)} level: ${level} already exists`);
                item[3].set(level, callback);
            }
            updatedItems.push({
                item,
                level
            });
        }
        _store_global_js__WEBPACK_IMPORTED_MODULE_8__.globalStore.set(hotkeyItemsAtom, [
            ...hotkeyItems
        ]);
        return function dispose() {
            const hotkeyItems = _store_global_js__WEBPACK_IMPORTED_MODULE_8__.globalStore.get(hotkeyItemsAtom);
            const removeItems = [];
            for (const { item, level } of updatedItems){
                item[3].delete(level);
                if (!item[3].size) removeItems.push(item);
            }
            _store_global_js__WEBPACK_IMPORTED_MODULE_8__.globalStore.set(hotkeyItemsAtom, hotkeyItems.filter((item)=>!removeItems.includes(item)));
        };
    }, []);
    const addHotkey = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(function(hotkey, description, callback) {
        let options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
        return addHotkeys([
            [
                hotkey,
                description,
                callback
            ]
        ], options);
    }, [
        addHotkeys
    ]);
    return {
        addHotkey,
        addHotkeys
    };
}
_s(useHotkeys, "nJIr6OftD3CIxxAF9ThsOJtgaKQ=");
let sequenceTimer = undefined;
function getListener() {
    return (e)=>{
        if ((0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.isInputElement)(e.target)) return;
        const hotkeyItems = _store_global_js__WEBPACK_IMPORTED_MODULE_8__.globalStore.get(hotkeyItemsAtom);
        const hotkey = {
            shift: e.shiftKey,
            ctrl: e.ctrlKey,
            alt: e.altKey,
            key: e.key.toLowerCase()
        };
        const triggeredKey = getHotkeyKey(hotkey);
        // eslint-disable-next-line no-console
        console.log('triggered-key:', triggeredKey);
        const fullKey = curKeySeq + triggeredKey;
        const fullSubKey = fullKey + sequenceSymbol;
        const targetRet = hotkeyItems.find((param)=>{
            let [key] = param;
            return key === fullKey;
        });
        const hasSubRet = hotkeyItems.find((param)=>{
            let [key] = param;
            return key.startsWith(fullSubKey);
        });
        if (!targetRet && !hasSubRet) return;
        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_4__.eventBan)(e);
        curKeySeq = '';
        clearTimeout(sequenceTimer);
        if (hasSubRet) {
            curKeySeq = fullSubKey;
            sequenceTimer = setTimeout(()=>{
                curKeySeq = '';
            }, seqTimeout);
        } else if (targetRet) {
            var _targetRet__get;
            // callback max level hotkey
            const levels = targetRet[3].keys();
            const maxLevel = Math.max(...levels);
            if (maxLevel) (_targetRet__get = targetRet[3].get(maxLevel)) === null || _targetRet__get === void 0 ? void 0 : _targetRet__get();
        }
    };
}
function useHotkeysRegister() {
    _s1();
    const [refWin] = (0,jotai__WEBPACK_IMPORTED_MODULE_11__.useAtom)(_atoms_js__WEBPACK_IMPORTED_MODULE_6__.iframeWinAtom);
    // global
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const listener = getListener();
        window.addEventListener('keydown', listener, {
            passive: false
        });
        return ()=>{
            window.removeEventListener('keydown', listener);
        };
    }, []);
    // iframe
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!refWin.win) return;
        const listener = getListener();
        refWin.win.addEventListener('keydown', listener, {
            passive: false
        });
        return ()=>{
            var _refWin_win;
            (_refWin_win = refWin.win) === null || _refWin_win === void 0 ? void 0 : _refWin_win.removeEventListener('keydown', listener);
        };
    }, [
        refWin
    ]);
}
_s1(useHotkeysRegister, "2HrPgXV23hcxk+bcQh+A55Dn4yM=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_11__.useAtom
    ];
});
function HotkeysProvider() {
    _s2();
    const [open, setOpen] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const { addHotkey } = useHotkeys();
    const [hotkeyItems] = (0,jotai__WEBPACK_IMPORTED_MODULE_11__.useAtom)(hotkeyItemsAtom);
    useHotkeysRegister();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        return addHotkey({
            shift: true,
            key: '?'
        }, (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.helper'), ()=>{
            setOpen(true);
        });
    }, [
        addHotkey
    ]);
    (0,_hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__.useKeyEscape)(()=>{
        setOpen(false);
    }, {
        enable: open,
        level: 200
    });
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
        open: open,
        width: "auto",
        style: {
            maxWidth: '1000px'
        },
        onCancel: ()=>{
            setOpen(false);
        },
        title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.title'),
        footer: false,
        zIndex: 10000,
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
            className: _hotkey_state_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].hotkeyList,
            children: (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_3__.orderBy)(hotkeyItems, 'asc', (param)=>{
                let [key] = param;
                return key;
            }).map((param, i)=>{
                let [, keyDescs, description] = param;
                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: "keys",
                            children: keyDescs.map((k, j)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("kbd", {
                                    children: k
                                }, j, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
                                    lineNumber: 244,
                                    columnNumber: 19
                                }, this))
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
                            lineNumber: 242,
                            columnNumber: 15
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: "desc",
                            children: description
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
                            lineNumber: 247,
                            columnNumber: 15
                        }, this)
                    ]
                }, i, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
                    lineNumber: 241,
                    columnNumber: 13
                }, this);
            })
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
            lineNumber: 238,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/hotkey/hotkey-state.tsx",
        lineNumber: 227,
        columnNumber: 5
    }, this);
}
_s2(HotkeysProvider, "MYgX6Sa6XjJ0jf6cJVvuRSbfpg0=", false, function() {
    return [
        useHotkeys,
        jotai__WEBPACK_IMPORTED_MODULE_11__.useAtom,
        useHotkeysRegister,
        _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__.useKeyEscape
    ];
});
_c = HotkeysProvider;
var _c;
$RefreshReg$(_c, "HotkeysProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/index.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var react_dom_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/client.js");
/* harmony import */var _api_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/api.ts");
/* harmony import */var _app_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/app.tsx");
/* harmony import */var _locale_i18n_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/locale/i18n.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");





const root = react_dom_client__WEBPACK_IMPORTED_MODULE_1__.createRoot(document.getElementById('root'));
root.render(/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_app_js__WEBPACK_IMPORTED_MODULE_3__.App, {}, void 0, false, {
    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/index.tsx",
    lineNumber: 8,
    columnNumber: 13
}, undefined));

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/locale/i18n.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _langs_en_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/locale/langs/en.ts");
/* harmony import */var _langs_zh_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/locale/langs/zh.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



const resources = {
    en: {
        translation: _langs_en_js__WEBPACK_IMPORTED_MODULE_1__.langEn
    },
    zh: {
        translation: _langs_zh_js__WEBPACK_IMPORTED_MODULE_2__.langZh
    }
};
i18next__WEBPACK_IMPORTED_MODULE_0__["default"].init({
    resources,
    lng: __webpack_require__.g.navigator.languages.at(0) ?? 'en'
}).catch(console.error);

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/locale/langs/en.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  langEn: function() { return langEn; }
});
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
const langEn = {
    setting: {
        title: 'Settings',
        autoNextSection: 'Auto Next Section',
        timer: 'Timer (Minute)',
        personReplace: '中文人称替换',
        speed: '$t(speed)',
        userColorScheme: 'Color Scheme',
        paragraphRepeat: 'Paragraph Repeat',
        disabledVertical: 'Disable Vertical Direction',
        pageList: 'Split Page',
        pageListType: {
            none: 'None',
            auto: 'Auto',
            single: 'Single',
            double: 'Double'
        },
        fontSize: 'Font Size'
    },
    hotkey: {
        title: 'Hotkeys',
        escape: 'Quit / Cancel',
        ok: 'Ok',
        speedUp: 'Increase speed',
        speedDown: 'Decrease speed',
        fontSizeUp: 'Increase font size',
        fontSizeDown: 'Decrease font size',
        reload: 'Reload',
        helper: 'Show the hotkeys',
        speakBookName: 'Speak selected book name',
        playToggle: 'Play / Pause',
        navToggle: 'Toggle table contents panel',
        prevNav: 'Select previous nav',
        nextNav: 'Select next nav',
        gotoNav: 'Go to selected nav',
        speakNav: 'Speak selected nav',
        annotationsPanelToggle: 'Toggle annotations panel',
        annotationToggle: 'Add / Remove annotation for current paragraph',
        annotationNote: 'Note current annotation',
        annotationRemoveSelected: 'Remove selected annotation',
        prevAnnotation: 'Select previous annotation',
        nextAnnotation: 'Select next annotation',
        gotoAnnotation: 'Go to selected annotation',
        speakAnnotation: 'Speak selected annotation',
        keywordPanelToggle: 'Toggle keywords panel',
        keywordAdd: 'Add current selected keyword',
        keywordNote: 'Note current keyword',
        keywordRemoveSelected: 'Remove selected keyword',
        prevKeyword: 'Select previous keyword',
        nextKeyword: 'Select next keyword',
        gotoKeyword: 'Go to selected keyword',
        speakKeyword: 'Speak selected keyword',
        goBack: 'Go back books index',
        prevSection: 'Go to previous book section',
        nextSection: 'Go to next book section',
        firstPage: 'Scroll to first book page',
        lastPage: 'Scroll to last book page',
        jumpPrevPage: 'Go to previous book page',
        jumpNextPage: 'Go to next book page',
        prevPage: 'Scroll to previous book page',
        nextPage: 'Scroll to next book page',
        firstParagraph: 'Go to first paragraph',
        lastParagraph: 'Go to last paragraph',
        prevParagraph: 'Go to previous paragraph',
        nextParagraph: 'Go to next paragraph',
        prevSearchResult: 'Go to previous search result',
        nextSearchResult: 'Go to next search result',
        gotoSearchResult: 'Go to selected search result',
        goPrev: 'Go to previous',
        goNext: 'Go to next',
        goTop: 'Go to the top',
        goBottom: 'Move selection to bottom',
        goPagePrev: 'Go to previous page',
        goPageNext: 'Go to next page',
        goPageFirst: 'Go to first page',
        goPageLast: 'Go to last page',
        goMovePrev: 'Move selection to previous',
        goMoveNext: 'Move selection to next',
        goMoveTop: 'Move selection to top',
        listArchive: 'Toggle display of list archived books',
        listFavorite: 'Toggle display of list favorited books',
        archive: 'Toggle archive',
        favorite: 'Toggle favorite',
        search: 'Focus to search input',
        sortOrder: 'Select sort order',
        edit: 'Edit current selection',
        select: 'Toggle select',
        selectShift: 'Mark from last select to current as selected',
        selectAll: 'Toggle select all',
        open: 'Open current selection',
        editBook: 'Edit book',
        remove: 'Remove current selection',
        pinchUp: 'Move up',
        pinchDown: 'Move down',
        pinchLeft: 'Move left',
        pinchRight: 'Move right',
        pinchZoomOut: 'Zoom out',
        pinchZoomIn: 'Zoom in',
        pinchReset: 'Reset zoom'
    },
    confirm: {
        ok: 'Ok',
        cancel: 'Cancel',
        openLink: '$t(open) $t(link)?'
    },
    desc: {
        bookAddedSuccessful: 'Successfully added a new book',
        annotationUpdated: 'Updated a $t(annotation)',
        annotationDeleted: 'Deleted a $t(annotation)',
        annotationNoSupported: 'No support $t(annotation) type',
        annotationsEmpty: '$t(annotation)s empty',
        keywordUpdated: 'Updated a $t(keyword)',
        keywordDeleted: 'Deleted a $t(keyword)',
        keywordNoSupported: 'No support $t(keyword) type',
        keywordsEmpty: '$t(keywords) empty',
        navEmpty: '$t(nav) empty'
    },
    prompt: {
        inputBookName: 'Please input $t(bookName).',
        selectLanguage: 'Please select the $t(language).',
        inputAccount: 'Please input your $t(account).',
        inputPassword: 'Please input your $t(password).',
        dropHere: 'drop .epub file、.txt file、text or URL to here.',
        dropHereToRemove: 'Drop here to remove it.',
        annotationRemoveConfirm: 'Remove this $t(annotation) with $t(note)?',
        keywordRemoveConfirm: 'Remove this $t(keyword) with $t(note)?',
        uploadBook: 'Support .epub and .txt.',
        noBooks: 'No books here, Add your first book.',
        noSearchMatches: 'No search matches'
    },
    sortOrder: {
        label: 'Sort order',
        item: {
            default: 'Default',
            reverse: 'Reverse',
            name: 'Name',
            nameReverse: 'Name reverse'
        }
    },
    error: {
        login: '$t(account) or $t(password) error'
    },
    title: 'Title',
    note: 'Note',
    speed: 'Speed',
    fontSize: 'Font Size',
    view: 'View',
    account: 'Account',
    password: 'Password',
    login: 'Login',
    logout: 'Logout',
    submit: 'Submit',
    select: 'Select',
    add: 'Add',
    tmpStore: 'Store temporary file',
    top: 'Top',
    edit: 'Edit',
    editBook: 'Edit book',
    remove: 'Remove',
    update: 'Update',
    export: 'Export',
    bookName: 'Book name',
    favorite: 'Favorite',
    archive: 'Archive',
    unarchive: 'Unarchive',
    search: 'Search',
    cover: 'Cover',
    nav: 'Table contents',
    annotation: 'Annotation',
    keyword: 'Keyword',
    alias: 'Alias',
    open: 'open',
    url: 'URL',
    extractUrlInfo: 'Extract URL info',
    bookContent: 'Book content',
    language: 'Language',
    empty: 'Empty',
    file: 'File',
    text: 'Text',
    system: 'System',
    dark: 'Dark',
    light: 'Light',
    cancel: 'Cancel',
    all: 'All'
};

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/locale/langs/zh.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  langZh: function() { return langZh; }
});
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
const langZh = {
    setting: {
        title: '设置',
        autoNextSection: '自动下一章节',
        timer: '计时器 (分钟)',
        personReplace: '中文人称替换',
        speed: '$t(speed)',
        userColorScheme: '颜色主题',
        paragraphRepeat: '段落重复',
        disabledVertical: '禁用垂直方向',
        pageList: '分页',
        pageListType: {
            none: '无',
            auto: '自动',
            single: '单页',
            double: '双页'
        },
        fontSize: '字体大小'
    },
    hotkey: {
        title: '快捷键',
        escape: '退出 / 取消',
        ok: '确定',
        speedUp: '提高速度',
        speedDown: '降低速度',
        fontSizeUp: '提高字体大小',
        fontSizeDown: '降低字体大小',
        reload: '刷新页面',
        helper: '显示快捷键',
        speakBookName: '朗读选择的书名',
        playToggle: '播放 / 暂停',
        navToggle: '开关显示导航',
        prevNav: '选择上一个导航',
        nextNav: '选择下一个导航',
        gotoNav: '跳转到选择的导航',
        speakNav: '朗读选择的导航',
        annotationsPanelToggle: '开关显示注解',
        annotationToggle: '添加或删除当前段落的注解',
        annotationNote: '添加当前段落的注解的备注',
        annotationRemoveSelected: '删除选择的注解',
        prevAnnotation: '选择上一个注解',
        nextAnnotation: '选择下一个注解',
        gotoAnnotation: '跳转到选择的注解',
        speakAnnotation: '朗读选择的注解',
        keywordPanelToggle: '开关显示关键字',
        keywordAdd: '添加当前选择关键字',
        keywordNote: '添加当前关键字的备注',
        keywordRemoveSelected: '删除选择的关键字',
        prevKeyword: '选择上一个关键字',
        nextKeyword: '选择下一个关键字',
        gotoKeyword: '跳转到选择的关键字',
        speakKeyword: '朗读选择的关键字',
        goBack: '回到书本目录',
        prevSection: '跳到本书上一部份',
        nextSection: '跳到本书下一部份',
        firstPage: '滚动到本书第一页',
        lastPage: '滚动到本书最后一页',
        jumpPrevPage: '跳到本书上一页面',
        jumpNextPage: '跳到本书下一页面',
        prevPage: '滚动到本书上一页面',
        nextPage: '滚动到本书下一页面',
        firstParagraph: '跳到本书第一段落',
        lastParagraph: '跳到本书最后一段落',
        prevParagraph: '跳到本书上一段落',
        nextParagraph: '跳到本书下一段落',
        prevSearchResult: '选择上一个搜索结果',
        nextSearchResult: '选择下一个搜索结果',
        gotoSearchResult: '跳转到选择的搜索结果',
        goPrev: '去到上一个',
        goNext: '去到下一个',
        goTop: '去到顶部',
        goBottom: '去到底部',
        goPagePrev: '去到上一页面',
        goPageNext: '去到下一页面',
        goPageFirst: '去到第一页',
        goPageLast: '去到最后一页',
        goMovePrev: '挪到上一个',
        goMoveNext: '挪到下一个',
        goMoveTop: '挪到顶部',
        listArchive: '开关显示存档列表',
        listFavorite: '开关显示喜欢列表',
        archive: '开关存档',
        favorite: '开关喜欢',
        search: '聚焦到搜索输入框',
        sortOrder: '选择排序',
        edit: '编辑当前选择',
        select: '开关选择',
        selectShift: '把最后一次选择至当位置的标记为选择',
        selectAll: '开关选择全部',
        open: '打开当前选择',
        editBook: '编辑本书',
        remove: '删除当前选择',
        pinchUp: '上移',
        pinchDown: '下移',
        pinchLeft: '左移',
        pinchRight: '右移',
        pinchZoomOut: '缩小',
        pinchZoomIn: '放大',
        pinchReset: '重置'
    },
    confirm: {
        ok: '确定',
        cancel: '取消',
        openLink: '$t(open)$t(link)?'
    },
    desc: {
        bookAddedSuccessful: '成功添加了一本新书',
        annotationUpdated: '更新了一个$t(annotation)',
        annotationDeleted: '删除了一个$t(annotation)',
        annotationNoSupported: '不支持的$t(annotation)类型',
        annotationsEmpty: '$t(annotation)为空',
        keywordUpdated: '更新了一个$t(keyword)',
        keywordDeleted: '删除了一个$t(keyword)',
        keywordNoSupported: 'No support $t(keyword) type',
        keywordsEmpty: '$t(keyword)为空',
        navEmpty: '$t(nav)为空'
    },
    prompt: {
        inputBookName: '请输入$t(bookName)',
        selectLanguage: '请选择$t(language)',
        inputAccount: '请输入$t(account)',
        inputPassword: '请输入$t(password)',
        dropHere: '拖动 .epub 文件、.txt 文件、文本或 URL 到这里。',
        dropHereToRemove: '拖放到这里删除。',
        annotationRemoveConfirm: '删除此$t(annotation)和$t(note)吗?',
        keywordRemoveConfirm: '删除此$t(keyword)吗?',
        uploadBook: '支持 .epub 和 .txt',
        noBooks: '这里没有书籍，添加你的第一本书吧。',
        noSearchMatches: '没有找到匹配项'
    },
    sortOrder: {
        label: '排序',
        item: {
            default: '默认',
            reverse: '反序',
            name: '名称',
            nameReverse: '名称反序'
        }
    },
    error: {
        login: '$t(account)或$t(password)错误'
    },
    title: '标题',
    note: '备注',
    speed: '速度',
    fontSize: '字体大小',
    view: '浏览',
    account: '帐号',
    password: '密码',
    login: '登录',
    logout: '登出',
    submit: '提交',
    select: '选择',
    add: '添加',
    tmpStore: '存储临时文件',
    top: '置顶',
    edit: '编辑',
    editBook: '编辑本书',
    remove: '删除',
    update: '更新',
    export: '导出',
    bookName: '书名',
    favorite: '喜欢',
    archive: '存档',
    unarchive: '取消存档',
    search: '搜索',
    cover: '封面',
    nav: '导航',
    annotation: '注解',
    keyword: '关键词',
    alias: '别名',
    open: '打开',
    url: 'URL',
    extractUrlInfo: '提取URL信息',
    bookContent: '文本内容',
    language: '语言',
    empty: '空',
    file: '文件',
    text: '文本',
    system: '系统',
    dark: '暗色',
    light: '亮色',
    cancel: '取消',
    all: '全部'
};

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/add-successful.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookAddSuccessful: function() { return BookAddSuccessful; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/alert/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _components_link_wrap_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/link-wrap.tsx");
/* harmony import */var _not_found_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/not-found.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();








function BookAddSuccessful() {
    _s();
    const { uuid } = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_6__.useParams)();
    if (!uuid) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_not_found_js__WEBPACK_IMPORTED_MODULE_5__.NotFound, {
        title: "book"
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
        lineNumber: 13,
        columnNumber: 21
    }, this);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_2__.FlexBox, {
        gap: 4,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"], {
                type: "success",
                message: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.bookAddedSuccessful')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
                lineNumber: 17,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_link_wrap_js__WEBPACK_IMPORTED_MODULE_4__.LinkWrap, {
                to: `/books/view/${uuid}`,
                children: (href)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
                        type: "primary",
                        href: href,
                        icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_3__.Icon, {
                            icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_9__.faEye
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
                            lineNumber: 20,
                            columnNumber: 52
                        }, void 0),
                        children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('view')
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
                        lineNumber: 20,
                        columnNumber: 11
                    }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
                lineNumber: 18,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add-successful.tsx",
        lineNumber: 16,
        columnNumber: 5
    }, this);
}
_s(BookAddSuccessful, "/IiROcFL4bMr8gYCJlTjGGhD3KY=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_6__.useParams
    ];
});
_c = BookAddSuccessful;
var _c;
$RefreshReg$(_c, "BookAddSuccessful");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/add.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookAdd: function() { return BookAdd; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _add_file_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/pages/books/add/file.tsx");
/* harmony import */var _add_text_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/pages/books/add/text.tsx");
/* harmony import */var _add_url_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/books/add/url.tsx");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/tabs/index.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






function BookAdd() {
    _s();
    const [tab, setTab] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)('text');
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
        defaultActiveKey: tab,
        onChange: (k)=>setTab(k),
        destroyInactiveTabPane: true,
        items: [
            {
                key: 'text',
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('text'),
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_add_text_js__WEBPACK_IMPORTED_MODULE_4__.AddText, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add.tsx",
                    lineNumber: 21,
                    columnNumber: 21
                }, void 0)
            },
            {
                key: 'file',
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('file'),
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_add_file_js__WEBPACK_IMPORTED_MODULE_3__.AddFile, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add.tsx",
                    lineNumber: 26,
                    columnNumber: 21
                }, void 0)
            },
            {
                key: 'url',
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('url'),
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_add_url_js__WEBPACK_IMPORTED_MODULE_5__.AddUrl, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add.tsx",
                    lineNumber: 31,
                    columnNumber: 21
                }, void 0)
            }
        ]
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add.tsx",
        lineNumber: 13,
        columnNumber: 5
    }, this);
}
_s(BookAdd, "Otw37rWzWgM/aAL/Ssa/uszOi/s=");
_c = BookAdd;
var _c;
$RefreshReg$(_c, "BookAdd");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/add/file.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  AddFile: function() { return AddFile; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@file-services+path@9.4.1/node_modules/@file-services/path/browser-path.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_file_services_path__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/create.ts");
/* harmony import */var _core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/book/book-epub.ts");
/* harmony import */var _core_lang_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/lang.ts");
/* harmony import */var _core_util_converter_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/core/util/converter.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _components_file_input_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/components/file-input.tsx");
/* harmony import */var _components_language_select_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/components/language-select.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();












function AddFile() {
    _s();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_11__.useNavigate)();
    const [submitted, setSubmitted] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
    const [form] = antd__WEBPACK_IMPORTED_MODULE_12__["default"].useForm();
    const file = antd__WEBPACK_IMPORTED_MODULE_12__["default"].useWatch('file', form);
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_8__.async)(async ()=>{
            if (file.name.endsWith('.epub')) {
                const buf = await file.arrayBuffer();
                const epub = await _core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_5__.BookEpub.read(buf);
                if (!epub) return;
                const ext = _file_services_path__WEBPACK_IMPORTED_MODULE_2___default().extname(file.name);
                const basename = _file_services_path__WEBPACK_IMPORTED_MODULE_2___default().basename(file.name, ext);
                form.setFieldValue('name', epub.title ?? basename);
                const langCode = (0,_core_lang_js__WEBPACK_IMPORTED_MODULE_6__.parseLangCode)(epub.language);
                if (langCode) {
                    form.setFieldValue('langCode', langCode);
                }
            }
        });
    }, [
        file,
        form
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
        form: form,
        style: {
            margin: '20px auto 0',
            maxWidth: '800px'
        },
        initialValues: {
            name: '',
            langCode: null,
            file: null
        },
        onFinish: (values)=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_8__.async)(async ()=>{
                try {
                    setSubmitted(true);
                    if (values.file.name.endsWith('.epub')) {
                        const buf = await values.file.arrayBuffer();
                        const fileBase64 = (0,_core_util_converter_js__WEBPACK_IMPORTED_MODULE_7__.arrayBufferToBase64)(buf);
                        const entity = await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_4__.booksCreateRouter.action({
                            name: values.name,
                            langCode: values.langCode,
                            bufferBase64: fileBase64,
                            type: 'epub'
                        });
                        nav(`/books/added-successful/${entity.uuid}`);
                    } else if (values.file.name.endsWith('.txt')) {
                        const buf = await values.file.arrayBuffer();
                        const fileBase64 = (0,_core_util_converter_js__WEBPACK_IMPORTED_MODULE_7__.arrayBufferToBase64)(buf);
                        const entity = await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_4__.booksCreateRouter.action({
                            name: values.name,
                            langCode: values.langCode,
                            bufferBase64: fileBase64,
                            type: 'text'
                        });
                        nav(`/books/added-successful/${entity.uuid}`);
                    }
                } finally{
                    setSubmitted(false);
                }
            });
        },
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName'),
                name: "name",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_13__["default"], {
                    placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputBookName')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                    lineNumber: 87,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                lineNumber: 86,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('language'),
                name: "langCode",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_language_select_js__WEBPACK_IMPORTED_MODULE_10__.LanguageSelect, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                    lineNumber: 94,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                lineNumber: 89,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('file'),
                name: "file",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_file_input_js__WEBPACK_IMPORTED_MODULE_9__.FileInput, {
                    onChange: (files)=>{
                        const file = files.at(0);
                        if (!file) return;
                        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_8__.async)(async ()=>{});
                    },
                    prompt: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.uploadBook')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                    lineNumber: 97,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                lineNumber: 96,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"].Item, {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_14__["default"], {
                    block: true,
                    type: "primary",
                    htmlType: "submit",
                    loading: submitted,
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('add')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                    lineNumber: 107,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
                lineNumber: 106,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/file.tsx",
        lineNumber: 44,
        columnNumber: 5
    }, this);
}
_s(AddFile, "IDBnVx/LwH8Cc54UGtRDozY9bMU=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_11__.useNavigate,
        antd__WEBPACK_IMPORTED_MODULE_12__["default"].useForm,
        antd__WEBPACK_IMPORTED_MODULE_12__["default"].useWatch
    ];
});
_c = AddFile;
var _c;
$RefreshReg$(_c, "AddFile");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/add/text.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  AddText: function() { return AddText; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/create.ts");
/* harmony import */var _core_util_converter_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/util/converter.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _core_util_text_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/util/text.ts");
/* harmony import */var _components_language_select_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/language-select.tsx");
/* harmony import */var _components_textarea_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/components/textarea.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();










function AddText() {
    _s();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_9__.useNavigate)();
    const [submitted, setSubmitted] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [form] = antd__WEBPACK_IMPORTED_MODULE_10__["default"].useForm();
    const content = antd__WEBPACK_IMPORTED_MODULE_10__["default"].useWatch('content', form);
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!content) return;
        const name = form.getFieldValue('name');
        if (!name) {
            const lines = (0,_core_util_text_js__WEBPACK_IMPORTED_MODULE_6__.splitLines)(content);
            const newName = lines.find((line)=>!!line.trim());
            if (newName) form.setFieldValue('name', newName);
        }
    }, [
        content,
        form
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"], {
        form: form,
        style: {
            margin: '20px auto 0',
            maxWidth: '800px'
        },
        initialValues: {
            name: '',
            langCode: null,
            content: ''
        },
        onFinish: (values)=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_5__.async)(async ()=>{
                try {
                    setSubmitted(true);
                    const buf = new TextEncoder().encode(values.content);
                    const fileBase64 = (0,_core_util_converter_js__WEBPACK_IMPORTED_MODULE_4__.arrayBufferToBase64)(buf);
                    const entity = await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_3__.booksCreateRouter.action({
                        name: values.name,
                        langCode: values.langCode,
                        bufferBase64: fileBase64,
                        type: 'text'
                    });
                    nav(`/books/added-successful/${entity.uuid}`);
                } finally{
                    setSubmitted(false);
                }
            });
        },
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName'),
                name: "name",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                    placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputBookName')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                    lineNumber: 67,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                lineNumber: 66,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('language'),
                name: "langCode",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_language_select_js__WEBPACK_IMPORTED_MODULE_7__.LanguageSelect, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                    lineNumber: 74,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                lineNumber: 69,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookContent'),
                name: "content",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_textarea_js__WEBPACK_IMPORTED_MODULE_8__.Textarea, {
                    rows: 6
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                    lineNumber: 81,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                lineNumber: 76,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Item, {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
                    block: true,
                    htmlType: "submit",
                    type: "primary",
                    loading: submitted,
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('add')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                    lineNumber: 84,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
                lineNumber: 83,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/text.tsx",
        lineNumber: 36,
        columnNumber: 5
    }, this);
}
_s(AddText, "CUqHdAuxd4HZqzFiafMXskQQZIs=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_9__.useNavigate,
        antd__WEBPACK_IMPORTED_MODULE_10__["default"].useForm,
        antd__WEBPACK_IMPORTED_MODULE_10__["default"].useWatch
    ];
});
_c = AddText;
var _c;
$RefreshReg$(_c, "AddText");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/add/url.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  AddUrl: function() { return AddUrl; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/create-by-url.ts");
/* harmony import */var _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/fetch-url-info.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _components_language_select_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/components/language-select.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();








function AddUrl() {
    _s();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.useNavigate)();
    const [isFetchingURL, setIsFetchingURL] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [submitted, setSubmitted] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [form] = antd__WEBPACK_IMPORTED_MODULE_8__["default"].useForm();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
            form: form,
            style: {
                margin: '20px auto 0',
                maxWidth: '800px'
            },
            initialValues: {
                name: '',
                langCode: null,
                url: ''
            },
            onFinish: (values)=>{
                (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_5__.async)(async ()=>{
                    try {
                        setSubmitted(true);
                        const entity = await _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_3__.booksCreateByUrlRouter.action({
                            name: values.name,
                            langCode: values.langCode,
                            url: values.url
                        });
                        nav(`/books/added-successful/${entity.uuid}`);
                    } finally{
                        setSubmitted(false);
                    }
                });
            },
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                    label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName'),
                    name: "name",
                    rules: [
                        {
                            required: true
                        }
                    ],
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
                        placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputBookName')
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                        lineNumber: 57,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                    lineNumber: 52,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                    label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('language'),
                    name: "langCode",
                    rules: [
                        {
                            required: true
                        }
                    ],
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_language_select_js__WEBPACK_IMPORTED_MODULE_6__.LanguageSelect, {}, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                        lineNumber: 64,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                    lineNumber: 59,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                    label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('url'),
                    name: "url",
                    rules: [
                        {
                            required: true
                        }
                    ],
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Compact, {
                        style: {
                            width: '100%'
                        },
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {}, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                                lineNumber: 68,
                                columnNumber: 13
                            }, this),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                                style: {
                                    alignSelf: 'center'
                                },
                                type: "primary",
                                loading: isFetchingURL,
                                onClick: ()=>{
                                    const url = form.getFieldValue('url');
                                    if (!url) return;
                                    setIsFetchingURL(true);
                                    _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_4__.booksFetchUrlInfoRouter.action({
                                        url
                                    }).then((info)=>{
                                        form.setFieldValue('name', info.title);
                                        if (info.lang) form.setFieldValue('langCode', info.lang);
                                    }).catch(console.error).finally(()=>setIsFetchingURL(false));
                                },
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('extractUrlInfo')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                                lineNumber: 69,
                                columnNumber: 13
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                        lineNumber: 67,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                    lineNumber: 66,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                        block: true,
                        htmlType: "submit",
                        type: "primary",
                        loading: submitted,
                        children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('add')
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                        lineNumber: 92,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
                    lineNumber: 91,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/add/url.tsx",
            lineNumber: 25,
            columnNumber: 7
        }, this)
    }, void 0, false);
}
_s(AddUrl, "pXBlQ54rwbrF2oWejHkm8DgFKc4=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_7__.useNavigate,
        antd__WEBPACK_IMPORTED_MODULE_8__["default"].useForm
    ];
});
_c = AddUrl;
var _c;
$RefreshReg$(_c, "AddUrl");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/edit.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookEditDialog: function() { return BookEditDialog; },
  useBookEditDialog: function() { return useBookEditDialog; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useSyncedRef/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_api_books_show_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/show.ts");
/* harmony import */var _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/update.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _components_language_select_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/language-select.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/components/spin.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$();











function UpdateForm(param) {
    let { book, reload } = param;
    _s();
    const [form] = antd__WEBPACK_IMPORTED_MODULE_9__["default"].useForm();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
        form: form,
        initialValues: {
            name: book.name,
            langCode: book.langCode
        },
        onFinish: (values)=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_6__.async)(async ()=>{
                await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_4__.booksUpdateRouter.action({
                    uuid: book.uuid,
                    update: {
                        name: values.name,
                        langCode: values.langCode
                    }
                });
                reload();
            });
        },
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName'),
                name: "name",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"], {
                    autoFocus: true,
                    placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputBookName')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                    lineNumber: 50,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                lineNumber: 49,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"].Item, {
                label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('language'),
                name: "langCode",
                rules: [
                    {
                        required: true
                    }
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_language_select_js__WEBPACK_IMPORTED_MODULE_7__.LanguageSelect, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                    lineNumber: 57,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                lineNumber: 52,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"].Item, {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                    block: true,
                    htmlType: "submit",
                    type: "primary",
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('update')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                    lineNumber: 60,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
                lineNumber: 59,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
        lineNumber: 30,
        columnNumber: 5
    }, this);
}
_s(UpdateForm, "rI7DrJIrFu7YmlGWYiMFTzs8jF0=", false, function() {
    return [
        antd__WEBPACK_IMPORTED_MODULE_9__["default"].useForm
    ];
});
_c = UpdateForm;
function BookEditReq(param) {
    let { uuid, reload } = param;
    _s1();
    const { data: bookItem } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction)(_core_api_books_show_js__WEBPACK_IMPORTED_MODULE_3__.booksShowRouter, {
        uuid
    });
    if (!bookItem) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_8__.SpinCenter, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
        lineNumber: 71,
        columnNumber: 25
    }, this);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(UpdateForm, {
        book: bookItem,
        reload: reload
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
        lineNumber: 73,
        columnNumber: 10
    }, this);
}
_s1(BookEditReq, "aWVjzRSmRZ9BUn/edlkNIKL92bM=", false, function() {
    return [
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction
    ];
});
_c1 = BookEditReq;
const bookEditDialogAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_12__.atom)({
    uuid: null,
    reloads: []
});
function useBookEditDialog(reload) {
    _s2();
    const reloadRef = (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_13__.useSyncedRef)(reload);
    const [, setBookEditDialog] = (0,jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom)(bookEditDialogAtom);
    const openBookEdit = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((uuid)=>{
        setBookEditDialog((s)=>({
                ...s,
                uuid
            }));
    }, [
        setBookEditDialog
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const reloadHook = ()=>{
            reloadRef.current();
        };
        setBookEditDialog((s)=>({
                ...s,
                reloads: [
                    ...s.reloads,
                    reloadHook
                ]
            }));
        return ()=>{
            setBookEditDialog((s)=>({
                    ...s,
                    reloads: s.reloads.filter((r)=>r !== reloadHook)
                }));
        };
    }, [
        reloadRef,
        setBookEditDialog
    ]);
    return {
        openBookEdit
    };
}
_s2(useBookEditDialog, "oC8Evac6jU12ioPblnNXpxSFpAg=", false, function() {
    return [
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_13__.useSyncedRef,
        jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom
    ];
});
function BookEditDialog() {
    _s3();
    const [bookEditDialog, setBookEditDialog] = (0,jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom)(bookEditDialogAtom);
    const onClose = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        setBookEditDialog((s)=>({
                ...s,
                uuid: null
            }));
    }, [
        setBookEditDialog
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_15__["default"], {
        open: !!bookEditDialog.uuid,
        onCancel: onClose,
        title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('editBook'),
        footer: false,
        children: bookEditDialog.uuid && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookEditReq, {
            uuid: bookEditDialog.uuid,
            reload: ()=>{
                onClose();
                bookEditDialog.reloads.forEach((r)=>r());
            }
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
            lineNumber: 122,
            columnNumber: 9
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/edit.tsx",
        lineNumber: 115,
        columnNumber: 5
    }, this);
}
_s3(BookEditDialog, "gV/5eAqMQEbekTrOfKwDfadX1ts=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom
    ];
});
_c2 = BookEditDialog;
var _c, _c1, _c2;
$RefreshReg$(_c, "UpdateForm");
$RefreshReg$(_c1, "BookEditReq");
$RefreshReg$(_c2, "BookEditDialog");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/entry.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BooksEntry: function() { return BooksEntry; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _not_found_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/not-found.tsx");
/* harmony import */var _add_successful_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/pages/books/add-successful.tsx");
/* harmony import */var _add_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/pages/books/add.tsx");
/* harmony import */var _edit_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/pages/books/edit.tsx");
/* harmony import */var _index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/books/index.tsx");
/* harmony import */var _view_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/pages/books/view.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");








function BooksEntry() {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_edit_js__WEBPACK_IMPORTED_MODULE_4__.BookEditDialog, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                lineNumber: 12,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Routes, {
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Route, {
                        path: "/",
                        element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index_js__WEBPACK_IMPORTED_MODULE_5__.BookList, {}, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                            lineNumber: 14,
                            columnNumber: 34
                        }, void 0)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                        lineNumber: 14,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Route, {
                        path: "/add",
                        element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_add_js__WEBPACK_IMPORTED_MODULE_3__.BookAdd, {}, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                            lineNumber: 15,
                            columnNumber: 37
                        }, void 0)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                        lineNumber: 15,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Route, {
                        path: "/added-successful/:uuid",
                        element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_add_successful_js__WEBPACK_IMPORTED_MODULE_2__.BookAddSuccessful, {}, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                            lineNumber: 18,
                            columnNumber: 20
                        }, void 0)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                        lineNumber: 16,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Route, {
                        path: "/view/:uuid",
                        element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_view_js__WEBPACK_IMPORTED_MODULE_6__.BookView, {}, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                            lineNumber: 20,
                            columnNumber: 44
                        }, void 0)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                        lineNumber: 20,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_7__.Route, {
                        path: "*",
                        element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_not_found_js__WEBPACK_IMPORTED_MODULE_1__.NotFound, {
                            title: "page"
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                            lineNumber: 21,
                            columnNumber: 34
                        }, void 0)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                        lineNumber: 21,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/entry.tsx",
                lineNumber: 13,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true);
}
_c = BooksEntry;
var _c;
$RefreshReg$(_c, "BooksEntry");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/index-atoms.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  activatedIndexAtom: function() { return activatedIndexAtom; },
  archivedAtom: function() { return archivedAtom; },
  favoritedAtom: function() { return favoritedAtom; },
  orderAtom: function() { return orderAtom; },
  perPageAtom: function() { return perPageAtom; },
  searchAtom: function() { return searchAtom; },
  usePage: function() { return usePage; }
});
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
var _s = $RefreshSig$();


const pageAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)(1);
const perPageAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)(15);
const activatedIndexAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)(0);
const archivedAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)(false);
const favoritedAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)(false);
const searchAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)('');
const orderAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)('default');
const usePage = ()=>{
    _s();
    const [page, setPage] = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom)(pageAtom);
    const [, setActivatedIndex] = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom)(activatedIndexAtom);
    const goPage = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((action)=>{
        setActivatedIndex(0);
        setPage(action);
    }, [
        setActivatedIndex,
        setPage
    ]);
    return [
        page,
        goPage
    ];
};
_s(usePage, "Q0WwJCN2bR1V//1k7ZhYtZBkWyU=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom
    ];
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/index.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookList: function() { return BookList; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_regular_svg_icons__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-regular-svg-icons@6.6.0/node_modules/@fortawesome/free-regular-svg-icons/index.mjs");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/dropdown/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/checkbox/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/tag/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/pagination/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/switch/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/select/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/alert/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_dnd__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__("./node_modules/.pnpm/react-dnd@16.0.1_@types+node@22.7.3_@types+react@18.3.9_react@18.3.1/node_modules/react-dnd/dist/hooks/useDrop/useDrop.js");
/* harmony import */var react_dnd__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__("./node_modules/.pnpm/react-dnd@16.0.1_@types+node@22.7.3_@types+react@18.3.9_react@18.3.1/node_modules/react-dnd/dist/hooks/useDrag/useDrag.js");
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_cover_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/cover.ts");
/* harmony import */var _core_api_books_download_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/download.ts");
/* harmony import */var _core_api_books_move_after_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/api/books/move-after.ts");
/* harmony import */var _core_api_books_move_top_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/api/books/move-top.ts");
/* harmony import */var _core_api_books_page_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/core/api/books/page.ts");
/* harmony import */var _core_api_books_remove_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/core/api/books/remove.ts");
/* harmony import */var _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/core/api/books/update.ts");
/* harmony import */var _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/core/book/enums.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _core_util_antd_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/core/util/antd.tsx");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _core_util_speech_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/core/util/speech.ts");
/* harmony import */var _common_confirm_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/web/common/confirm.tsx");
/* harmony import */var _common_preview_image_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/web/common/preview-image.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _components_link_wrap_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./src/web/components/link-wrap.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./src/web/components/spin.tsx");
/* harmony import */var _hooks_use_synced_debounce_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__("./src/web/hooks/use-synced-debounce.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__("./src/web/store.tsx");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__("./src/web/pages/layout/use-app-bar.tsx");
/* harmony import */var _index_atoms_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__("./src/web/pages/books/index-atoms.tsx");
/* harmony import */var _edit_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__("./src/web/pages/books/edit.tsx");
/* harmony import */var _index_module_scss__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__("./src/web/pages/books/index.module.scss?58d9");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$(), _s4 = $RefreshSig$(), _s5 = $RefreshSig$(), _s6 = $RefreshSig$();

































const DragType = 'book';
function viewPath(uuid) {
    return `/books/view/${uuid}`;
}
const moveOffset = async (books, currentIndex, offset)=>{
    if (offset === 0) return;
    const currentEntity = books.at(currentIndex);
    if (!currentEntity) return;
    const uuid = currentEntity.uuid;
    const targetIndex = currentIndex + offset;
    if (targetIndex <= 0) return await _core_api_books_move_top_js__WEBPACK_IMPORTED_MODULE_6__.booksMoveTopRouter.action({
        uuid
    });
    const afterIndex = targetIndex < currentIndex ? targetIndex - 1 : targetIndex;
    const afterBook = books.at(afterIndex);
    if (!afterBook) return;
    await _core_api_books_move_after_js__WEBPACK_IMPORTED_MODULE_5__.booksMoveAfterRouter.action({
        uuid,
        afterUuid: afterBook.uuid
    });
};
function useRemoveBooks(reload) {
    _s();
    const removeBooks = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((books)=>{
        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
            if (await (0,_common_confirm_js__WEBPACK_IMPORTED_MODULE_15__.uiConfirm)({
                title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('remove'),
                description: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
                    children: books.map((book)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
                            children: book.name
                        }, book.uuid, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 107,
                            columnNumber: 19
                        }, this))
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 105,
                    columnNumber: 15
                }, this)
            })) {
                for (const book of books){
                    await _core_api_books_remove_js__WEBPACK_IMPORTED_MODULE_8__.booksRemoveRouter.action({
                        uuid: book.uuid
                    });
                }
                reload();
            }
        });
    }, [
        reload
    ]);
    return removeBooks;
}
_s(useRemoveBooks, "1GW/yQoZYEOZ/enJTyPlUvLXZ1o=");
function useSelector(books) {
    _s1();
    const [lastSelectedIndex, setLastSelectedIndex] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const [selectedUuids, setSelectedUuids] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)([]);
    const selectedBooks = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>(books === null || books === void 0 ? void 0 : books.filter((book)=>selectedUuids.includes(book.uuid))) ?? [], [
        books,
        selectedUuids
    ]);
    const allSelected = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>books === null || books === void 0 ? void 0 : books.every((book)=>selectedUuids.includes(book.uuid)), [
        books,
        selectedUuids
    ]);
    // if books reload, cancel selected
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (books) setSelectedUuids([]);
    }, [
        books
    ]);
    const selectTo = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((index, shift)=>{
        const book = books === null || books === void 0 ? void 0 : books[index];
        if (!book) return;
        setLastSelectedIndex(index);
        let checked = false;
        let targetUuids;
        if (lastSelectedIndex !== undefined && lastSelectedIndex !== index && shift) {
            if (lastSelectedIndex < index) targetUuids = books.slice(lastSelectedIndex, index + 1).map((it)=>it.uuid);
            else targetUuids = books.slice(index, lastSelectedIndex + 1).map((it)=>it.uuid);
            checked = true;
        } else {
            targetUuids = [
                book.uuid
            ];
            checked = !selectedUuids.includes(book.uuid);
        }
        let tmpUuids = [
            ...selectedUuids
        ];
        for (const targetUuid of targetUuids){
            if (checked) {
                if (!tmpUuids.includes(targetUuid)) tmpUuids = [
                    ...tmpUuids,
                    targetUuid
                ];
            } else {
                tmpUuids = tmpUuids.filter((uuid)=>uuid !== targetUuid);
            }
            setSelectedUuids(tmpUuids);
        }
    }, [
        books,
        lastSelectedIndex,
        selectedUuids
    ]);
    const selectAll = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        if (allSelected) setSelectedUuids([]);
        else setSelectedUuids((books === null || books === void 0 ? void 0 : books.map((book)=>book.uuid)) ?? []);
    }, [
        allSelected,
        books
    ]);
    return {
        selectedBooks,
        allSelected,
        selectedUuids,
        selectTo,
        selectAll
    };
}
_s1(useSelector, "5GsL3UR4/hxdIo2T4iKeuC6PvPE=");
function useHomeHotKeys(param) {
    let { focusSearchInput, orderSelectPrev, orderSelectNext, dataBooks, selectTo, selectAll, selectedBooks, reload, moveBooksTop, removeBooks, hasOrder } = param;
    _s2();
    const [activatedIndex, setActivatedIndex] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.activatedIndexAtom);
    const [, setPage] = (0,_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.usePage)();
    const [, setArchived] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.archivedAtom);
    const [, setFavorited] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.favoritedAtom);
    const [isPersonReplace] = (0,_store_js__WEBPACK_IMPORTED_MODULE_22__.usePersonReplace)();
    const [speechSpeed] = (0,_store_js__WEBPACK_IMPORTED_MODULE_22__.useSpeechSpeed)();
    const { getVoice } = (0,_store_js__WEBPACK_IMPORTED_MODULE_22__.useGetVoice)();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_21__.useHotkeys)();
    const { openBookEdit } = (0,_edit_js__WEBPACK_IMPORTED_MODULE_26__.useBookEditDialog)(reload);
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_29__.useNavigate)();
    const currentBook = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>dataBooks === null || dataBooks === void 0 ? void 0 : dataBooks.items[activatedIndex], [
        activatedIndex,
        dataBooks
    ]);
    const actionBooks = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>selectedBooks.length ? selectedBooks : currentBook ? [
            currentBook
        ] : [], [
        currentBook,
        selectedBooks
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const count = (dataBooks === null || dataBooks === void 0 ? void 0 : dataBooks.items.length) ?? 0;
        const goPrev = ()=>{
            setActivatedIndex((activatedIndex)=>activatedIndex > 0 ? activatedIndex - 1 : 0);
        };
        const goTop = ()=>{
            setActivatedIndex(0);
        };
        const goNext = ()=>{
            setActivatedIndex((activatedIndex)=>activatedIndex < count - 1 ? activatedIndex + 1 : activatedIndex);
        };
        const goBottom = ()=>{
            setActivatedIndex(count - 1);
        };
        const pagePrev = ()=>{
            if (dataBooks) {
                setPage((page)=>page > 1 ? page - 1 : dataBooks.pageCount);
            }
        };
        const pageFirst = ()=>{
            if (dataBooks) setPage(1);
        };
        const pageNext = ()=>{
            if (dataBooks) {
                setPage((page)=>page < dataBooks.pageCount ? page + 1 : 1);
            }
        };
        const pageLast = ()=>{
            if (dataBooks) setPage(dataBooks.pageCount);
        };
        const movePrev = async ()=>{
            if (!currentBook || !dataBooks) return;
            goPrev();
            await moveOffset(dataBooks.items, activatedIndex, -1);
            reload();
        };
        const moveNext = async ()=>{
            if (!currentBook || !dataBooks) return;
            goNext();
            await moveOffset(dataBooks.items, activatedIndex, 1);
            reload();
        };
        const select = (shift)=>{
            selectTo(activatedIndex, shift);
        };
        const removeBook = ()=>{
            if (currentBook) removeBooks(actionBooks);
        };
        const moveBookTop = ()=>{
            if (currentBook) void moveBooksTop(actionBooks);
        };
        const toggleListArchive = ()=>{
            setArchived((v)=>!v);
        };
        const toggleListFavorite = ()=>{
            setFavorited((v)=>!v);
        };
        const toggleArchive = ()=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                for (const book of actionBooks){
                    await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__.booksUpdateRouter.action({
                        uuid: book.uuid,
                        update: {
                            isArchived: !book.isArchived
                        }
                    });
                }
                reload();
            });
        };
        const toggleFavorite = ()=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                for (const book of actionBooks){
                    await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__.booksUpdateRouter.action({
                        uuid: book.uuid,
                        update: {
                            isFavorited: !book.isFavorited
                        }
                    });
                }
                reload();
            });
        };
        const speech = new _core_util_speech_js__WEBPACK_IMPORTED_MODULE_14__.Speech();
        const speakBookName = ()=>{
            if (!currentBook) return;
            const voice = getVoice(currentBook);
            if (!voice) return;
            void speech.speak(currentBook.name, {
                voice,
                speed: speechSpeed,
                isPersonReplace
            });
        };
        const hotkeys = [
            // move
            [
                'k',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPrev'),
                goPrev
            ],
            [
                'j',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goNext'),
                goNext
            ],
            [
                'ArrowUp',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPrev'),
                goPrev
            ],
            [
                'ArrowDown',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goNext'),
                goNext
            ],
            [
                'h',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPagePrev'),
                pagePrev
            ],
            [
                'l',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageNext'),
                pageNext
            ],
            [
                'ArrowLeft',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPagePrev'),
                pagePrev
            ],
            [
                'ArrowRight',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageNext'),
                pageNext
            ],
            [
                [
                    'g',
                    'g'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goTop'),
                goTop
            ],
            [
                {
                    shift: true,
                    key: 'g'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goBottom'),
                goBottom
            ],
            [
                {
                    shift: true,
                    key: 'h'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageFirst'),
                pageFirst
            ],
            [
                {
                    shift: true,
                    key: 'l'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageLast'),
                pageLast
            ],
            [
                {
                    shift: true,
                    key: 'ArrowUp'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goTop'),
                goTop
            ],
            [
                {
                    shift: true,
                    key: 'ArrowDown'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goBottom'),
                goBottom
            ],
            [
                {
                    shift: true,
                    key: 'ArrowLeft'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageFirst'),
                pageFirst
            ],
            [
                {
                    shift: true,
                    key: 'ArrowRight'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goPageLast'),
                pageLast
            ],
            // filter
            [
                [
                    's',
                    {
                        shift: true,
                        key: 'E'
                    }
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.listArchive'),
                toggleListArchive
            ],
            [
                [
                    's',
                    'b'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.listFavorite'),
                toggleListFavorite
            ],
            [
                'b',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.favorite'),
                toggleFavorite
            ],
            [
                {
                    shift: true,
                    key: 'E'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.archive'),
                toggleArchive
            ],
            [
                '/',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.search'),
                focusSearchInput
            ],
            [
                [
                    's',
                    's',
                    'n'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.sortOrder'),
                orderSelectNext
            ],
            [
                [
                    's',
                    's',
                    'p'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.sortOrder'),
                orderSelectPrev
            ],
            // selection
            [
                'x',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.select'),
                ()=>select(false)
            ],
            [
                'v',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.select'),
                ()=>select(false)
            ],
            [
                {
                    shift: true,
                    key: 'x'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.selectShift'),
                ()=>select(true)
            ],
            [
                {
                    shift: true,
                    key: 'v'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.selectShift'),
                ()=>select(true)
            ],
            [
                {
                    shift: true,
                    key: 'a'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.selectAll'),
                ()=>selectAll()
            ],
            // action
            [
                't',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goMoveTop'),
                moveBookTop
            ],
            [
                'e',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.edit'),
                ()=>currentBook && openBookEdit(currentBook.uuid)
            ],
            [
                'Enter',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.open'),
                ()=>{
                    if (!currentBook) return;
                    nav(viewPath(currentBook.uuid));
                }
            ],
            [
                {
                    shift: true,
                    key: '#'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.remove'),
                removeBook
            ],
            [
                [
                    'd',
                    'd'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.remove'),
                removeBook
            ],
            [
                {
                    shift: true,
                    key: 'K'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.speakBookName'),
                speakBookName
            ]
        ];
        if (!hasOrder) hotkeys.push([
            {
                ctrl: true,
                key: 'k'
            },
            (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goMovePrev'),
            movePrev
        ], [
            {
                ctrl: true,
                key: 'j'
            },
            (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goMoveNext'),
            moveNext
        ], [
            {
                ctrl: true,
                key: 'ArrowUp'
            },
            (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goMovePrev'),
            movePrev
        ], [
            {
                ctrl: true,
                key: 'ArrowDown'
            },
            (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goMoveNext'),
            moveNext
        ]);
        return addHotkeys(hotkeys);
    }, [
        actionBooks,
        activatedIndex,
        addHotkeys,
        currentBook,
        dataBooks,
        focusSearchInput,
        getVoice,
        hasOrder,
        isPersonReplace,
        moveBooksTop,
        nav,
        openBookEdit,
        orderSelectNext,
        orderSelectPrev,
        reload,
        removeBooks,
        selectAll,
        selectTo,
        setActivatedIndex,
        setArchived,
        setFavorited,
        setPage,
        speechSpeed
    ]);
}
_s2(useHomeHotKeys, "4yR8swnG4CjPRbqXmk6TuRRu2Ww=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        _index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.usePage,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        _store_js__WEBPACK_IMPORTED_MODULE_22__.usePersonReplace,
        _store_js__WEBPACK_IMPORTED_MODULE_22__.useSpeechSpeed,
        _store_js__WEBPACK_IMPORTED_MODULE_22__.useGetVoice,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_21__.useHotkeys,
        _edit_js__WEBPACK_IMPORTED_MODULE_26__.useBookEditDialog,
        react_router_dom__WEBPACK_IMPORTED_MODULE_29__.useNavigate
    ];
});
function BookButtons(param) {
    let { book, reload } = param;
    _s3();
    const { openBookEdit } = (0,_edit_js__WEBPACK_IMPORTED_MODULE_26__.useBookEditDialog)(reload);
    const exportBook = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        window.open(`${_core_api_books_download_js__WEBPACK_IMPORTED_MODULE_4__.booksDownloadRouter.fullRoutePath}?uuid=${book.uuid}`, '_blank');
    }, [
        book.uuid
    ]);
    const removeBooks = useRemoveBooks(reload);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_30__["default"], {
        trigger: [
            'click'
        ],
        menu: {
            items: [
                {
                    key: 'edit',
                    label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('edit'),
                    onClick: ()=>openBookEdit(book.uuid)
                },
                {
                    key: 'archive',
                    label: book.isArchived ? (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('unarchive') : (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('archive'),
                    onClick: ()=>{
                        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                            await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__.booksUpdateRouter.action({
                                uuid: book.uuid,
                                update: {
                                    isArchived: !book.isArchived
                                }
                            });
                            reload();
                        });
                    }
                },
                {
                    key: 'export',
                    label: `${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('export')} Epub`,
                    onClick: ()=>exportBook()
                },
                {
                    key: 'remove',
                    label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('remove'),
                    onClick: ()=>removeBooks([
                            book
                        ])
                }
            ]
        },
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_31__["default"], {
            shape: "circle",
            type: "text",
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__.faEllipsisVertical
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 517,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
            lineNumber: 516,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
        lineNumber: 479,
        columnNumber: 5
    }, this);
}
_s3(BookButtons, "b+xFgZ6YlEjIcexjvUUui4aK3NQ=", false, function() {
    return [
        _edit_js__WEBPACK_IMPORTED_MODULE_26__.useBookEditDialog,
        useRemoveBooks
    ];
});
_c = BookButtons;
function BookRow(param) {
    let { index, activated, book, books, onHoverMove, onDrop, onCancel, selectedUuids, selectTo, reload, hasOrder } = param;
    _s4();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_29__.useNavigate)();
    const [, setActivatedIndex] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.activatedIndexAtom);
    const refEl = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const [, drop] = (0,react_dnd__WEBPACK_IMPORTED_MODULE_33__.useDrop)({
        accept: DragType,
        hover (item) {
            const dragIndex = books.findIndex((book)=>book.uuid === item.uuid);
            if (dragIndex === -1) return;
            const hoverIndex = index;
            if (dragIndex === hoverIndex) {
                return;
            }
            onHoverMove(dragIndex, hoverIndex);
            item.hoverIndex = hoverIndex;
        },
        drop (item) {
            onDrop(item);
        }
    });
    const [{ isDragging }, drag] = (0,react_dnd__WEBPACK_IMPORTED_MODULE_34__.useDrag)({
        type: DragType,
        item: ()=>{
            return {
                name: book.name,
                uuid: book.uuid,
                startIndex: index,
                hoverIndex: index
            };
        },
        collect: (monitor)=>({
                isDragging: monitor.isDragging()
            }),
        end (_item, monitor) {
            if (!monitor.didDrop()) onCancel();
        }
    });
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        var _refEl_current;
        if (activated) (_refEl_current = refEl.current) === null || _refEl_current === void 0 ? void 0 : _refEl_current.scrollIntoView({
            block: 'center'
        });
    }, [
        activated,
        drop
    ]);
    const [coverLoaded, setCoverLoaded] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const coverUrl = `${(0,_core_api_books_cover_js__WEBPACK_IMPORTED_MODULE_3__.getBooksCoverPath)(book.uuid)}`;
    const opacity = isDragging ? 0.2 : 1;
    if (!hasOrder) drop(refEl);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("tr", {
        ref: refEl,
        style: {
            opacity,
            background: activated ? 'var(--main-bg-active)' : 'var(--main-bg)'
        },
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                ref: drag,
                style: {
                    cursor: 'move'
                },
                children: !hasOrder && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
                    size: "lg",
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__.faGripVertical,
                    style: {
                        marginLeft: 4
                    }
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 620,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 613,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_35__["default"], {
                    checked: selectedUuids.includes(book.uuid),
                    onClick: (event)=>{
                        selectTo(index, event.shiftKey);
                    }
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 624,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 623,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                align: "center",
                style: {
                    cursor: 'pointer'
                },
                children: book.isFavorited ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__.faStar,
                    onClick: ()=>{
                        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                            await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__.booksUpdateRouter.action({
                                uuid: book.uuid,
                                update: {
                                    isFavorited: false
                                }
                            });
                            reload();
                        });
                    }
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 633,
                    columnNumber: 11
                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
                    icon: _fortawesome_free_regular_svg_icons__WEBPACK_IMPORTED_MODULE_36__.faStar,
                    onClick: ()=>{
                        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                            await _core_api_books_update_js__WEBPACK_IMPORTED_MODULE_9__.booksUpdateRouter.action({
                                uuid: book.uuid,
                                update: {
                                    isFavorited: true
                                }
                            });
                            reload();
                        });
                    }
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 648,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 631,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: "cell-center",
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("img", {
                        onClick: ()=>{
                            _store_global_js__WEBPACK_IMPORTED_MODULE_23__.globalStore.set(_common_preview_image_js__WEBPACK_IMPORTED_MODULE_16__.previewImgSrcAtom, coverUrl);
                        },
                        onLoad: ()=>{
                            setCoverLoaded(true);
                        },
                        style: {
                            visibility: coverLoaded ? 'visible' : 'hidden',
                            cursor: 'pointer'
                        },
                        src: coverUrl,
                        alt: `${book.name} ${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('cover')}`
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                        lineNumber: 666,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 665,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 664,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                className: _index_module_scss__WEBPACK_IMPORTED_MODULE_27__["default"].hover,
                title: book.createdAt.toLocaleString(),
                onClick: ()=>{
                    setActivatedIndex(index);
                    nav(viewPath(book.uuid));
                },
                children: book.name
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 682,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("td", {
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookButtons, {
                    book: book,
                    reload: reload
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 693,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                lineNumber: 692,
                columnNumber: 7
            }, this)
        ]
    }, book.uuid, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
        lineNumber: 605,
        columnNumber: 5
    }, this);
}
_s4(BookRow, "z52j9836FS8mm7Gu1upXxIcOsWg=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_29__.useNavigate,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        react_dnd__WEBPACK_IMPORTED_MODULE_33__.useDrop,
        react_dnd__WEBPACK_IMPORTED_MODULE_34__.useDrag
    ];
});
_c1 = BookRow;
function BookRemoveButton(param) {
    let { onRemove } = param;
    _s5();
    const [{ canDrop, isOver }, drop] = (0,react_dnd__WEBPACK_IMPORTED_MODULE_33__.useDrop)({
        accept: DragType,
        drop (item) {
            onRemove(item.uuid);
        },
        collect: (monitor)=>({
                isOver: monitor.isOver(),
                canDrop: monitor.canDrop()
            })
    });
    if (!canDrop) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {}, void 0, false);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_37__["default"], {
        ref: drop,
        color: isOver ? 'error' : 'warning',
        icon: isOver ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
            icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__.faTrash
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
            lineNumber: 717,
            columnNumber: 22
        }, void 0) : null,
        children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.dropHereToRemove')
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
        lineNumber: 714,
        columnNumber: 5
    }, this);
}
_s5(BookRemoveButton, "F504N0wuFSbvI1XEbEwXUidFCiM=", false, function() {
    return [
        react_dnd__WEBPACK_IMPORTED_MODULE_33__.useDrop
    ];
});
_c2 = BookRemoveButton;
function BookList() {
    _s6();
    const [page, setPage] = (0,_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.usePage)();
    const [perPage, setPerPage] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.perPageAtom);
    const [activatedIndex, setActivatedIndex] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.activatedIndexAtom);
    const [archived, setArchived] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.archivedAtom);
    const [favorited, setFavorited] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.favoritedAtom);
    const [search, setSearch] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.searchAtom);
    const searchDeferred = (0,_hooks_use_synced_debounce_js__WEBPACK_IMPORTED_MODULE_20__.useSyncedDebounced)(search, 500);
    const refSearchInput = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const [order, setOrder] = (0,jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom)(_index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.orderAtom);
    const hasOrder = order !== 'default';
    const { data: dataBooks, reload } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_11__.useAction)(_core_api_books_page_js__WEBPACK_IMPORTED_MODULE_7__.booksPageRouter, {
        filter: {
            archive: archived ? 'archived' : 'active',
            favorite: favorited ? 'favorited' : 'all',
            search: searchDeferred,
            order
        },
        page: {
            page,
            perPage
        }
    }, {
        clearWhenReload: false
    });
    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [books, setBooks] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);
    const resetBooks = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        setBooks(dataBooks ? [
            ...dataBooks.items
        ] : null);
    }, [
        dataBooks
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        resetBooks();
    }, [
        resetBooks
    ]);
    const { selectedBooks, allSelected, selectedUuids, selectTo, selectAll } = useSelector(books);
    const focusSearchInput = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        if (refSearchInput.current) {
            refSearchInput.current.focus();
        }
    }, []);
    const orderSelectPrev = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        const i = _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders.indexOf(order);
        const prevOrder = _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders[i - 1];
        if (prevOrder) setOrder(prevOrder);
        else {
            const lastOrder = _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders[_core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders.length - 1];
            if (lastOrder) setOrder(lastOrder);
        }
    }, [
        order,
        setOrder
    ]);
    const orderSelectNext = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        const i = _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders.indexOf(order);
        const nextOrder = _core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders[i + 1];
        if (nextOrder) setOrder(nextOrder);
        else setOrder(_core_book_enums_js__WEBPACK_IMPORTED_MODULE_10__.sortOrders["0"]);
    }, [
        order,
        setOrder
    ]);
    const removeBooks = useRemoveBooks(reload);
    const moveBooksTop = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(async (books)=>{
        for (const book of [
            ...books.reverse()
        ]){
            await _core_api_books_move_top_js__WEBPACK_IMPORTED_MODULE_6__.booksMoveTopRouter.action({
                uuid: book.uuid
            });
        }
        setPage(1);
        reload();
    }, [
        reload,
        setPage
    ]);
    useHomeHotKeys({
        focusSearchInput,
        orderSelectPrev,
        orderSelectNext,
        dataBooks,
        reload,
        selectTo,
        selectAll,
        selectedBooks,
        moveBooksTop,
        removeBooks,
        hasOrder
    });
    const onHoverMove = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((dragIndex, hoverIndex)=>{
        if (!books) return;
        const newBooks = [
            ...books
        ];
        const [entityJson] = newBooks.splice(dragIndex, 1);
        if (entityJson) newBooks.splice(hoverIndex, 0, entityJson);
        setBooks(newBooks);
    }, [
        books
    ]);
    const onDrop = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((item)=>{
        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
            if (!dataBooks) return;
            setLoading(true);
            await moveOffset(dataBooks.items, item.startIndex, item.hoverIndex - item.startIndex);
            reload();
            setLoading(false);
        });
    }, [
        dataBooks,
        reload
    ]);
    const onCancel = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        resetBooks();
    }, [
        resetBooks
    ]);
    const onRemove = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((uuid)=>{
        resetBooks();
        const book = books === null || books === void 0 ? void 0 : books.find((book)=>book.uuid === uuid);
        if (!book) return;
        removeBooks([
            book
        ]);
    }, [
        books,
        removeBooks,
        resetBooks
    ]);
    const OperationBtnGroup = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return !!selectedUuids.length && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_31__["default"].Group, {
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_31__["default"], {
                    type: "primary",
                    size: "small",
                    onClick: ()=>{
                        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_13__.async)(async ()=>{
                            await moveBooksTop(selectedBooks);
                            reload();
                        });
                    },
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('top')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 864,
                    columnNumber: 11
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_31__["default"], {
                    type: "primary",
                    size: "small",
                    danger: true,
                    onClick: ()=>{
                        removeBooks(selectedBooks);
                    },
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('remove')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 876,
                    columnNumber: 11
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
            lineNumber: 863,
            columnNumber: 9
        }, this);
    }, [
        moveBooksTop,
        reload,
        removeBooks,
        selectedBooks,
        selectedUuids.length
    ]);
    const TopRightBar = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookRemoveButton, {
                    onRemove: onRemove
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 894,
                    columnNumber: 9
                }, this),
                OperationBtnGroup
            ]
        }, void 0, true);
    }, [
        OperationBtnGroup,
        onRemove
    ]);
    const AddBtn = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_link_wrap_js__WEBPACK_IMPORTED_MODULE_18__.LinkWrap, {
            to: "/books/add",
            children: (href)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_31__["default"], {
                    type: "text",
                    shape: "circle",
                    href: href,
                    title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('add'),
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_17__.Icon, {
                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_32__.faAdd
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                        lineNumber: 905,
                        columnNumber: 13
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 904,
                    columnNumber: 11
                }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
            lineNumber: 902,
            columnNumber: 7
        }, this), []);
    (0,_layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_24__.useAppBarSync)({
        topRight: TopRightBar,
        bottomRight: AddBtn
    });
    // reset page & activatedIndex
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!books) return;
        if (books.length <= 0) {
            if (page > 1) setPage(1);
        } else if (activatedIndex > books.length - 1) {
            setActivatedIndex(books.length - 1);
        }
    }, [
        activatedIndex,
        books,
        page,
        setActivatedIndex,
        setPage
    ]);
    if (loading || !dataBooks || !books) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_19__.SpinCenter, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
        lineNumber: 928,
        columnNumber: 47
    }, this);
    const Pager = dataBooks.pageCount > 1 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_38__["default"], {
        onChange: (page)=>setPage(page),
        pageSize: perPage,
        onShowSizeChange: (_, size)=>setPerPage(size),
        current: page,
        total: dataBooks.count
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
        lineNumber: 932,
        columnNumber: 7
    }, this) : null;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_39__["default"], {
            direction: "vertical",
            style: {
                width: '100%'
            },
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_40__["default"], {
                    layout: "inline",
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_40__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('archive'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_41__["default"], {
                                checked: archived,
                                onChange: (v)=>setArchived(v)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                lineNumber: 946,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 945,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_40__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('favorite'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_41__["default"], {
                                checked: favorited,
                                onChange: (v)=>setFavorited(v)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                lineNumber: 949,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 948,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_40__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('search'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_42__["default"], {
                                value: search,
                                placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('search'),
                                onChange: (e)=>setSearch(e.target.value),
                                ref: refSearchInput,
                                onKeyDown: (e)=>{
                                    var _refSearchInput_current;
                                    if (e.key === 'Escape') (_refSearchInput_current = refSearchInput.current) === null || _refSearchInput_current === void 0 ? void 0 : _refSearchInput_current.blur();
                                }
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                lineNumber: 952,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 951,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_40__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('sortOrder.label'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_43__["default"], {
                                showSearch: true,
                                filterOption: _core_util_antd_js__WEBPACK_IMPORTED_MODULE_12__.filterOptionLabel,
                                popupMatchSelectWidth: false,
                                value: order,
                                onChange: (v)=>setOrder(v),
                                options: [
                                    {
                                        label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('sortOrder.item.default'),
                                        value: 'default'
                                    },
                                    {
                                        label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('sortOrder.item.reverse'),
                                        value: 'reverse'
                                    },
                                    {
                                        label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('sortOrder.item.name'),
                                        value: 'name'
                                    },
                                    {
                                        label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('sortOrder.item.nameReverse'),
                                        value: 'name-reverse'
                                    }
                                ]
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                lineNumber: 963,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 962,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 944,
                    columnNumber: 9
                }, this),
                books.length <= 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_44__["default"], {
                    type: "warning",
                    message: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.noBooks')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                    lineNumber: 991,
                    columnNumber: 11
                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                    children: [
                        Pager,
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("table", {
                            className: _index_module_scss__WEBPACK_IMPORTED_MODULE_27__["default"].table,
                            children: [
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("thead", {
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("tr", {
                                        children: [
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {}, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 998,
                                                columnNumber: 19
                                            }, this),
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {
                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_35__["default"], {
                                                    title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('all'),
                                                    checked: allSelected,
                                                    onClick: ()=>{
                                                        selectAll();
                                                    }
                                                }, void 0, false, {
                                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                    lineNumber: 1000,
                                                    columnNumber: 21
                                                }, this)
                                            }, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 999,
                                                columnNumber: 19
                                            }, this),
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {
                                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('favorite')
                                            }, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 1008,
                                                columnNumber: 19
                                            }, this),
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {
                                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('cover')
                                            }, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 1009,
                                                columnNumber: 19
                                            }, this),
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {
                                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName')
                                            }, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 1010,
                                                columnNumber: 19
                                            }, this),
                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("th", {}, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                                lineNumber: 1011,
                                                columnNumber: 19
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                        lineNumber: 997,
                                        columnNumber: 17
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                    lineNumber: 996,
                                    columnNumber: 15
                                }, this),
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("tbody", {
                                    children: books.map((book, index)=>{
                                        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookRow, {
                                            book: book,
                                            books: books,
                                            index: index,
                                            activated: activatedIndex === index,
                                            onHoverMove: onHoverMove,
                                            onDrop: onDrop,
                                            onCancel: onCancel,
                                            selectTo: selectTo,
                                            selectedUuids: selectedUuids,
                                            reload: reload,
                                            hasOrder: hasOrder
                                        }, book.uuid, false, {
                                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                            lineNumber: 1017,
                                            columnNumber: 21
                                        }, this);
                                    })
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                                    lineNumber: 1014,
                                    columnNumber: 15
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
                            lineNumber: 995,
                            columnNumber: 13
                        }, this),
                        Pager
                    ]
                }, void 0, true)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/index.tsx",
            lineNumber: 943,
            columnNumber: 7
        }, this)
    }, void 0, false);
}
_s6(BookList, "MaRBlvGGylgQr4RbkDKFTC1ck/g=", false, function() {
    return [
        _index_atoms_js__WEBPACK_IMPORTED_MODULE_25__.usePage,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        _hooks_use_synced_debounce_js__WEBPACK_IMPORTED_MODULE_20__.useSyncedDebounced,
        jotai__WEBPACK_IMPORTED_MODULE_28__.useAtom,
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_11__.useAction,
        useSelector,
        useRemoveBooks,
        useHomeHotKeys,
        _layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_24__.useAppBarSync
    ];
});
_c3 = BookList;
var _c, _c1, _c2, _c3;
$RefreshReg$(_c, "BookButtons");
$RefreshReg$(_c1, "BookRow");
$RefreshReg$(_c2, "BookRemoveButton");
$RefreshReg$(_c3, "BookList");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view.context.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  bookContextAtom: function() { return bookContextAtom; },
  useBookContext: function() { return useBookContext; }
});
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

const bookContextAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_0__.atom)(null);
const useBookContext = ()=>{
    const [bookContext] = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.useAtom)(bookContextAtom);
    if (!bookContext) throw new Error('BookContext must be used within a BookProvider');
    return bookContext;
};

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookView: function() { return BookView; },
  useBookView: function() { return useBookView; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_position_sync_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/api/books/position-sync.ts");
/* harmony import */var _core_api_books_position_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/position.ts");
/* harmony import */var _core_api_books_view_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/view.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _core_route_use_fetch_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/route/use-fetch.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/components/spin.tsx");
/* harmony import */var _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/hooks/use-title.tsx");
/* harmony import */var _not_found_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/not-found.tsx");
/* harmony import */var _view_context_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/web/pages/books/view.context.ts");
/* harmony import */var _view_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/web/pages/books/view.module.scss?b37e");
/* harmony import */var _view_viewer_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/web/pages/books/view/viewer.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$();















const useBookView = (uuid)=>{
    _s();
    const { data: bookData, error, reload: reloadBook } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction)(_core_api_books_view_js__WEBPACK_IMPORTED_MODULE_4__.booksViewRouter, {
        uuid
    });
    const { data: posData, error: posError, reload: reloadPos } = (0,_core_route_use_fetch_js__WEBPACK_IMPORTED_MODULE_6__.useFetch)([
        bookData
    ], async (bookData)=>{
        if (!bookData) return;
        return _core_api_books_position_js__WEBPACK_IMPORTED_MODULE_3__.booksPositionRouter.action({
            uuid: bookData.item.uuid
        });
    });
    const [pos, setPos] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();
    const section = pos === null || pos === void 0 ? void 0 : pos.section;
    const paragraph = pos === null || pos === void 0 ? void 0 : pos.paragraph;
    // flatten navs
    const book = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{
        if (!bookData) return undefined;
        const flattenedNavs = [];
        const stack = [
            ...bookData.navs
        ];
        while(stack.length){
            const cur = stack.shift();
            flattenedNavs.push(cur);
            stack.unshift(...cur.children);
        }
        return {
            ...bookData,
            flattenedNavs
        };
    }, [
        bookData
    ]);
    // get pos
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        if (posData) setPos(posData);
    }, [
        posData
    ]);
    // sync pos
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        if (book === undefined || section === undefined || paragraph === undefined) return;
        _core_api_books_position_sync_js__WEBPACK_IMPORTED_MODULE_2__.booksPositionSyncRouter.action({
            uuid: book.item.uuid,
            pos: {
                section,
                paragraph
            }
        }).catch(console.error);
    }, [
        book,
        paragraph,
        section
    ]);
    const reload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>{
        reloadBook();
        reloadPos();
    }, [
        reloadBook,
        reloadPos
    ]);
    return {
        error: error || posError,
        pos,
        setPos,
        book,
        reload
    };
};
_s(useBookView, "Pwu9Ew4Ik3bblLemdpnUxCjP/VE=", false, function() {
    return [
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction,
        _core_route_use_fetch_js__WEBPACK_IMPORTED_MODULE_6__.useFetch
    ];
});
function BookViewContent() {
    _s1();
    const { book } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_11__.useBookContext)();
    const { BookPanelView, MainContent, activeNavs } = (0,_view_viewer_js__WEBPACK_IMPORTED_MODULE_13__.useViewer)();
    const pushTitle = (0,_hooks_use_title_js__WEBPACK_IMPORTED_MODULE_9__.usePushTitle)();
    const lastNav = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>activeNavs === null || activeNavs === void 0 ? void 0 : activeNavs.at(-1), [
        activeNavs
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        let mainTitle = `${book.item.name}`;
        if (lastNav) mainTitle = `${lastNav.label} - ${mainTitle}`;
        pushTitle(mainTitle);
    }, [
        book,
        lastNav,
        pushTitle
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_7__.FlexBox, {
        dir: "row",
        className: _view_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].contentWrapper,
        children: [
            BookPanelView,
            MainContent
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 98,
        columnNumber: 5
    }, this);
}
_s1(BookViewContent, "daO5aw3bIGQAUSbl0KOWfUDVue0=", false, function() {
    return [
        _view_context_js__WEBPACK_IMPORTED_MODULE_11__.useBookContext,
        _view_viewer_js__WEBPACK_IMPORTED_MODULE_13__.useViewer,
        _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_9__.usePushTitle
    ];
});
_c = BookViewContent;
function BookViewReq(param) {
    let { uuid } = param;
    _s2();
    const { error, pos, setPos, book, reload } = useBookView(uuid);
    const [bookContext, setBookContext] = (0,jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom)(_view_context_js__WEBPACK_IMPORTED_MODULE_11__.bookContextAtom);
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        if (book && pos) setBookContext({
            uuid: book.item.uuid,
            book,
            pos,
            setPos,
            reload
        });
        else setBookContext(null);
    }, [
        book,
        pos,
        reload,
        setBookContext,
        setPos
    ]);
    if (error) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_not_found_js__WEBPACK_IMPORTED_MODULE_10__.NotFound, {
        title: "book"
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 121,
        columnNumber: 21
    }, this);
    if (!book || !pos) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_8__.SpinCenter, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 123,
        columnNumber: 29
    }, this);
    if (!bookContext) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_8__.SpinCenter, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 125,
        columnNumber: 28
    }, this);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookViewContent, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 127,
        columnNumber: 10
    }, this);
}
_s2(BookViewReq, "xNg3bOSzdDoTD6JvC2Ure0dZL3I=", false, function() {
    return [
        useBookView,
        jotai__WEBPACK_IMPORTED_MODULE_14__.useAtom
    ];
});
_c1 = BookViewReq;
function BookView() {
    _s3();
    const { uuid } = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_15__.useParams)();
    if (!uuid) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_not_found_js__WEBPACK_IMPORTED_MODULE_10__.NotFound, {
        title: "book"
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 133,
        columnNumber: 21
    }, this);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookViewReq, {
        uuid: uuid
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view.tsx",
        lineNumber: 135,
        columnNumber: 10
    }, this);
}
_s3(BookView, "/IiROcFL4bMr8gYCJlTjGGhD3KY=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_15__.useParams
    ];
});
_c2 = BookView;
var _c, _c1, _c2;
$RefreshReg$(_c, "BookViewContent");
$RefreshReg$(_c1, "BookViewReq");
$RefreshReg$(_c2, "BookView");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/book-search.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BookSearchButton: function() { return BookSearchButton; },
  useBookSearch: function() { return useBookSearch; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var _fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+react-fontawesome@0.2.2_@fortawesome+fontawesome-svg-core@6.6.0_react@18.3.1/node_modules/@fortawesome/react-fontawesome/index.es.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useMountEffect/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/alert/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/drawer/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */var _core_api_books_search_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/search.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/hooks/use-escape.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _view_context_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/books/view.context.ts");
/* harmony import */var _book_search_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/books/view/book-search.module.scss?2c98");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$();














const openAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_11__.atom)(false);
const searchTriggerRef = {};
function useBookSearch() {
    _s();
    const bookSearch = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(async (search)=>{
        var _searchTriggerRef_callback;
        void ((_searchTriggerRef_callback = searchTriggerRef.callback) === null || _searchTriggerRef_callback === void 0 ? void 0 : _searchTriggerRef_callback.call(searchTriggerRef, search));
    }, []);
    return bookSearch;
}
_s(useBookSearch, "EY1WMwBVj7tONtmH2YM8/pH5SoU=");
function BookSearchResult(param) {
    let { open, player, searchResponse } = param;
    _s1();
    const [selectedIndex, setSelectedIndex] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(0);
    const refSearchResult = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);
    const gotoMatch = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(async (match)=>{
        await player.gotoPos({
            section: match.section,
            paragraph: match.paragraph
        });
    }, [
        player
    ]);
    // scroll to selected
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        if (selectedIndex < 0) return;
        const resultDiv = refSearchResult.current;
        if (!resultDiv) return;
        const selectedDiv = resultDiv.querySelector('li.text.selected');
        selectedDiv === null || selectedDiv === void 0 ? void 0 : selectedDiv.scrollIntoView({
            block: 'center'
        });
    }, [
        selectedIndex
    ]);
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys)();
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        if (!open || !searchResponse) return;
        const matches = searchResponse.matches;
        const prevSearch = ()=>{
            setSelectedIndex((idx)=>idx <= 0 ? 0 : idx - 1);
        };
        const nextSearch = ()=>{
            setSelectedIndex((idx)=>idx >= matches.length - 1 ? matches.length - 1 : idx + 1);
        };
        const gotoSearch = async ()=>{
            const match = matches.at(selectedIndex);
            if (match) await gotoMatch(match);
        };
        return addHotkeys([
            [
                'p',
                (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('hotkey.prevSearchResult'),
                prevSearch
            ],
            [
                'n',
                (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('hotkey.nextSearchResult'),
                nextSearch
            ],
            [
                'enter',
                (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('hotkey.gotoSearchResult'),
                gotoSearch
            ]
        ], {
            level: 2
        });
    }, [
        addHotkeys,
        gotoMatch,
        open,
        searchResponse,
        selectedIndex
    ]);
    if (!searchResponse) return null;
    if (searchResponse.matches.length === 0) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
        type: "warning",
        message: (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('prompt.noSearchMatches')
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
        lineNumber: 100,
        columnNumber: 12
    }, this);
    const searchLength = searchResponse.search.length;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        className: _book_search_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].bookSearchResult,
        ref: refSearchResult,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
                children: searchResponse.matches.map((match, i)=>{
                    const isSelected = i === selectedIndex;
                    const textCls = [
                        'text',
                        'clickable'
                    ];
                    if (isSelected) textCls.push('selected');
                    const firstText = match.text.slice(0, match.start);
                    const lastText = match.text.slice(match.start + searchLength);
                    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
                        className: textCls.join(' '),
                        onClick: ()=>{
                            void gotoMatch(match);
                            setSelectedIndex(i);
                        },
                        children: [
                            match.nav && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("strong", {
                                children: match.nav
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                                lineNumber: 120,
                                columnNumber: 29
                            }, this),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                children: [
                                    firstText,
                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                                        className: "highlight",
                                        children: searchResponse.search
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                                        lineNumber: 123,
                                        columnNumber: 17
                                    }, this),
                                    lastText
                                ]
                            }, void 0, true, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                                lineNumber: 121,
                                columnNumber: 15
                            }, this)
                        ]
                    }, i, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                        lineNumber: 112,
                        columnNumber: 13
                    }, this);
                })
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 104,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                className: "stats",
                children: [
                    selectedIndex + 1,
                    " / ",
                    searchResponse.matches.length
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 130,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
        lineNumber: 103,
        columnNumber: 5
    }, this);
}
_s1(BookSearchResult, "CZmt8mfmy2vfe1VIcAucDUv7E/k=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys
    ];
});
_c = BookSearchResult;
function BookSearchView(param) {
    let { refSearchInput, player } = param;
    _s2();
    const [open, setOpen] = (0,jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom)(openAtom);
    const { uuid } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_9__.useBookContext)();
    const [search, setSearch] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)('');
    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
    const [searchResponse, setSearchResponse] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);
    const bookSearch = useBookSearch();
    searchTriggerRef.callback = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(async (newSearch)=>{
        var _refSearchInput_current;
        setOpen(true);
        setSearch(newSearch);
        if (loading) return;
        setSearchResponse(null);
        setLoading(true);
        const res = await _core_api_books_search_js__WEBPACK_IMPORTED_MODULE_4__.booksSearchRouter.action({
            uuid,
            search: newSearch
        });
        setSearchResponse(res);
        setLoading(false);
        (_refSearchInput_current = refSearchInput.current) === null || _refSearchInput_current === void 0 ? void 0 : _refSearchInput_current.blur();
    }, [
        loading,
        refSearchInput,
        setOpen,
        uuid
    ]);
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_14__.useMountEffect)(()=>{
        setTimeout(()=>{
            if (refSearchInput.current) {
                refSearchInput.current.focus();
            }
        }, 100);
    });
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_6__.FlexBox, {
        style: {
            width: '100%',
            height: '100%'
        },
        gap: 8,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_6__.FlexBox, {
                dir: "row",
                gap: 8,
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_15__["default"], {
                        className: "flex-1",
                        ref: refSearchInput,
                        value: search,
                        onChange: (e)=>setSearch(e.target.value),
                        onKeyDown: (e)=>{
                            if (e.key === 'Escape') {
                                var _refSearchInput_current;
                                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_5__.eventBan)(e);
                                (_refSearchInput_current = refSearchInput.current) === null || _refSearchInput_current === void 0 ? void 0 : _refSearchInput_current.blur();
                            } else if (e.key === 'Enter') {
                                void bookSearch(search);
                            }
                        }
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                        lineNumber: 178,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_16__["default"], {
                        onClick: ()=>{
                            void bookSearch(search);
                        },
                        loading: loading,
                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.FontAwesomeIcon, {
                            icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_17__.faSearch
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                            lineNumber: 198,
                            columnNumber: 11
                        }, this)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                        lineNumber: 192,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 177,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookSearchResult, {
                open: open,
                player: player,
                searchResponse: searchResponse
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 201,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
        lineNumber: 176,
        columnNumber: 5
    }, this);
}
_s2(BookSearchView, "Fd5chPD4ohsFgR8+QKpegL0KXb4=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom,
        _view_context_js__WEBPACK_IMPORTED_MODULE_9__.useBookContext,
        useBookSearch,
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_14__.useMountEffect
    ];
});
_c1 = BookSearchView;
function BookSearchButton(param) {
    let { player } = param;
    _s3();
    const [open, setOpen] = (0,jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom)(openAtom);
    const refSearchInput = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);
    const openSearch = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(()=>{
        setOpen(true);
        setTimeout(()=>{
            var _refSearchInput_current;
            (_refSearchInput_current = refSearchInput.current) === null || _refSearchInput_current === void 0 ? void 0 : _refSearchInput_current.focus();
        }, 100);
    }, [
        setOpen
    ]);
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys)();
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        return addHotkeys([
            [
                '/',
                (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('search'),
                openSearch
            ]
        ], {
            level: 2
        });
    }, [
        addHotkeys,
        openSearch
    ]);
    (0,_hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__.useKeyEscape)(()=>{
        setOpen(false);
    }, {
        enable: open
    });
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_16__["default"], {
                block: true,
                type: "primary",
                icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.FontAwesomeIcon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_17__.faSearch
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                    lineNumber: 239,
                    columnNumber: 15
                }, void 0),
                onClick: ()=>{
                    openSearch();
                },
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('search')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 236,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_18__["default"], {
                forceRender: true,
                title: (0,i18next__WEBPACK_IMPORTED_MODULE_2__.t)('search'),
                open: open,
                onClose: ()=>setOpen(false),
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookSearchView, {
                    refSearchInput: refSearchInput,
                    player: player
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                    lineNumber: 252,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/book-search.tsx",
                lineNumber: 246,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true);
}
_s3(BookSearchButton, "vupN5ePKoeBhJUIO2mKs5kXBuqQ=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys,
        _hooks_use_escape_js__WEBPACK_IMPORTED_MODULE_7__.useKeyEscape
    ];
});
_c2 = BookSearchButton;
var _c, _c1, _c2;
$RefreshReg$(_c, "BookSearchResult");
$RefreshReg$(_c1, "BookSearchView");
$RefreshReg$(_c2, "BookSearchButton");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/highlight/annotation-highlight.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  AnnotationHighlight: function() { return AnnotationHighlight; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _highlight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/books/view/highlight/highlight.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



class AnnotationHighlight extends _highlight_js__WEBPACK_IMPORTED_MODULE_1__.BaseHighlight {
    constructor(...args){
        super(...args), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "rootClass", _core_consts_js__WEBPACK_IMPORTED_MODULE_0__.ROOT_ANNOTATION_HIGHLIGHT_CLASS), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "ignoreClass", null);
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/highlight/highlight.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  BaseHighlight: function() { return BaseHighlight; }
});
/* harmony import */var _swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_get.js");
/* harmony import */var _swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_init.js");
/* harmony import */var _swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_set.js");
/* harmony import */var _swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_method_get.js");
/* harmony import */var _swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_method_init.js");
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _core_util_collection_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/util/collection.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _core_util_timer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/timer.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");









var FindRangePosType;
var _hlRoot = /*#__PURE__*/ new WeakMap(), _cacheHlRectMap = /*#__PURE__*/ new WeakMap(), _highlightHide = /*#__PURE__*/ new WeakSet(), _highlightCharsByRects = /*#__PURE__*/ new WeakSet(), _scrollToRects = /*#__PURE__*/ new WeakMap(), _findRangePos = /*#__PURE__*/ new WeakSet(), _getChildAndIndex = /*#__PURE__*/ new WeakSet(), _highlightChars = /*#__PURE__*/ new WeakSet();
class BaseHighlight {
    get doc() {
        return this.iframeCtrl.doc;
    }
    reCreateRoot(doc) {
        doc.querySelectorAll(`.${this.rootClass}`).forEach((div)=>div.remove());
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__._)(this, _hlRoot, doc.createElement('div'));
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _hlRoot).classList.add(this.rootClass);
        doc.documentElement.appendChild((0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _hlRoot));
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _cacheHlRectMap).clear();
    }
    highlight(blocks, scrollTo) {
        this.iframeCtrl.tryManipulateDOM(()=>{
            (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _highlightChars, highlightChars).call(this, blocks, scrollTo);
        }).catch(console.error);
    }
    highlightHide() {
        this.iframeCtrl.tryManipulateDOM(()=>{
            (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _highlightHide, highlightHide).call(this);
        }).catch(console.error);
    }
    constructor(iframeCtrl, states){
        (0,_swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__._)(this, _highlightHide);
        (0,_swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__._)(this, _highlightCharsByRects);
        (0,_swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__._)(this, _findRangePos);
        (0,_swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__._)(this, _getChildAndIndex);
        (0,_swc_helpers_class_private_method_init__WEBPACK_IMPORTED_MODULE_6__._)(this, _highlightChars);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "iframeCtrl", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "states", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "highlightedElems", void 0);
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_8__._)(this, _hlRoot, {
            writable: true,
            value: void 0
        });
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_8__._)(this, _cacheHlRectMap, {
            writable: true,
            value: void 0
        });
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_8__._)(this, _scrollToRects, {
            writable: true,
            value: void 0
        });
        this.iframeCtrl = iframeCtrl;
        this.states = states;
        this.highlightedElems = [];
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__._)(this, _cacheHlRectMap, new Map());
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_3__._)(this, _scrollToRects, (0,_core_util_timer_js__WEBPACK_IMPORTED_MODULE_2__.throttleFn)(1000, (rects)=>{
            if (!this.doc) return;
            if (!rects.length) return;
            if (this.iframeCtrl.enabledPageList) {
                const left = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_0__.sum)(rects.map((r)=>r.left)) / rects.length;
                this.iframeCtrl.pageListScrollToLeft(left).catch(console.error);
            } else if (this.iframeCtrl.isVertical) {
                const right = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_0__.sum)(rects.map((r)=>r.right)) / rects.length;
                this.iframeCtrl.scrollToRight(right).catch(console.error);
            } else {
                const top = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_0__.sum)(rects.map((r)=>r.top)) / rects.length;
                this.iframeCtrl.scrollToTop(top).catch(console.error);
            }
        }));
    }
}
function highlightHide() {
    const hlRoot = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _hlRoot);
    if (!hlRoot) return;
    Array.from(hlRoot.children).forEach((div)=>{
        ;
        div.style.display = 'none';
    });
}
function highlightCharsByRects(ranges, scrollTo) {
    const doc = this.doc;
    const hlRoot = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _hlRoot);
    if (!doc || !hlRoot) return;
    const getRectDiv = (idx, color)=>{
        let div = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _cacheHlRectMap).get(idx);
        if (!div) {
            div = doc.createElement('div');
            if (color) div.style.backgroundColor = color;
            (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _cacheHlRectMap).set(idx, div);
            hlRoot.appendChild(div);
        }
        return div;
    };
    const containerRect = doc.documentElement.getBoundingClientRect();
    const rects = ranges.map((range)=>[
            ...range.range.getClientRects()
        ].map((rect)=>({
                width: rect.width,
                height: rect.height,
                left: rect.left - containerRect.left,
                right: rect.right - containerRect.right,
                top: rect.top - containerRect.top,
                bottom: rect.bottom - containerRect.top
            }))).flat();
    (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _highlightHide, highlightHide).call(this);
    for (const [idx, rect] of rects.entries()){
        const div = getRectDiv(idx, rect.color);
        div.style.display = 'block';
        div.style.top = `${rect.top}px`;
        div.style.left = `${rect.left}px`;
        div.style.width = `${rect.width}px`;
        div.style.height = `${rect.height}px`;
    }
    if (scrollTo) (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_4__._)(this, _scrollToRects).call(this, rects);
}
function findRangePos(node, index) {
    if (!node.childNodes.length) return {
        type: 1,
        remainIndex: index
    };
    let remainIndex = index;
    for (const child of node.childNodes){
        if ((0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_1__.isTextNode)(child)) {
            // text
            if (!child.textContent) continue;
            if (remainIndex <= child.textContent.length) {
                return {
                    type: 0,
                    node: child,
                    index: remainIndex
                };
            } else {
                remainIndex -= child.textContent.length;
            }
            continue;
        }
        if (this.ignoreClass && (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_1__.isElement)(child) && child.closest(`.${this.ignoreClass}`)) continue;
        // recursion
        const result = (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _findRangePos, findRangePos).call(this, child, remainIndex);
        switch(result.type){
            case 0:
                return result;
            case 1:
                remainIndex = result.remainIndex;
                continue;
        }
    }
    return {
        type: 1,
        remainIndex
    };
}
function getChildAndIndex(node, index) {
    const result = (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _findRangePos, findRangePos).call(this, node, index);
    if (result.type === 0) {
        return result;
    } else {
        return null;
    }
}
function highlightChars(blocks, scrollTo) {
    if (!this.doc) return;
    const ranges = [];
    for (const block of blocks){
        const { node, charIndex, charLength, color } = block;
        // get range
        const range = document.createRange();
        const start = (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _getChildAndIndex, getChildAndIndex).call(this, node.elem, charIndex);
        if (!start) continue;
        const end = (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _getChildAndIndex, getChildAndIndex).call(this, node.elem, charIndex + charLength);
        if (!end) continue;
        try {
            range.setStart(start.node, start.index);
            range.setEnd(end.node, end.index);
        } catch (error) {
            console.error(error);
            continue;
        }
        ranges.push({
            range,
            color
        });
    }
    (0,_swc_helpers_class_private_method_get__WEBPACK_IMPORTED_MODULE_5__._)(this, _highlightCharsByRects, highlightCharsByRects).call(this, ranges, scrollTo);
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/highlight/keyword-highlight.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  KeywordHighlight: function() { return KeywordHighlight; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _highlight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/books/view/highlight/highlight.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



class KeywordHighlight extends _highlight_js__WEBPACK_IMPORTED_MODULE_1__.BaseHighlight {
    constructor(...args){
        super(...args), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "rootClass", _core_consts_js__WEBPACK_IMPORTED_MODULE_0__.ROOT_KEYWORD_HIGHLIGHT_CLASS), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "ignoreClass", null);
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/highlight/utterer-highlight.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  UttererHighlight: function() { return UttererHighlight; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _highlight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/books/view/highlight/highlight.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



class UttererHighlight extends _highlight_js__WEBPACK_IMPORTED_MODULE_1__.BaseHighlight {
    constructor(...args){
        super(...args), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "rootClass", _core_consts_js__WEBPACK_IMPORTED_MODULE_0__.ROOT_UTTERER_HIGHLIGHT_CLASS), (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_2__._)(this, "ignoreClass", _core_consts_js__WEBPACK_IMPORTED_MODULE_0__.PARA_IGNORE_CLASS);
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/annotations-dialogs.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useAnnotationNoteDialog: function() { return useAnnotationNoteDialog; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_textarea_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/components/textarea.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






function useAnnotationNoteDialog(param) {
    let { player } = param;
    _s();
    const [editAnnotation, setEditAnnotation] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);
    const [note, setNote] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!editAnnotation) return;
        setNote(editAnnotation.note);
    }, [
        editAnnotation
    ]);
    const onOk = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        if (editAnnotation) void player.annotations.upsert({
            pos: editAnnotation.pos,
            range: editAnnotation.range,
            uuid: editAnnotation.uuid
        }, {
            color: editAnnotation.color,
            group: editAnnotation.group,
            note
        });
        setEditAnnotation(null);
    }, [
        editAnnotation,
        note,
        player.annotations
    ]);
    const onClose = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        setEditAnnotation(null);
    }, []);
    return {
        openNoteEdit: setEditAnnotation,
        NoteEditDialog: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
            open: !!editAnnotation,
            onCancel: onClose,
            footer: false,
            title: `${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('annotation')} ${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note')}`,
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"], {
                    children: editAnnotation === null || editAnnotation === void 0 ? void 0 : editAnnotation.brief
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                    lineNumber: 50,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("form", {
                    onSubmit: (e)=>{
                        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__.eventBan)(e);
                        void onOk();
                    },
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_4__.FlexBox, {
                                gap: 8,
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_textarea_js__WEBPACK_IMPORTED_MODULE_5__.Textarea, {
                                    autoFocus: true,
                                    value: note,
                                    onChange: (e)=>setNote(e.target.value)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                                    lineNumber: 59,
                                    columnNumber: 15
                                }, this)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                                lineNumber: 58,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                            lineNumber: 57,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
                                type: "primary",
                                htmlType: "submit",
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('update')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                                lineNumber: 67,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                            lineNumber: 66,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
                    lineNumber: 51,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations-dialogs.tsx",
            lineNumber: 44,
            columnNumber: 7
        }, this)
    };
}
_s(useAnnotationNoteDialog, "I/WomW7JcSxH4/TOdRtWY+JtN6Q=");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/annotations.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useBookViewAnnotations: function() { return useBookViewAnnotations; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/dropdown/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_api_books_annotations_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/annotations.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/browser.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _common_swipe_action_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/common/swipe-action.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _annotations_dialogs_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/books/view/panel/annotations-dialogs.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$();












function AnnotationItem(param) {
    let { annotation, openNoteEdit, isSelected, isActivated, player } = param;
    const textCls = [
        'text',
        'clickable'
    ];
    if (isActivated) textCls.push('active');
    if (isSelected) textCls.push('selected');
    const menuItems = [
        {
            key: 'note',
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_8__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faNoteSticky,
                size: "sm"
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                lineNumber: 44,
                columnNumber: 13
            }, this),
            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note'),
            onClick: ()=>{
                openNoteEdit(annotation, player);
            }
        },
        {
            key: 'remove',
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_8__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faTrash,
                size: "sm"
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                lineNumber: 52,
                columnNumber: 13
            }, this),
            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('remove'),
            onClick: ()=>{
                void player.annotations.remove(annotation);
            }
        }
    ];
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
        "data-pos-section": annotation.pos.section,
        "data-pos-paragraph": annotation.pos.paragraph,
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_swipe_action_js__WEBPACK_IMPORTED_MODULE_7__.SwipeAction, {
            left: {
                node: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_8__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faNoteSticky,
                    size: "sm"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                    lineNumber: 67,
                    columnNumber: 17
                }, void 0),
                width: 30,
                trigger: ()=>{
                    openNoteEdit(annotation, player);
                }
            },
            right: {
                node: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_8__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faTrash,
                    size: "sm"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                    lineNumber: 74,
                    columnNumber: 17
                }, void 0),
                width: 30,
                trigger: ()=>{
                    void player.annotations.remove(annotation);
                }
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
                menu: {
                    items: menuItems
                },
                trigger: [
                    'contextMenu'
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: "item",
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: textCls.join(' '),
                            style: {
                                fontSize: 13
                            },
                            onClick: (event)=>{
                                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_6__.eventBan)(event);
                                player.gotoSection(annotation.pos.section, annotation.pos.paragraph).catch(console.error);
                            },
                            children: [
                                annotation.brief,
                                annotation.range && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "range",
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                                        className: "selected-text",
                                        children: annotation.range.selectedText
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                        lineNumber: 101,
                                        columnNumber: 19
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                    lineNumber: 100,
                                    columnNumber: 17
                                }, this),
                                annotation.note && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "note",
                                    children: [
                                        "note: ",
                                        annotation.note
                                    ]
                                }, void 0, true, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                    lineNumber: 107,
                                    columnNumber: 17
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                            lineNumber: 88,
                            columnNumber: 13
                        }, this),
                        !_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: "btn",
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
                                menu: {
                                    items: menuItems
                                },
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_8__.Icon, {
                                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faEllipsisVertical,
                                        style: {
                                            paddingLeft: '8px',
                                            paddingRight: '8px'
                                        }
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                        lineNumber: 118,
                                        columnNumber: 21
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                    lineNumber: 117,
                                    columnNumber: 19
                                }, this)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                                lineNumber: 112,
                                columnNumber: 17
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                            lineNumber: 111,
                            columnNumber: 15
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                    lineNumber: 87,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                lineNumber: 81,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
            lineNumber: 65,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
        lineNumber: 61,
        columnNumber: 5
    }, this);
}
_c = AnnotationItem;
function Annotations(param) {
    let { annotations, activeAnnotationIndex, closestAnnotationIndex, player } = param;
    _s();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_9__.useHotkeys)();
    const [selectedIndex, setSelectedIndex] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(0);
    const refAnnotation = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const { openNoteEdit, NoteEditDialog } = (0,_annotations_dialogs_js__WEBPACK_IMPORTED_MODULE_10__.useAnnotationNoteDialog)({
        player
    });
    const selectedAnnotation = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return annotations === null || annotations === void 0 ? void 0 : annotations.at(selectedIndex);
    }, [
        annotations,
        selectedIndex
    ]);
    const removeSelectedAnnotation = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(async ()=>{
        if (selectedAnnotation) await player.annotations.remove(selectedAnnotation);
    }, [
        player.annotations,
        selectedAnnotation
    ]);
    // selected hotkeys
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const prevAnnotation = ()=>{
            setSelectedIndex((idx)=>idx <= 0 ? 0 : idx - 1);
        };
        const nextAnnotation = ()=>{
            annotations && setSelectedIndex((idx)=>idx >= annotations.length - 1 ? annotations.length - 1 : idx + 1);
        };
        const gotoAnnotation = ()=>{
            const selectedAnnotation = annotations === null || annotations === void 0 ? void 0 : annotations[selectedIndex];
            if (!selectedAnnotation) return;
            player.gotoSection(selectedAnnotation.pos.section, selectedAnnotation.pos.paragraph).catch(console.error);
        };
        const speakAnnotation = ()=>{
            if (!selectedAnnotation) return;
            player.utterer.speakText(selectedAnnotation.brief).catch(console.error);
        };
        return addHotkeys([
            [
                'p',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevAnnotation'),
                prevAnnotation
            ],
            [
                'n',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextAnnotation'),
                nextAnnotation
            ],
            [
                'enter',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.gotoAnnotation'),
                gotoAnnotation
            ],
            [
                [
                    'd',
                    'b'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.annotationRemoveSelected'),
                ()=>removeSelectedAnnotation()
            ],
            [
                [
                    'g',
                    'n'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.annotationNote'),
                ()=>openNoteEdit(selectedAnnotation ?? null)
            ],
            [
                {
                    shift: true,
                    key: 'K'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.speakAnnotation'),
                speakAnnotation
            ]
        ]);
    }, [
        addHotkeys,
        annotations,
        openNoteEdit,
        player,
        removeSelectedAnnotation,
        selectedAnnotation,
        selectedIndex
    ]);
    // change selected annotation
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (closestAnnotationIndex === null) return;
        setSelectedIndex(closestAnnotationIndex);
    }, [
        closestAnnotationIndex
    ]);
    // scroll to selected annotation
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!selectedAnnotation) return;
        const annotationDiv = refAnnotation.current;
        if (!annotationDiv) return;
        const selectedAnnotationDiv = annotationDiv.querySelector('div.text.selected');
        selectedAnnotationDiv === null || selectedAnnotationDiv === void 0 ? void 0 : selectedAnnotationDiv.scrollIntoView({
            block: 'center'
        });
    }, [
        selectedAnnotation
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        className: "panel-content book-annotations",
        ref: refAnnotation,
        children: [
            !(annotations === null || annotations === void 0 ? void 0 : annotations.length) ? (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.annotationsEmpty') : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
                children: annotations.map((annotation, idx)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AnnotationItem, {
                        annotation: annotation,
                        openNoteEdit: openNoteEdit,
                        isActivated: activeAnnotationIndex === idx,
                        isSelected: selectedIndex === idx,
                        player: player
                    }, idx, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                        lineNumber: 238,
                        columnNumber: 13
                    }, this))
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
                lineNumber: 236,
                columnNumber: 9
            }, this),
            NoteEditDialog
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
        lineNumber: 232,
        columnNumber: 5
    }, this);
}
_s(Annotations, "EJx5U1KKgYpft0fSThtO820KcQc=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_9__.useHotkeys,
        _annotations_dialogs_js__WEBPACK_IMPORTED_MODULE_10__.useAnnotationNoteDialog
    ];
});
_c1 = Annotations;
function useBookViewAnnotations(book, player, pos, selection) {
    _s1();
    const uuid = book.item.uuid;
    const { data: annotations, reload } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_4__.useAction)(_core_api_books_annotations_js__WEBPACK_IMPORTED_MODULE_3__.booksAnnotationsRouter, {
        uuid
    }, {
        clearWhenReload: false
    });
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        player.annotations.reload = reload;
        return ()=>{
            player.annotations.reload = undefined;
        };
    }, [
        player.annotations,
        reload
    ]);
    const activeAnnotationIndex = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return player.annotations.indexByPos(pos, selection ?? null);
    }, [
        player.annotations,
        pos,
        selection
    ]);
    const closestAnnotationIndex = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return player.annotations.closestIndexByPos(pos);
    }, [
        player.annotations,
        pos
    ]);
    const activeAnnotation = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>activeAnnotationIndex !== null ? annotations === null || annotations === void 0 ? void 0 : annotations.at(activeAnnotationIndex) : undefined, [
        annotations,
        activeAnnotationIndex
    ]);
    const closestAnnotation = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>closestAnnotationIndex !== null ? annotations === null || annotations === void 0 ? void 0 : annotations.at(closestAnnotationIndex) : undefined, [
        annotations,
        closestAnnotationIndex
    ]);
    return {
        annotations,
        AnnotationView: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Annotations, {
            annotations: annotations,
            closestAnnotationIndex: closestAnnotationIndex,
            activeAnnotationIndex: activeAnnotationIndex,
            player: player
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/annotations.tsx",
            lineNumber: 306,
            columnNumber: 7
        }, this),
        closestAnnotation
    };
}
_s1(useBookViewAnnotations, "xKEB2DFcC0X1ZQkEpyGhcorhbqQ=", false, function() {
    return [
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_4__.useAction
    ];
});
var _c, _c1;
$RefreshReg$(_c, "AnnotationItem");
$RefreshReg$(_c1, "Annotations");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/keywords-dialogs.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useKeywordDialog: function() { return useKeywordDialog; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_textarea_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/components/textarea.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






function useKeywordDialog(param) {
    let { player } = param;
    _s();
    const [editKeyword, setEditKeyword] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);
    const [alias, setAlias] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const [note, setNote] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        var _editKeyword_alias;
        if (!editKeyword) return;
        setAlias((_editKeyword_alias = editKeyword.alias) === null || _editKeyword_alias === void 0 ? void 0 : _editKeyword_alias.join('\n'));
        setNote(editKeyword.note);
    }, [
        editKeyword
    ]);
    const onOk = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        if (editKeyword) void player.keywords.upsert({
            pos: editKeyword.pos,
            uuid: editKeyword.uuid,
            keyword: editKeyword.keyword
        }, {
            color: editKeyword.color,
            note,
            alias: alias === null || alias === void 0 ? void 0 : alias.split('\n').map((a)=>a.trim()).filter((a)=>a)
        });
        setEditKeyword(null);
    }, [
        alias,
        editKeyword,
        note,
        player.keywords
    ]);
    const onClose = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(()=>{
        setEditKeyword(null);
    }, []);
    return {
        openEdit: setEditKeyword,
        EditDialog: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_6__["default"], {
            open: !!editKeyword,
            onCancel: onClose,
            footer: false,
            title: `${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('keyword')} ${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note')}`,
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"], {
                    children: editKeyword === null || editKeyword === void 0 ? void 0 : editKeyword.keyword
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                    lineNumber: 55,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("form", {
                    onSubmit: (e)=>{
                        (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__.eventBan)(e);
                        void onOk();
                    },
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('alias'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_4__.FlexBox, {
                                gap: 8,
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_textarea_js__WEBPACK_IMPORTED_MODULE_5__.Textarea, {
                                    autoFocus: true,
                                    value: alias,
                                    onChange: (e)=>setAlias(e.target.value)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                                    lineNumber: 64,
                                    columnNumber: 15
                                }, this)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                                lineNumber: 63,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                            lineNumber: 62,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note'),
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_4__.FlexBox, {
                                gap: 8,
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_textarea_js__WEBPACK_IMPORTED_MODULE_5__.Textarea, {
                                    value: note,
                                    onChange: (e)=>setNote(e.target.value)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                                    lineNumber: 73,
                                    columnNumber: 15
                                }, this)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                                lineNumber: 72,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                            lineNumber: 71,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"].Item, {
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
                                type: "primary",
                                htmlType: "submit",
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('update')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                                lineNumber: 80,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                            lineNumber: 79,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
                    lineNumber: 56,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords-dialogs.tsx",
            lineNumber: 49,
            columnNumber: 7
        }, this)
    };
}
_s(useKeywordDialog, "jj/92RykawMVG30phfb661y0cqM=");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/keywords.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useBookViewKeywords: function() { return useBookViewKeywords; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/dropdown/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_api_books_keywords_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/keywords.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _common_swipe_action_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/common/swipe-action.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _book_search_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/books/view/book-search.tsx");
/* harmony import */var _keywords_dialogs_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/books/view/panel/keywords-dialogs.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$();












function KeywordItem(param) {
    let { keyword, openEdit, isSelected, player } = param;
    _s();
    const bookSearch = (0,_book_search_js__WEBPACK_IMPORTED_MODULE_9__.useBookSearch)();
    const textCls = [
        'text',
        'clickable'
    ];
    if (isSelected) textCls.push('selected');
    const menuItems = [
        {
            key: 'note',
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faNoteSticky,
                size: "sm"
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                lineNumber: 40,
                columnNumber: 13
            }, this),
            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('note'),
            onClick: ()=>{
                openEdit(keyword, player);
            }
        },
        {
            key: 'remove',
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faTrash,
                size: "sm"
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                lineNumber: 48,
                columnNumber: 13
            }, this),
            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('remove'),
            onClick: ()=>{
                void player.keywords.remove(keyword);
            }
        },
        {
            key: 'search',
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faSearch,
                size: "sm"
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                lineNumber: 56,
                columnNumber: 13
            }, this),
            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('search'),
            onClick: ()=>{
                void bookSearch(keyword.keyword);
            }
        }
    ];
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_common_swipe_action_js__WEBPACK_IMPORTED_MODULE_6__.SwipeAction, {
            left: {
                node: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faNoteSticky,
                    size: "sm"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                    lineNumber: 68,
                    columnNumber: 17
                }, void 0),
                width: 30,
                trigger: ()=>{
                    openEdit(keyword, player);
                }
            },
            right: {
                node: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faTrash,
                    size: "sm"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                    lineNumber: 75,
                    columnNumber: 17
                }, void 0),
                width: 30,
                trigger: ()=>{
                    void player.keywords.remove(keyword);
                }
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
                menu: {
                    items: menuItems
                },
                trigger: [
                    'contextMenu'
                ],
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: "item",
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: textCls.join(' '),
                            style: {
                                fontSize: 13
                            },
                            onClick: (event)=>{
                                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_5__.eventBan)(event);
                                player.gotoSection(keyword.pos.section, keyword.pos.paragraph).catch(console.error);
                            },
                            children: [
                                keyword.keyword,
                                keyword.alias && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "alias",
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_13__["default"], {
                                        wrap: true,
                                        children: keyword.alias.map((a, i)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                                                className: "selected-text",
                                                children: a
                                            }, i, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                                lineNumber: 104,
                                                columnNumber: 23
                                            }, this))
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                        lineNumber: 102,
                                        columnNumber: 19
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                    lineNumber: 101,
                                    columnNumber: 17
                                }, this),
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "range",
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                                        className: "selected-text",
                                        children: keyword.brief
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                        lineNumber: 112,
                                        columnNumber: 17
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                    lineNumber: 111,
                                    columnNumber: 15
                                }, this),
                                keyword.note && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "note",
                                    children: [
                                        "note: ",
                                        keyword.note
                                    ]
                                }, void 0, true, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                    lineNumber: 114,
                                    columnNumber: 32
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                            lineNumber: 89,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: "btn",
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_12__["default"], {
                                menu: {
                                    items: menuItems
                                },
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_11__.faEllipsisVertical,
                                        style: {
                                            paddingLeft: '8px',
                                            paddingRight: '8px'
                                        }
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                        lineNumber: 123,
                                        columnNumber: 19
                                    }, this)
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                    lineNumber: 122,
                                    columnNumber: 17
                                }, this)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                                lineNumber: 117,
                                columnNumber: 15
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                            lineNumber: 116,
                            columnNumber: 13
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                    lineNumber: 88,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                lineNumber: 82,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
            lineNumber: 66,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
        lineNumber: 65,
        columnNumber: 5
    }, this);
}
_s(KeywordItem, "ihT7r3wk/cBtWsxGWp4oXvmt8Ks=", false, function() {
    return [
        _book_search_js__WEBPACK_IMPORTED_MODULE_9__.useBookSearch
    ];
});
_c = KeywordItem;
function Keywords(param) {
    let { keywords, player } = param;
    _s1();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys)();
    const [selectedIndex, setSelectedIndex] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(0);
    const refKeyword = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const { openEdit, EditDialog } = (0,_keywords_dialogs_js__WEBPACK_IMPORTED_MODULE_10__.useKeywordDialog)({
        player
    });
    const selectedKeyword = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return keywords === null || keywords === void 0 ? void 0 : keywords.at(selectedIndex);
    }, [
        keywords,
        selectedIndex
    ]);
    const removeSelectedKeyword = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(async ()=>{
        if (selectedKeyword) await player.keywords.remove(selectedKeyword);
    }, [
        player.keywords,
        selectedKeyword
    ]);
    // selected hotkeys
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const prevKeyword = ()=>{
            setSelectedIndex((idx)=>idx <= 0 ? 0 : idx - 1);
        };
        const nextKeyword = ()=>{
            keywords && setSelectedIndex((idx)=>idx >= keywords.length - 1 ? keywords.length - 1 : idx + 1);
        };
        const gotoKeyword = ()=>{
            const selectedKeyword = keywords === null || keywords === void 0 ? void 0 : keywords[selectedIndex];
            if (!selectedKeyword) return;
            player.gotoSection(selectedKeyword.pos.section, selectedKeyword.pos.paragraph).catch(console.error);
        };
        const speakKeyword = ()=>{
            if (!selectedKeyword) return;
            player.utterer.speakText(selectedKeyword.keyword).catch(console.error);
        };
        return addHotkeys([
            [
                'p',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevKeyword'),
                prevKeyword
            ],
            [
                'n',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextKeyword'),
                nextKeyword
            ],
            [
                'enter',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.gotoKeyword'),
                gotoKeyword
            ],
            [
                [
                    'd',
                    'b'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.keywordRemoveSelected'),
                ()=>removeSelectedKeyword()
            ],
            [
                [
                    'g',
                    'n'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.keywordNote'),
                ()=>openEdit(selectedKeyword ?? null)
            ],
            [
                {
                    shift: true,
                    key: 'K'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.speakKeyword'),
                speakKeyword
            ]
        ]);
    }, [
        addHotkeys,
        keywords,
        openEdit,
        player,
        removeSelectedKeyword,
        selectedKeyword,
        selectedIndex
    ]);
    // scroll to selected keyword
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!selectedKeyword) return;
        const keywordDiv = refKeyword.current;
        if (!keywordDiv) return;
        const selectedKeywordDiv = keywordDiv.querySelector('div.text.selected');
        selectedKeywordDiv === null || selectedKeywordDiv === void 0 ? void 0 : selectedKeywordDiv.scrollIntoView({
            block: 'center'
        });
    }, [
        selectedKeyword
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        className: "panel-content book-keywords",
        ref: refKeyword,
        children: [
            !(keywords === null || keywords === void 0 ? void 0 : keywords.length) ? (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.keywordsEmpty') : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
                children: keywords.map((keyword, idx)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(KeywordItem, {
                        keyword: keyword,
                        openEdit: openEdit,
                        isSelected: selectedIndex === idx,
                        player: player
                    }, idx, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                        lineNumber: 228,
                        columnNumber: 13
                    }, this))
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
                lineNumber: 226,
                columnNumber: 9
            }, this),
            EditDialog
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
        lineNumber: 222,
        columnNumber: 5
    }, this);
}
_s1(Keywords, "gViB4Cs9opl63XF3GdAmxbTLriY=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_8__.useHotkeys,
        _keywords_dialogs_js__WEBPACK_IMPORTED_MODULE_10__.useKeywordDialog
    ];
});
_c1 = Keywords;
function useBookViewKeywords(book, player) {
    _s2();
    const uuid = book.item.uuid;
    const { data: keywords, reload } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_4__.useAction)(_core_api_books_keywords_js__WEBPACK_IMPORTED_MODULE_3__.booksKeywordsRouter, {
        uuid
    }, {
        clearWhenReload: false
    });
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        player.keywords.reload = reload;
        return ()=>{
            player.keywords.reload = undefined;
        };
    }, [
        player.keywords,
        reload
    ]);
    return {
        keywords,
        KeywordView: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Keywords, {
            keywords: keywords,
            player: player
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/keywords.tsx",
            lineNumber: 265,
            columnNumber: 18
        }, this)
    };
}
_s2(useBookViewKeywords, "IIGlHp455h6m4ji/+F7MkDOrm9A=", false, function() {
    return [
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_4__.useAction
    ];
});
var _c, _c1;
$RefreshReg$(_c, "KeywordItem");
$RefreshReg$(_c1, "Keywords");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/nav.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useBookViewNav: function() { return useBookViewNav; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();




function NavList(param) {
    let { navs, activeNavs, selectedNav, player } = param;
    if (!navs.length) return null;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("ul", {
        children: navs.map((nav, idx)=>{
            const isSelected = selectedNav === nav;
            const isActivated = nav.spineIndex !== undefined && activeNavs.includes(nav);
            const textCls = [
                'text'
            ];
            if (isActivated) textCls.push('active');
            if (nav.href) textCls.push('clickable');
            if (isSelected) textCls.push('selected');
            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("li", {
                "data-href": nav.href,
                "data-spine-index": nav.spineIndex,
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                        className: "item",
                        onClick: (event)=>{
                            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_3__.eventBan)(event);
                            if (nav.href) player.gotoUrlPath(nav.href).catch(console.error);
                        },
                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: textCls.join(' '),
                            children: nav.label
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
                            lineNumber: 40,
                            columnNumber: 15
                        }, this)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
                        lineNumber: 33,
                        columnNumber: 13
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(NavList, {
                        navs: nav.children,
                        activeNavs: activeNavs,
                        selectedNav: selectedNav,
                        player: player
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
                        lineNumber: 42,
                        columnNumber: 13
                    }, this)
                ]
            }, idx, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
                lineNumber: 32,
                columnNumber: 11
            }, this);
        })
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
        lineNumber: 22,
        columnNumber: 5
    }, this);
}
_c = NavList;
function NavTree(param) {
    let { book, activeNavs, player } = param;
    _s();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys)();
    const refNav = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const [selectedIndex, setSelectedIndex] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(0);
    const selectedNav = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return book.flattenedNavs[selectedIndex];
    }, [
        book.flattenedNavs,
        selectedIndex
    ]);
    // selected hotkeys
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const prevNav = ()=>{
            setSelectedIndex((idx)=>idx <= 0 ? 0 : idx - 1);
        };
        const nextNav = ()=>{
            setSelectedIndex((idx)=>idx >= book.flattenedNavs.length - 1 ? book.flattenedNavs.length - 1 : idx + 1);
        };
        const gotoNav = ()=>{
            if (!(selectedNav === null || selectedNav === void 0 ? void 0 : selectedNav.href)) return;
            player.gotoUrlPath(selectedNav.href).catch(console.error);
        };
        const speakNav = ()=>{
            if (!selectedNav) return;
            player.utterer.speakText(selectedNav.label).catch(console.error);
        };
        return addHotkeys([
            [
                'p',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevNav'),
                prevNav
            ],
            [
                'n',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextNav'),
                nextNav
            ],
            [
                'enter',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.gotoNav'),
                gotoNav
            ],
            [
                {
                    shift: true,
                    key: 'K'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.speakNav'),
                speakNav
            ]
        ]);
    }, [
        addHotkeys,
        book.flattenedNavs,
        player,
        selectedNav
    ]);
    const lastActiveNav = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return activeNavs === null || activeNavs === void 0 ? void 0 : activeNavs.at(-1);
    }, [
        activeNavs
    ]);
    // change selected nav item
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (lastActiveNav === undefined) return;
        const lastActiveNavIndex = book.flattenedNavs.indexOf(lastActiveNav);
        if (lastActiveNavIndex === -1) return;
        setSelectedIndex(lastActiveNavIndex);
    }, [
        book.flattenedNavs,
        lastActiveNav
    ]);
    // scroll to selected nav
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!selectedNav) return;
        const navDiv = refNav.current;
        if (!navDiv) return;
        const selectedNavDiv = navDiv.querySelector('div.text.selected');
        selectedNavDiv === null || selectedNavDiv === void 0 ? void 0 : selectedNavDiv.scrollIntoView({
            block: 'center'
        });
    }, [
        selectedNav
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        ref: refNav,
        className: "panel-content book-nav",
        children: book.navs.length ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(NavList, {
            navs: book.navs,
            activeNavs: activeNavs ?? [],
            selectedNav: selectedNav,
            player: player
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
            lineNumber: 127,
            columnNumber: 9
        }, this) : (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.navEmpty')
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
        lineNumber: 125,
        columnNumber: 5
    }, this);
}
_s(NavTree, "oVkctXyGTNiYqAoZm6zIeZSlfKY=", false, function() {
    return [
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys
    ];
});
_c1 = NavTree;
function useBookViewNav(book, player, activeNavs) {
    return {
        NavTreeView: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(NavTree, {
            book: book,
            player: player,
            activeNavs: activeNavs
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/nav.tsx",
            lineNumber: 147,
            columnNumber: 7
        }, this)
    };
}
var _c, _c1;
$RefreshReg$(_c, "NavList");
$RefreshReg$(_c1, "NavTree");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/panel/panel.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useBookPanel: function() { return useBookPanel; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/store.tsx");
/* harmony import */var _annotations_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/pages/books/view/panel/annotations.tsx");
/* harmony import */var _nav_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/books/view/panel/nav.tsx");
/* harmony import */var _keywords_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/pages/books/view/panel/keywords.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();






function useBookPanel(book, player, activeNavs, pos, selection) {
    _s();
    const [viewPanelType, setViewPanelType] = (0,_store_js__WEBPACK_IMPORTED_MODULE_3__.useViewPanelType)();
    const { NavTreeView } = (0,_nav_js__WEBPACK_IMPORTED_MODULE_5__.useBookViewNav)(book, player, activeNavs);
    const { annotations, AnnotationView } = (0,_annotations_js__WEBPACK_IMPORTED_MODULE_4__.useBookViewAnnotations)(book, player, pos, selection);
    const { keywords, KeywordView } = (0,_keywords_js__WEBPACK_IMPORTED_MODULE_6__.useBookViewKeywords)(book, player);
    const BookPanelView = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: [
                        'book-panel',
                        viewPanelType === 'none' ? 'hidden' : ''
                    ].join(' '),
                    children: [
                        viewPanelType === 'nav' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                            children: [
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("h3", {
                                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('nav')
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/panel.tsx",
                                    lineNumber: 39,
                                    columnNumber: 15
                                }, this),
                                NavTreeView
                            ]
                        }, void 0, true),
                        viewPanelType === 'annotation' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                            children: [
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("h3", {
                                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('annotation')
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/panel.tsx",
                                    lineNumber: 45,
                                    columnNumber: 15
                                }, this),
                                AnnotationView
                            ]
                        }, void 0, true),
                        viewPanelType === 'keyword' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                            children: [
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("h3", {
                                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('keyword')
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/panel.tsx",
                                    lineNumber: 51,
                                    columnNumber: 15
                                }, this),
                                KeywordView
                            ]
                        }, void 0, true)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/panel.tsx",
                    lineNumber: 31,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: [
                        'book-panel-overlay',
                        viewPanelType === 'none' ? 'hidden' : ''
                    ].join(' '),
                    onClick: ()=>setViewPanelType('none')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/panel/panel.tsx",
                    lineNumber: 56,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true), [
        AnnotationView,
        KeywordView,
        NavTreeView,
        setViewPanelType,
        viewPanelType
    ]);
    return (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>({
            annotations,
            keywords,
            setViewPanelType,
            BookPanelView
        }), [
        annotations,
        keywords,
        setViewPanelType,
        BookPanelView
    ]);
}
_s(useBookPanel, "ki2ePAafr4XLrryjxFkQa3t8tk8=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_3__.useViewPanelType,
        _nav_js__WEBPACK_IMPORTED_MODULE_5__.useBookViewNav,
        _annotations_js__WEBPACK_IMPORTED_MODULE_4__.useBookViewAnnotations,
        _keywords_js__WEBPACK_IMPORTED_MODULE_6__.useBookViewKeywords
    ];
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player-annotations.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PlayerAnnotations: function() { return PlayerAnnotations; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var invert_color__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/invert-color@2.0.0/node_modules/invert-color/lib/invert.min.js");
/* harmony import */var invert_color__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(invert_color__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_api_books_annotations_delete_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/annotations-delete.ts");
/* harmony import */var _core_api_books_annotations_upsert_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/annotations-upsert.ts");
/* harmony import */var _common_confirm_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/common/confirm.tsx");
/* harmony import */var _common_notification_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/common/notification.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");








class PlayerAnnotations {
    async upsert(param, param1) {
        let { uuid, pos, range } = param, { note, color, group } = param1;
        var _this_reload, _this;
        const node = this.player.iframeCtrler.readableParts.at(pos.paragraph);
        if (!node) return;
        if (node.type !== 'text') {
            void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().error((0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.annotationNoSupported'));
            return;
        }
        const brief = node.text.slice(0, 30);
        const res = await _core_api_books_annotations_upsert_js__WEBPACK_IMPORTED_MODULE_4__.booksAnnotationsUpsertRouter.action({
            annotations: [
                {
                    uuid,
                    pos,
                    range: range ?? undefined,
                    brief,
                    type: 'text',
                    content: node.text,
                    note: note || undefined,
                    color,
                    group
                }
            ],
            uuid: this.uuid
        });
        (_this_reload = (_this = this).reload) === null || _this_reload === void 0 ? void 0 : _this_reload.call(_this);
        void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().info(`${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.annotationUpdated')} ${brief}`);
        return res.annotations.at(0);
    }
    async remove(annotation) {
        var _this_reload, _this;
        if (annotation.note || annotation.range) {
            const fgColor = annotation.color ? invert_color__WEBPACK_IMPORTED_MODULE_2___default()(annotation.color, {
                black: '#3a3a3a',
                white: '#fafafa'
            }) : 'var(--main-fg-blue)';
            if (!await (0,_common_confirm_js__WEBPACK_IMPORTED_MODULE_5__.uiConfirm)({
                title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.annotationRemoveConfirm'),
                description: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("p", {
                            children: annotation.brief
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-annotations.tsx",
                            lineNumber: 80,
                            columnNumber: 15
                        }, this),
                        annotation.note && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("p", {
                            children: [
                                "Note: ",
                                annotation.note
                            ]
                        }, void 0, true, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-annotations.tsx",
                            lineNumber: 81,
                            columnNumber: 35
                        }, this),
                        annotation.range && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("p", {
                            children: [
                                "Selected:",
                                ' ',
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                                    style: {
                                        backgroundColor: annotation.color ?? 'var(--main-bg-blue)',
                                        color: fgColor
                                    },
                                    children: annotation.range.selectedText
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-annotations.tsx",
                                    lineNumber: 85,
                                    columnNumber: 19
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-annotations.tsx",
                            lineNumber: 83,
                            columnNumber: 17
                        }, this)
                    ]
                }, void 0, true)
            })) return;
        }
        await _core_api_books_annotations_delete_js__WEBPACK_IMPORTED_MODULE_3__.booksAnnotationsDeleteRouter.action({
            uuid: this.uuid,
            annotationUuids: [
                annotation.uuid
            ]
        });
        (_this_reload = (_this = this).reload) === null || _this_reload === void 0 ? void 0 : _this_reload.call(_this);
        void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().info(`${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.annotationDeleted')} ${annotation.brief}`);
    }
    indexByPos(pos, range) {
        const annotations = this.player.states.annotations;
        if (!annotations) return null;
        const index = annotations.findIndex((n)=>{
            var _n_range, _n_range1;
            return n.pos.section === pos.section && n.pos.paragraph === pos.paragraph && ((_n_range = n.range) === null || _n_range === void 0 ? void 0 : _n_range.start) === (range === null || range === void 0 ? void 0 : range.start) && ((_n_range1 = n.range) === null || _n_range1 === void 0 ? void 0 : _n_range1.end) === (range === null || range === void 0 ? void 0 : range.end);
        });
        if (index === -1) return null;
        return index;
    }
    closestIndexByPos(pos) {
        const annotations = this.player.states.annotations;
        if (!annotations) return null;
        const index = annotations.findLastIndex((n)=>n.pos.section === pos.section && n.pos.paragraph <= pos.paragraph);
        if (index === -1) return null;
        return index;
    }
    byPos(pos, range) {
        var _this_player_states_annotations;
        const index = this.indexByPos(pos, range);
        if (index === null) return null;
        return ((_this_player_states_annotations = this.player.states.annotations) === null || _this_player_states_annotations === void 0 ? void 0 : _this_player_states_annotations.at(index)) ?? null;
    }
    async toggle(pos, range) {
        const annotation = this.byPos(pos, range);
        if (annotation) {
            await this.remove(annotation);
        } else {
            await this.upsert({
                pos,
                range,
                uuid: null
            }, {});
        }
    }
    constructor(player){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "player", void 0);
        /** book uuid */ (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "uuid", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "reload", void 0);
        this.player = player;
        this.uuid = player.book.item.uuid;
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player-iframe-controller.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PlayerIframeController: function() { return PlayerIframeController; },
  usePlayerIframe: function() { return usePlayerIframe; }
});
/* harmony import */var _swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_get.js");
/* harmony import */var _swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_init.js");
/* harmony import */var _swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_set.js");
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useMountEffect/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/@file-services+path@9.4.1/node_modules/@file-services/path/browser-path.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_file_services_path__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var _core_api_books_render_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/api/books/render.ts");
/* harmony import */var _core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/book/book-epub.ts");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/browser.ts");
/* harmony import */var _core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/util/collection.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/core/util/emitter.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _core_util_readable_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/core/util/readable.ts");
/* harmony import */var _core_util_text_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/core/util/text.ts");
/* harmony import */var _core_util_timer_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/core/util/timer.ts");
/* harmony import */var _core_util_url_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/core/util/url.ts");
/* harmony import */var _atoms_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/web/atoms.tsx");
/* harmony import */var _common_confirm_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/web/common/confirm.tsx");
/* harmony import */var _common_notification_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/web/common/notification.tsx");
/* harmony import */var _common_preview_image_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./src/web/common/preview-image.tsx");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _style_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./src/web/style.tsx");
/* harmony import */var _highlight_annotation_highlight_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__("./src/web/pages/books/view/highlight/annotation-highlight.ts");
/* harmony import */var _highlight_keyword_highlight_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__("./src/web/pages/books/view/highlight/keyword-highlight.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



























var _pushPageListLast = /*#__PURE__*/ new WeakMap(), _curAbsPath = /*#__PURE__*/ new WeakMap(), _paragraphLastActive = /*#__PURE__*/ new WeakMap();
class PlayerIframeController {
    get book() {
        return this.player.book;
    }
    get iframe() {
        return this.iframeRef.current;
    }
    get enabledPageList() {
        if (this.states.pageList === 'none') return false;
        return !this.isVertical;
    }
    get isFirstPageList() {
        return this.pageListCurIndex <= 0;
    }
    get isLastPageList() {
        if (!this.pageListCount) return true;
        return this.pageListCurIndex >= this.pageListCount - 1;
    }
    pageListType() {
        if (this.states.pageList === 'auto') {
            if (this.win) {
                return this.win.innerWidth > 700 ? 'double' : 'single';
            } else {
                return 'single';
            }
        }
        return this.states.pageList;
    }
    async tryManipulateDOM(callback) {
        await Promise.race([
            callback(),
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_9__.sleep)(100)
        ]);
    }
    getReadablePartIndexByAnchorId(anchorId) {
        if (!anchorId) return null;
        // goto anchorId
        const doc = this.doc;
        if (!doc) return null;
        try {
            const index = this.readableParts.findIndex((part)=>{
                var _part_anchorIds;
                if ((_part_anchorIds = part.anchorIds) === null || _part_anchorIds === void 0 ? void 0 : _part_anchorIds.includes(anchorId)) return true;
            });
            return index === -1 ? null : index;
        } catch  {
        // ignore selector syntax error
        }
        return null;
    }
    async scrollToCurParagraph() {
        let animated = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : true;
        // goto paragraph
        const item = this.readableParts.at(this.states.pos.paragraph);
        if (item) await this.scrollToElem(item.elem, {
            animated
        });
        else if (this.enabledPageList) // reset to current page list position
        await this.pageListScrollToLeft(this.pageListScrollLeft, {
            animated
        });
    }
    async scrollToElem(element) {
        let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        await this.tryManipulateDOM(async ()=>{
            if (!this.doc) return;
            const html = this.doc.documentElement;
            const containerRect = html.getBoundingClientRect();
            const elemRect = element.getBoundingClientRect();
            if (this.enabledPageList) {
                const left = elemRect.left + element.offsetWidth / 2 - containerRect.left;
                await this.pageListScrollToLeft(left, options);
            } else if (this.isVertical) {
                const right = elemRect.right + element.offsetWidth / 2 - containerRect.right;
                await this.scrollToRight(right, options);
            } else {
                const top = elemRect.top - containerRect.top;
                await this.scrollToTop(top, options);
            }
        });
    }
    /**
   * scroll to left offset with animation
   */ async scrollToRight(left) {
        let { iteration = 10, duration = 100, animated = true, abortCtrl, position = 'center' } = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var _this_doc;
        if (!this.win) return;
        const scrollElement = (_this_doc = this.doc) === null || _this_doc === void 0 ? void 0 : _this_doc.scrollingElement;
        if (!scrollElement) return;
        // get center left
        const finalLeft = position === 'center' ? left + this.win.innerWidth / 2 : left;
        if (!animated) {
            scrollElement.scrollLeft = finalLeft;
        } else {
            const startLeft = scrollElement.scrollLeft;
            const offset = finalLeft - startLeft;
            const unit = offset / iteration;
            await (0,_core_util_timer_js__WEBPACK_IMPORTED_MODULE_12__.iterateAnimate)({
                duration,
                iteration,
                abortCtrl
            }, (index)=>{
                scrollElement.scrollLeft = startLeft + index * unit;
            });
        }
    }
    /**
   * scroll to top offset with animation
   */ async scrollToTop(top) {
        let { iteration = 10, duration = 100, animated = true, abortCtrl, position = 'center' } = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var _this_doc;
        if (!this.win) return;
        const scrollElement = (_this_doc = this.doc) === null || _this_doc === void 0 ? void 0 : _this_doc.scrollingElement;
        if (!scrollElement) return;
        // get center top
        const finalTop = position === 'center' ? top - this.win.innerHeight / 2 : top;
        if (!animated) {
            scrollElement.scrollTop = finalTop;
        } else {
            const startTop = scrollElement.scrollTop;
            const offset = finalTop - startTop;
            const unit = offset / iteration;
            await (0,_core_util_timer_js__WEBPACK_IMPORTED_MODULE_12__.iterateAnimate)({
                duration,
                iteration,
                abortCtrl
            }, (index)=>{
                scrollElement.scrollTop = startTop + index * unit;
            });
        }
    }
    pageListSetScrollLeft(scrollLeft) {
        if (!this.doc) return;
        this.pageListScrollLeft = scrollLeft;
        this.doc.documentElement.style.transform = `translateX(${-scrollLeft}px)`;
        this.events.fire('scroll', null);
    }
    /**
   * scroll to page by left offset with animation
   */ async pageListScrollToLeft(left) {
        let { iteration = 10, duration = 100, animated = true, abortCtrl, userOperator = true } = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var _findLast;
        if (!this.enabledPageList) return;
        if (!this.pageList) return;
        const finalLeft = (_findLast = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLast)(this.pageList, (page)=>page.offsetLeft <= left)) === null || _findLast === void 0 ? void 0 : _findLast.offsetLeft;
        if (finalLeft === undefined) return;
        if (!animated) {
            this.pageListSetScrollLeft(finalLeft);
        } else {
            const startLeft = this.pageListScrollLeft;
            const offset = finalLeft - startLeft;
            const unit = offset / iteration;
            await (0,_core_util_timer_js__WEBPACK_IMPORTED_MODULE_12__.iterateAnimate)({
                duration,
                iteration,
                abortCtrl
            }, (index)=>{
                this.pageListSetScrollLeft(startLeft + index * unit);
            });
        }
        if (this.viewOffsetWidth) this.pageListCurIndex = Math.round(this.pageListScrollLeft / this.viewOffsetWidth);
        if (userOperator) this.updatePageListCurFocus();
    }
    async pageListScrollToPage(pageIndex, jump) {
        let scrollOptions = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        var _page_topmost;
        if (!this.enabledPageList) return;
        if (!this.pageList) return;
        const page = this.pageList.at(pageIndex);
        if (!page) return;
        if (jump) await this.player.gotoParagraph(((_page_topmost = page.topmost) === null || _page_topmost === void 0 ? void 0 : _page_topmost.paragraph) ?? this.states.pos.paragraph);
        else await this.pageListScrollToLeft(page.offsetLeft, scrollOptions);
    }
    async pageListPushAdjust(offsetPage, jump) {
        var _class_private_field_get1;
        if (!this.viewOffsetWidth || !this.pageListCount || !this.pageList) return;
        let goalPageIndex;
        if ((0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _pushPageListLast)) {
            goalPageIndex = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _pushPageListLast).pageIndex + offsetPage;
        } else {
            goalPageIndex = this.pageListCurIndex + offsetPage;
        }
        // exceed section range
        if (jump) {
            if (goalPageIndex < 0) {
                return await this.player.prevSection(-1);
            } else if (goalPageIndex >= this.pageListCount) {
                return await this.player.nextSection();
            }
        } else {
            if (goalPageIndex < 0) goalPageIndex = 0;
            else if (goalPageIndex >= this.pageListCount) goalPageIndex = this.pageListCount - 1;
        }
        (_class_private_field_get1 = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _pushPageListLast)) === null || _class_private_field_get1 === void 0 ? void 0 : _class_private_field_get1.abortCtrl.abort();
        const abortCtrl = new AbortController();
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_23__._)(this, _pushPageListLast, {
            abortCtrl,
            pageIndex: goalPageIndex
        });
        const goalLeft = goalPageIndex * this.viewOffsetWidth;
        await this.pageListScrollToLeft(goalLeft, {
            abortCtrl
        });
        if (jump) {
            const page = this.pageList.at(goalPageIndex);
            if (page === null || page === void 0 ? void 0 : page.topmost) await this.player.gotoParagraph(page.topmost.paragraph, false);
        }
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_23__._)(this, _pushPageListLast, undefined);
    }
    async scrollToPercent(percent, jump) {
        var _this_doc;
        const scrollElement = (_this_doc = this.doc) === null || _this_doc === void 0 ? void 0 : _this_doc.scrollingElement;
        // eslint-disable-next-line no-console
        console.debug(`scrollElement: ${(scrollElement === null || scrollElement === void 0 ? void 0 : scrollElement.tagName) ?? 'null'}`);
        if (!scrollElement) return;
        if (!this.enabledPageList) {
            const scrollTop = (scrollElement.scrollHeight - scrollElement.clientHeight) * percent;
            await this.scrollToTop(scrollTop, {
                position: 'start'
            });
            return;
        }
        // page list
        if (!this.viewOffsetWidth) return;
        const targetIndex = Math.floor(this.pageListScrollWidth * percent / this.viewOffsetWidth);
        const offsetIndex = targetIndex - this.pageListCurIndex;
        await this.pageListPushAdjust(offsetIndex, jump);
    }
    /**
   * @param locate default is this.states.pos
   */ async load() {
        let locate = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        const iframe = this.iframe;
        if (!iframe) return;
        const force = locate.force ?? false;
        // get spine
        const section = locate.section ?? this.states.pos.section;
        let spine = this.book.spines.at(section);
        if (!spine) spine = this.book.spines.at(0);
        if (!spine) return (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_16__.messageApi)().error('book spine is empty');
        // update section
        this.states.pos = {
            ...this.states.pos,
            section
        };
        const absPath = spine.href;
        const isLoadNewPath = force || absPath !== (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _curAbsPath);
        (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_23__._)(this, _curAbsPath, absPath);
        try {
            // load iframe
            if (isLoadNewPath) {
                this.states.loading = true;
                // NOTE: (visibility = none) has BUG in Safari
                this.iframe.style.opacity = '0';
                this.unmount.fire();
                const loaded = new Promise((resolve)=>{
                    iframe.addEventListener('load', ()=>{
                        resolve();
                    }, {
                        once: true
                    });
                });
                iframe.src = (0,_core_api_books_render_js__WEBPACK_IMPORTED_MODULE_2__.getBooksRenderPath)(this.book.item.uuid, absPath);
                await loaded;
                const doc = iframe.contentDocument;
                if (!doc) return (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_16__.messageApi)().error('iframe load failed');
                // load readableParts & alias
                const readableExtractor = new _core_util_readable_js__WEBPACK_IMPORTED_MODULE_10__.ReadableExtractor(doc, this.book.flattenedNavs);
                this.readableParts = readableExtractor.toReadableParts();
                this.alias = readableExtractor.alias();
                // loaded
                await this.onLoaded(iframe);
            }
            // update paragraph
            let paragraph = this.states.pos.paragraph;
            if (locate.paragraph !== undefined) {
                paragraph = locate.paragraph < 0 ? this.readableParts.length + locate.paragraph : locate.paragraph;
                // if exceeds readablePart range
                if (paragraph < 0) paragraph = 0;
                else if (paragraph >= this.readableParts.length) paragraph = this.readableParts.length - 1;
            } else if (locate.anchorId) paragraph = this.getReadablePartIndexByAnchorId(locate.anchorId) ?? 0;
            this.states.pos = {
                ...this.states.pos,
                paragraph
            };
            // scroll to paragraph
            await this.scrollToCurParagraph(locate.animated ?? false);
        } finally{
            if (isLoadNewPath) {
                this.states.loading = false;
                this.iframe.style.opacity = '1';
            }
        }
    }
    async gotoUrlPath(path) {
        const [urlMain, anchorId] = (0,_core_util_url_js__WEBPACK_IMPORTED_MODULE_13__.urlSplitAnchor)(path);
        const section = this.book.spines.findIndex((s)=>s.href === urlMain);
        if (section === -1) return;
        if (anchorId) await this.load({
            section,
            anchorId
        });
        else await this.load({
            section,
            paragraph: 0
        });
    }
    /**
   * When loaded a new page
   */ async onLoaded(iframe) {
        const win = iframe.contentWindow;
        const doc = iframe.contentDocument;
        // load inject and hook
        if (win && doc) {
            this.win = win;
            this.doc = doc;
            _store_global_js__WEBPACK_IMPORTED_MODULE_18__.globalStore.set(_atoms_js__WEBPACK_IMPORTED_MODULE_14__.iframeWinAtom, {
                win
            });
            if (!this.states.disabledVertical) this.isVertical = win.getComputedStyle(doc.body).writingMode.startsWith('vertical');
            else this.isVertical = false;
            this.updateColorTheme(this.colorScheme);
            this.injectCSS(doc);
            this.updateFontSize(doc);
            this.viewCalculate(doc);
            this.hookResize(win, doc);
            this.resizeImgs(doc);
            this.hookTouch();
            if (this.enabledPageList) {
                await this.pageListCalculate(doc);
                this.hookPageWheel();
                this.hookSwipe();
            }
            if (this.isVertical) {
                this.hookVerticalWheel();
            }
            this.hookSelection();
            this.hookScroll();
            this.hookALinks(doc);
            this.hookLinkClick();
            this.hookImgs(doc);
            this.hookParagraphClick();
            this.player.utterer.hl.reCreateRoot(doc);
            this.annotationHl.reCreateRoot(doc);
            this.keywordHl.reCreateRoot(doc);
            this.updateAnnotations();
            this.updateKeywords();
        }
    }
    updateColorTheme(colorScheme) {
        this.colorScheme = colorScheme;
        if (!this.doc) return;
        if (colorScheme === 'dark') {
            this.doc.documentElement.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS);
        } else {
            this.doc.documentElement.classList.remove(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS);
        }
    }
    injectCSS(doc) {
        const styleElem = doc.createElement('style');
        let pageStyle = '';
        if (this.enabledPageList) {
            pageStyle += `
        /* page list */
        html {
          width: 100% !important;
          height: 100% !important;
          box-sizing: border-box !important;
          margin: 0 !important;
          padding: 0 !important;
          overflow: hidden !important;
          will-change: transform !important;
        }
        body {
          width: auto !important;
          height: 100% !important;
          box-sizing: border-box !important;
          word-break: break-word !important;
          margin: 0 !important;
          padding: 0 !important;
          /* Safari iOS not support
            columns: var(--main-column-count) auto !important;
          */
          columns: var(--main-column-count) var(--main-column-width) !important;
          column-gap: ${this.pageListGap}px !important;
          column-fill: auto !important;
        }
        .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLUMN_BREAK_CLASS} {
          content: ' ';
          break-before: column;
          ${_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isSafari || _core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isFirefox ? 'height: 100%' : ''}
        }
      `;
        } else {
            pageStyle += `
        html {
          width: 100%;
          height: 100%;
          box-sizing: border-box !important;
          margin: 0 !important;
          padding: 8px !important;
        }
        body {
          ${this.isVertical ? `
                width: auto;
                height: 100%;
                overflow-y: hidden;
              ` : `
                height: auto;
                width: 100%;
                overflow-x: hidden;
              `}
          box-sizing: border-box !important;
        }
      `;
        }
        if (this.states.disabledVertical) {
            pageStyle += `
        body {
          writing-mode: initial !important;
        }
      `;
        }
        let hoverStyle = '';
        if (!_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile) {
            hoverStyle = `
        .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_BOX_CLASS}:hover {
          outline: 1px dashed var(--main-fg-hover);
        }
      `;
        }
        styleElem.innerHTML = `
      ${_style_js__WEBPACK_IMPORTED_MODULE_19__.globalStyle}
      ${pageStyle}

      /* scrollbar */
      ::-webkit-scrollbar-thumb {
        background: var(--main-fg);
      }

      /* wrap */
      pre {
        white-space: pre-wrap;
      }

      /* image */
      svg {
        max-width: 90% !important;
        max-height: 90vh;
      }
      img.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_WIDTH_CLASS} {
        max-width: 90% !important;
        height: auto;
      }
      img.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_HEIGHT_CLASS} {
        width: auto;
        max-height: 90vh;
      }

      /* scheme */
      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS} body,
      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLOR_SCHEME_DARK_CLASS} body * {
        background-color: var(--main-bg);
        color: var(--main-fg) !important;
      }

      /* paragraph */
      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_BOX_CLASS} {
        cursor: pointer;
      }

      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_BOX_CLASS}.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ACTIVE_CLASS},
      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_BOX_CLASS}.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ACTIVE_CLASS} * {
        background: var(--main-bg-active) !important;
      }

      ${hoverStyle}

      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.ROOT_UTTERER_HIGHLIGHT_CLASS} > div, .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.ROOT_ANNOTATION_HIGHLIGHT_CLASS} > div, .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.ROOT_KEYWORD_HIGHLIGHT_CLASS} > div {
        background-color: var(--main-bg-highlight) !important;
        color: var(--main-fg-highlight) !important;
        position: absolute;
        user-select: none;
        pointer-events: none;
      }

      .${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ANNOTATION_CLASS} {
        text-decoration-line: underline;
        text-decoration-style: solid;
        text-decoration-thickness: 2px;
        text-decoration-color: var(--main-bg-blue);
        text-underline-offset: 4px;
      }
    `;
        doc.head.appendChild(styleElem);
        doc.querySelectorAll('svg').forEach((svg)=>{
            svg.setAttribute('preserveAspectRatio', 'xMinYMin meet');
        });
    }
    updateFontSize(doc) {
        this.tryManipulateDOM(()=>{
            doc.documentElement.style.fontSize = `${this.states.fontSize}px`;
        }).catch(console.error);
    }
    hookResize(win, doc) {
        const onResized = ()=>this.onResized(doc);
        win.addEventListener('resize', onResized);
        this.unmount.on(()=>{
            win.removeEventListener('resize', onResized);
        });
    }
    resizeImgs(doc) {
        const imgClasses = [
            _core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_WIDTH_CLASS,
            _core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_HEIGHT_CLASS
        ];
        const imgs = doc.querySelectorAll('img');
        // remove classes
        for (const img of imgs){
            img.classList.remove(...imgClasses);
        }
        if (!this.viewWidth) return;
        if (this.pageListType() === 'none') {
            for (const img of imgs){
                if (img.width > this.viewWidth) img.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_WIDTH_CLASS);
            }
        }
    }
    hookTouch() {
        if (!_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.supportedTouch) return;
        const doc = this.doc;
        const win = this.win;
        const viewWidth = this.viewWidth;
        if (!doc || !win || !viewWidth) return;
        let startPoint = undefined;
        const speedLimit = 0.3;
        const viewRateLimit = 0.2;
        const onStart = (event)=>{
            const touch = event.touches[0];
            if (!touch) return;
            startPoint = {
                x: touch.clientX,
                y: touch.clientY,
                offsetLeft: this.pageListScrollLeft,
                timestamp: Date.now()
            };
        };
        const onMove = (event)=>{
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(event);
            if (startPoint === undefined) return;
            const selection = doc.getSelection();
            if ((selection === null || selection === void 0 ? void 0 : selection.type) === 'Range') {
                startPoint = undefined;
                return;
            }
            const touch = event.touches[0];
            if (!touch) return;
            const deltaX = touch.clientX - startPoint.x;
            this.pageListSetScrollLeft(startPoint.offsetLeft - deltaX);
        };
        const onEnd = (event)=>{
            if (startPoint === undefined) return;
            const touch = event.changedTouches[0];
            if (!touch) return;
            const deltaX = touch.clientX - startPoint.x;
            const speed = deltaX / (Date.now() - startPoint.timestamp);
            const minX = viewWidth * viewRateLimit;
            if (speed < -speedLimit || deltaX < -minX) {
                if (!this.isLastPageList || !this.player.isLastSection) {
                    this.events.fire('swipeRight', null);
                    return;
                }
            } else if (speed > speedLimit || deltaX > minX) {
                if (!this.isFirstPageList || !this.player.isFirstSection) {
                    this.events.fire('swipeLeft', null);
                    return;
                }
            }
            // restore
            void this.pageListPushAdjust(0, false);
        };
        doc.addEventListener('touchstart', onStart);
        doc.addEventListener('touchmove', onMove);
        doc.addEventListener('touchend', onEnd);
        this.unmount.on(()=>{
            doc.removeEventListener('touchstart', onStart);
            doc.removeEventListener('touchmove', onMove);
            doc.removeEventListener('touchend', onEnd);
        });
    }
    hookPageWheel() {
        const doc = this.doc;
        if (!doc) return;
        const onWheel = (e)=>{
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(e);
            if ((0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.isInputElement)(e.target)) return;
            if (e.deltaY === 0) return;
            if (e.deltaY > 0) {
                this.events.fire('swipeRight', null);
            } else {
                this.events.fire('swipeLeft', null);
            }
        };
        doc.documentElement.addEventListener('wheel', onWheel);
        this.unmount.on(()=>{
            doc.documentElement.removeEventListener('wheel', onWheel);
        });
    }
    hookSwipe() {
        const disposeSwipeLeft = this.events.on('swipeLeft', async ()=>{
            await this.player.prevPage(1, true);
        });
        const disposeSwipeRight = this.events.on('swipeRight', async ()=>{
            await this.player.nextPage(1, true);
        });
        this.unmount.on(()=>{
            disposeSwipeLeft();
            disposeSwipeRight();
        });
    }
    hookVerticalWheel() {
        var _this_doc;
        const doc = this.doc;
        const scrollElement = (_this_doc = this.doc) === null || _this_doc === void 0 ? void 0 : _this_doc.scrollingElement;
        if (!doc || !scrollElement) return;
        const onWheel = (e)=>{
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(e);
            if ((0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.isInputElement)(e.target)) return;
            if (e.deltaY === 0) return;
            scrollElement.scrollLeft -= e.deltaY;
        };
        doc.documentElement.addEventListener('wheel', onWheel);
        this.unmount.on(()=>{
            doc.documentElement.removeEventListener('wheel', onWheel);
        });
    }
    hookSelection() {
        const win = this.win;
        const doc = this.doc;
        if (!win || !doc) return;
        doc.addEventListener('selectionchange', ()=>{
            const boxSelector = `.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_BOX_CLASS}`;
            const getSelectionPosRange = ()=>{
                const sel = doc.getSelection();
                if (!sel || sel.rangeCount <= 0) return;
                const range = sel.getRangeAt(0);
                const selectedText = range.toString();
                const length = selectedText.length;
                if (!length) return;
                const parent = range.commonAncestorContainer.parentElement;
                if (!parent) return;
                const elem = parent.matches(boxSelector) ? parent : parent.closest(boxSelector);
                if (!elem) return;
                const paragraph = this.readableParts.findIndex((part)=>part.elem === elem);
                if (paragraph === -1) return;
                const preCaretRange = range.cloneRange();
                preCaretRange.selectNodeContents(elem);
                preCaretRange.setEnd(range.endContainer, range.endOffset);
                const start = preCaretRange.toString().length - length;
                return {
                    paragraph,
                    start,
                    end: start + length,
                    selectedText
                };
            };
            const posRange = getSelectionPosRange();
            if (posRange) {
                this.states.pos = {
                    ...this.states.pos,
                    paragraph: posRange.paragraph
                };
                this.states.selection = {
                    start: posRange.start,
                    end: posRange.end,
                    selectedText: posRange.selectedText
                };
            } else {
                this.states.selection = undefined;
            }
        });
        if (_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile) {
            const onBlur = ()=>{
                var _doc_getSelection;
                (_doc_getSelection = doc.getSelection()) === null || _doc_getSelection === void 0 ? void 0 : _doc_getSelection.removeAllRanges();
            };
            win.addEventListener('blur', onBlur);
            this.unmount.on(()=>{
                win.removeEventListener('blur', onBlur);
            });
        }
    }
    hookScroll() {
        var _this_doc;
        const scrollElement = (_this_doc = this.doc) === null || _this_doc === void 0 ? void 0 : _this_doc.scrollingElement;
        if (!this.doc || !scrollElement) return;
        const onScroll = ()=>{
            let percent;
            if (this.enabledPageList) percent = this.pageListScrollLeft / (this.pageListScrollWidth - scrollElement.clientWidth);
            else if (this.isVertical) percent = -scrollElement.scrollLeft / (scrollElement.scrollWidth - scrollElement.clientWidth);
            else percent = scrollElement.scrollTop / (scrollElement.scrollHeight - scrollElement.clientHeight);
            this.states.scrollPercent = percent * 100;
        };
        onScroll();
        const disposeScrollEvent = this.events.on('scroll', ()=>onScroll());
        this.doc.addEventListener('scroll', ()=>this.events.fire('scroll', null), {
            passive: true
        });
        this.unmount.on(()=>{
            disposeScrollEvent();
        });
    }
    hookALinks(doc) {
        for (const link of doc.querySelectorAll('a')){
            if (!link.href) continue;
            link.addEventListener('click', (e)=>{
                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(e);
                this.events.fire('click', link);
            });
        }
    }
    hookLinkClick() {
        const confirmLink = async (href)=>{
            return await (0,_common_confirm_js__WEBPACK_IMPORTED_MODULE_15__.uiConfirm)({
                title: (0,i18next__WEBPACK_IMPORTED_MODULE_0__.t)('confirm.openLink'),
                description: href
            });
        };
        const openLink = async (href)=>{
            if (await confirmLink(href)) window.open(href, '_blank', 'noopener,noreferrer');
        };
        const onClickLink = (link)=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_9__.async)(async ()=>{
                const isToc = link.closest(_core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_3__.NAV_TOC_SELECTOR);
                let uri;
                if (isToc) {
                    const href = link.getAttribute('href');
                    if (!href) return;
                    uri = _file_services_path__WEBPACK_IMPORTED_MODULE_1___default().join('/', href);
                } else {
                    const href = link.href;
                    if (!href) return;
                    if (!href.startsWith(this.mainContentRootUrl)) return await openLink(href);
                    uri = href.substring(this.mainContentRootUrl.length);
                }
                if (await confirmLink(uri)) {
                    await this.gotoUrlPath(uri);
                    this.player.utterer.cancel();
                }
            });
        };
        const disposeClick = this.events.on('click', onClickLink);
        this.unmount.on(()=>{
            disposeClick();
        });
    }
    hookImgs(doc) {
        for (const img of doc.querySelectorAll('img')){
            img.addEventListener('click', (event)=>{
                const src = img.src;
                if (!src) return;
                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(event);
                _store_global_js__WEBPACK_IMPORTED_MODULE_18__.globalStore.set(_common_preview_image_js__WEBPACK_IMPORTED_MODULE_17__.previewImgSrcAtom, src);
            });
        }
        for (const svg of doc.querySelectorAll('svg')){
            svg.addEventListener('click', (event)=>{
                (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(event);
                (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_9__.async)(async ()=>{
                    const dataURL = await (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.svgToDataUri)(svg, doc.URL);
                    _store_global_js__WEBPACK_IMPORTED_MODULE_18__.globalStore.set(_common_preview_image_js__WEBPACK_IMPORTED_MODULE_17__.previewImgSrcAtom, dataURL);
                });
            });
        }
    }
    hookParagraphClick() {
        const win = this.win;
        const doc = this.doc;
        if (!win || !doc) return;
        const click = (e, paraIndex)=>{
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(e);
            void this.player.gotoParagraph(paraIndex, false);
        };
        const dblclick = (e, paraIndex)=>{
            var _doc_getSelection;
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_7__.eventBan)(e);
            (_doc_getSelection = doc.getSelection()) === null || _doc_getSelection === void 0 ? void 0 : _doc_getSelection.removeAllRanges();
            void this.player.annotations.toggle({
                section: this.states.pos.section,
                paragraph: paraIndex
            }, null);
        };
        this.readableParts.forEach((n, i)=>{
            if (n.type === 'text') {
                n.elem.addEventListener('click', (e)=>click(e, i));
                n.elem.addEventListener('dblclick', (e)=>dblclick(e, i));
            }
        });
    }
    viewCalculate(doc) {
        const viewRect = doc.documentElement.getBoundingClientRect();
        this.viewWidth = viewRect.width;
        this.viewOffsetWidth = viewRect.width + this.pageListGap;
        this.viewHeight = viewRect.height;
        // eslint-disable-next-line no-console
        console.debug(`viewWidth: ${this.viewWidth}`);
        // eslint-disable-next-line no-console
        console.debug(`viewOffsetWidth: ${this.viewOffsetWidth}`);
        // eslint-disable-next-line no-console
        console.debug(`viewHeight: ${this.viewHeight}`);
    }
    pageListScrollWidthCalculate(html, breakElem) {
        let min = Infinity;
        let max = -Infinity;
        if (!this.readableParts.length) return html.scrollWidth;
        for (const elem of [
            ...this.readableParts.map((part)=>part.elem),
            breakElem
        ]){
            if (!elem) continue;
            const rect = elem.getBoundingClientRect();
            if (rect.left < min) min = rect.left;
            if (rect.right > max) max = rect.right;
        }
        return max - min;
    }
    async pageListCalculate(doc) {
        var // update page list width
        _doc_querySelector;
        if (!this.viewWidth || !this.viewOffsetWidth) return;
        const html = doc.documentElement;
        const pageListType = this.pageListType();
        // update column count
        const columnCount = pageListType === 'single' ? 1 : 2;
        const columnWidth = (this.viewWidth - this.pageListGap) / columnCount;
        html.style.setProperty('--main-column-count', columnCount.toString());
        html.style.setProperty('--main-column-width', `${columnWidth}px`);
        this.pageListColumnWidth = columnWidth;
        this.pageListResizeImgs(doc, this.pageListColumnWidth);
        this.pageListScrollWidth = this.pageListScrollWidthCalculate(html, null);
        let pageCount;
        (_doc_querySelector = doc.querySelector(`.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLUMN_BREAK_CLASS}`)) === null || _doc_querySelector === void 0 ? void 0 : _doc_querySelector.remove();
        if (pageListType === 'double') {
            // fix column double last page
            pageCount = Math.round(2 * this.pageListScrollWidth / this.viewOffsetWidth);
            if (pageCount % 2 === 1) {
                // add empty page & update the scrollWidth
                pageCount += 1;
                const p = doc.createElement('p');
                p.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.COLUMN_BREAK_CLASS);
                doc.body.appendChild(p);
                this.pageListScrollWidth = this.pageListScrollWidthCalculate(html, p);
            }
            pageCount /= 2;
        } else {
            pageCount = Math.round(this.pageListScrollWidth / this.viewOffsetWidth);
        }
        if (pageCount < 1) pageCount = 1;
        this.pageListCount = pageCount;
        // eslint-disable-next-line no-console
        console.debug(`pageListScrollWidth: ${this.pageListScrollWidth}`);
        // eslint-disable-next-line no-console
        console.debug(`pageListColumnWidth: ${this.pageListColumnWidth}`);
        // eslint-disable-next-line no-console
        console.debug(`pageListCount: ${this.pageListCount}`);
        this.parsePageList(html);
    }
    pageListResizeImgs(doc, columnWidth) {
        if (!this.viewHeight) return;
        const imgs = doc.querySelectorAll('img');
        const pageWHRate = columnWidth / this.viewHeight;
        for (const img of imgs){
            if (img.width > columnWidth || img.height > this.viewHeight) img.classList.add(img.naturalWidth / img.naturalHeight > pageWHRate ? _core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_WIDTH_CLASS : _core_consts_js__WEBPACK_IMPORTED_MODULE_4__.IMG_MAX_HEIGHT_CLASS);
        }
    }
    parsePageList(html) {
        const viewOffsetWidth = this.viewOffsetWidth;
        if (!viewOffsetWidth) return;
        if (!this.pageListCount) return;
        this.pageList = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.range)(0, this.pageListCount).map((i)=>i * viewOffsetWidth).map((offsetLeft)=>({
                offsetLeft
            }));
        const parentLeft = html.getBoundingClientRect().left;
        for (const [paragraph, readablePart] of this.readableParts.entries()){
            const rect = readablePart.elem.getBoundingClientRect();
            const offsetLeft = rect.left + readablePart.elem.offsetWidth / 2 - parentLeft;
            const page = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLast)(this.pageList, (page)=>page.offsetLeft <= offsetLeft);
            if (page && !page.topmost) page.topmost = {
                readablePart,
                paragraph
            };
        }
    }
    updatePageListCurFocus() {
        if (!this.pageList) return;
        // update focus part
        const paragraph = this.states.pos.paragraph;
        const pageListPosIndex = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLastIndex)(this.pageList, (page)=>!!page.topmost && page.topmost.paragraph <= paragraph);
        if (pageListPosIndex === this.pageListCurIndex) {
            // use the pos paragraph as resize focus
            this.pageListResizeCurFocusPart = this.readableParts.at(paragraph);
        } else {
            var _this_pageList_at_topmost, _this_pageList_at;
            // use pageListCurIndex as resize focus
            this.pageListResizeCurFocusPart = (_this_pageList_at = this.pageList.at(this.pageListCurIndex)) === null || _this_pageList_at === void 0 ? void 0 : (_this_pageList_at_topmost = _this_pageList_at.topmost) === null || _this_pageList_at_topmost === void 0 ? void 0 : _this_pageList_at_topmost.readablePart;
        }
    }
    updateParagraphActive() {
        this.tryManipulateDOM(()=>{
            var _class_private_field_get1;
            const item = this.readableParts.at(this.states.pos.paragraph);
            if (!item || (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _paragraphLastActive) && item === (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _paragraphLastActive)) return;
            (_class_private_field_get1 = (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_22__._)(this, _paragraphLastActive)) === null || _class_private_field_get1 === void 0 ? void 0 : _class_private_field_get1.elem.classList.remove(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ACTIVE_CLASS);
            (0,_swc_helpers_class_private_field_set__WEBPACK_IMPORTED_MODULE_23__._)(this, _paragraphLastActive, item);
            item.elem.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ACTIVE_CLASS);
        }).catch(console.error);
    }
    updateAnnotations() {
        this.tryManipulateDOM(()=>{
            if (!this.states.annotations || !this.doc) return;
            for (const item of Array.from(this.doc.querySelectorAll(`.${_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ANNOTATION_CLASS}`))){
                item.classList.remove(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ANNOTATION_CLASS);
            }
            const hlBlocks = [];
            for (const annotation of this.states.annotations){
                if (annotation.pos.section !== this.states.pos.section) continue;
                const node = this.readableParts.at(annotation.pos.paragraph);
                if (!node) continue;
                if (!annotation.range) {
                    node.elem.classList.add(_core_consts_js__WEBPACK_IMPORTED_MODULE_4__.PARA_ANNOTATION_CLASS);
                    continue;
                }
                hlBlocks.push({
                    node,
                    charIndex: annotation.range.start,
                    charLength: annotation.range.end - annotation.range.start,
                    color: 'var(--main-bg-blue)'
                });
            }
            this.annotationHl.highlight(hlBlocks, false);
        }).catch(console.error);
    }
    updateKeywords() {
        this.tryManipulateDOM(()=>{
            if (!this.states.keywords || !this.doc) return;
            const hlBlocks = [];
            for (const keyword of this.states.keywords){
                const nodes = this.readableParts.filter((p)=>p.type === 'text');
                if (!nodes.length) continue;
                for (const node of nodes){
                    const matches = (0,_core_util_text_js__WEBPACK_IMPORTED_MODULE_11__.keywordMatches)(node.text, keyword);
                    if (!matches.length) continue;
                    for (const [startIdx, length] of matches){
                        hlBlocks.push({
                            node,
                            charIndex: startIdx,
                            charLength: length,
                            color: 'var(--main-bg-blue)'
                        });
                    }
                }
            }
            this.keywordHl.highlight(hlBlocks, false);
        }).catch(console.error);
    }
    updateActiveNavs() {
        // same spineIndex navs
        const navs = this.book.flattenedNavs.filter((nav)=>nav.spineIndex === this.states.pos.section);
        const findNav = ()=>{
            var _findLast;
            // get last nav of less than spineIndex
            if (navs.length === 0) {
                const lastNav = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLast)(this.book.flattenedNavs, (nav)=>!!nav.spineIndex && nav.spineIndex < this.states.pos.section);
                return lastNav;
            }
            // last anchor from iframe page
            const readableParts = this.readableParts;
            const lastAnchors = (_findLast = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLast)(readableParts.slice(0, this.states.pos.paragraph + 1), (part)=>!!part.navAnchorIds)) === null || _findLast === void 0 ? void 0 : _findLast.navAnchorIds;
            const lastAnchor = lastAnchors && lastAnchors.length > 0 ? lastAnchors[lastAnchors.length - 1] : null;
            // no anchor in iframe
            if (!lastAnchor) {
                return navs[0];
            }
            // find last matched anchor nav
            const matchedNav = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLast)(navs, (nav)=>nav.hrefAnchor === lastAnchor);
            // no matched nav by last anchor
            if (!matchedNav) {
                return navs[0];
            }
            return matchedNav;
        };
        const matchedNav = findNav();
        if (!matchedNav) {
            this.states.activeNavs = [];
            return;
        }
        const matchedNavIndex = this.book.flattenedNavs.indexOf(matchedNav);
        if (matchedNavIndex === -1) {
            this.states.activeNavs = [];
            return;
        }
        // find all parent navs
        const matchedNavs = [
            matchedNav
        ];
        let index = matchedNavIndex - 1;
        let level = matchedNav.level - 1;
        while(index >= 0 && level > 0){
            const [nav, newIndex] = (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_6__.findLastPair)(this.book.flattenedNavs, (nav)=>nav.level === level, index);
            if (nav) {
                index = newIndex - 1;
                level = nav.level - 1;
                matchedNavs.unshift(nav);
            } else {
                break;
            }
        }
        this.states.activeNavs = matchedNavs;
    }
    constructor(player, states, iframeRef){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "player", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "states", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "iframeRef", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "readableParts", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "alias", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "doc", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "events", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "unmount", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "isVertical", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "annotationHl", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "keywordHl", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "mainContentRootPath", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "mainContentRootUrl", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "colorScheme", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "viewWidth", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "viewOffsetWidth", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "viewHeight", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageList", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListGap", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListScrollWidth", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListScrollLeft", void 0);
        /** page list: single page width */ (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListColumnWidth", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListCount", void 0);
        /** page list: current index */ (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListCurIndex", void 0);
        /** page list: focus to part after resize */ (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "pageListResizeCurFocusPart", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "win", void 0);
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_25__._)(this, _pushPageListLast, {
            writable: true,
            value: void 0
        });
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_25__._)(this, _curAbsPath, {
            writable: true,
            value: void 0
        });
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_24__._)(this, "onResized", void 0);
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_25__._)(this, _paragraphLastActive, {
            writable: true,
            value: void 0
        });
        this.player = player;
        this.states = states;
        this.iframeRef = iframeRef;
        this.readableParts = [];
        this.alias = [];
        this.events = new _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_8__.Emitter();
        this.unmount = new _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_8__.SingleEmitter({
            once: true
        });
        this.isVertical = false;
        this.colorScheme = 'light';
        this.pageListGap = 12;
        this.pageListScrollWidth = 0;
        this.pageListScrollLeft = 0;
        this.pageListCurIndex = 0;
        this.onResized = (0,_core_util_timer_js__WEBPACK_IMPORTED_MODULE_12__.debounceFn)(300, (doc)=>{
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_9__.async)(async ()=>{
                this.viewCalculate(doc);
                this.resizeImgs(doc);
                if (this.enabledPageList) {
                    await this.pageListCalculate(doc);
                    const resizeFocusPart = this.pageListResizeCurFocusPart;
                    if (resizeFocusPart) await this.scrollToElem(resizeFocusPart.elem, {
                        animated: false,
                        userOperator: false
                    });
                    else await this.pageListScrollToLeft(this.pageListScrollLeft, {
                        animated: false,
                        userOperator: false
                    });
                    this.player.utterer.hl.highlightHide();
                    this.updateAnnotations();
                    this.updateKeywords();
                }
            });
        });
        this.mainContentRootPath = (0,_core_api_books_render_js__WEBPACK_IMPORTED_MODULE_2__.getBooksRenderPath)(this.book.item.uuid, '');
        this.mainContentRootUrl = new URL(this.mainContentRootPath, location.href).toString();
        this.annotationHl = new _highlight_annotation_highlight_js__WEBPACK_IMPORTED_MODULE_20__.AnnotationHighlight(this, states);
        this.keywordHl = new _highlight_keyword_highlight_js__WEBPACK_IMPORTED_MODULE_21__.KeywordHighlight(this, states);
        this.states.events.on('pos', ()=>{
            this.updateParagraphActive();
            this.updateActiveNavs();
        });
        this.states.events.on('started', (started)=>{
            if (!started) {
                this.player.utterer.hl.highlightHide();
            }
        });
        this.states.uiEvents.on('annotations', ()=>{
            this.updateAnnotations();
        });
        this.states.uiEvents.on('keywords', ()=>{
            this.updateKeywords();
        });
        let firstPageListChanged = true;
        this.states.uiEvents.on('pageList', async ()=>{
            if (firstPageListChanged) {
                firstPageListChanged = false;
                return;
            }
            if (this.iframe) await this.load({
                force: true
            });
        });
        let firstDisabledVerticalChanged = true;
        this.states.uiEvents.on('disabledVertical', async ()=>{
            if (firstDisabledVerticalChanged) {
                firstDisabledVerticalChanged = false;
                return;
            }
            if (this.iframe) await this.load({
                force: true
            });
        });
        this.states.uiEvents.on('fontSize', async ()=>{
            if (!this.doc) return;
            this.updateFontSize(this.doc);
            this.onResized(this.doc);
        });
        this.player.unmount.on(()=>this.unmount.fire());
    }
}
function usePlayerIframe(player) {
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_26__.useMountEffect)(async ()=>{
        // first load page
        await player.iframeCtrler.load();
    });
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player-keywords.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PlayerKeywords: function() { return PlayerKeywords; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var invert_color__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/invert-color@2.0.0/node_modules/invert-color/lib/invert.min.js");
/* harmony import */var invert_color__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(invert_color__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var _core_api_books_keywords_delete_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/keywords-delete.ts");
/* harmony import */var _core_api_books_keywords_upsert_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/keywords-upsert.ts");
/* harmony import */var _common_confirm_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/common/confirm.tsx");
/* harmony import */var _common_notification_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/common/notification.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");








class PlayerKeywords {
    getBriefText(pos) {
        const node = this.player.iframeCtrler.readableParts.at(pos.paragraph);
        if (!node) return;
        if (node.type !== 'text') {
            void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().error((0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.keywordNoSupported'));
            return null;
        }
        const brief = node.text.slice(0, 30);
        return {
            text: node.text,
            brief
        };
    }
    async add(param) {
        let { keyword, pos } = param;
        var _this_reload, _this;
        const text = this.getBriefText(pos);
        if (!text) return;
        const res = await _core_api_books_keywords_upsert_js__WEBPACK_IMPORTED_MODULE_4__.booksKeywordsUpsertRouter.action({
            keywords: [
                {
                    keyword,
                    uuid: null,
                    pos,
                    brief: text.brief,
                    content: text.text
                }
            ],
            uuid: this.uuid
        });
        (_this_reload = (_this = this).reload) === null || _this_reload === void 0 ? void 0 : _this_reload.call(_this);
        void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().info(`${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.keywordUpdated')} ${keyword}`);
        return res.keywords.at(0);
    }
    async upsert(param, param1) {
        let { uuid, keyword, pos } = param, { alias, note, color } = param1;
        var _this_reload, _this;
        const text = this.getBriefText(pos);
        if (!text) return;
        const res = await _core_api_books_keywords_upsert_js__WEBPACK_IMPORTED_MODULE_4__.booksKeywordsUpsertRouter.action({
            keywords: [
                {
                    uuid,
                    keyword,
                    pos,
                    brief: text.brief,
                    content: text.text,
                    alias,
                    note,
                    color
                }
            ],
            uuid: this.uuid
        });
        (_this_reload = (_this = this).reload) === null || _this_reload === void 0 ? void 0 : _this_reload.call(_this);
        void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().info(`${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.keywordUpdated')} ${keyword}`);
        return res.keywords.at(0);
    }
    async remove(keyword) {
        var _this_reload, _this;
        const fgColor = keyword.color ? invert_color__WEBPACK_IMPORTED_MODULE_2___default()(keyword.color, {
            black: '#3a3a3a',
            white: '#fafafa'
        }) : 'var(--main-fg-blue)';
        if (!await (0,_common_confirm_js__WEBPACK_IMPORTED_MODULE_5__.uiConfirm)({
            title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.keywordRemoveConfirm'),
            description: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                style: {
                    backgroundColor: keyword.color ?? 'var(--main-bg-blue)',
                    color: fgColor
                },
                children: keyword.keyword
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-keywords.tsx",
                lineNumber: 112,
                columnNumber: 11
            }, this)
        })) return;
        await _core_api_books_keywords_delete_js__WEBPACK_IMPORTED_MODULE_3__.booksKeywordsDeleteRouter.action({
            uuid: this.uuid,
            keywordUuids: [
                keyword.uuid
            ]
        });
        (_this_reload = (_this = this).reload) === null || _this_reload === void 0 ? void 0 : _this_reload.call(_this);
        void (0,_common_notification_js__WEBPACK_IMPORTED_MODULE_6__.messageApi)().info(`${(0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('desc.keywordDeleted')} ${keyword.keyword}`);
    }
    constructor(player){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "player", void 0);
        /** book uuid */ (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "uuid", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_7__._)(this, "reload", void 0);
        this.player = player;
        this.uuid = player.book.item.uuid;
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player-states.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  PlayerStatesManager: function() { return PlayerStatesManager; },
  usePlayerSync: function() { return usePlayerSync; },
  usePlayerUISync: function() { return usePlayerUISync; }
});
/* harmony import */var _swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_get.js");
/* harmony import */var _swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_class_private_field_init.js");
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/browser.ts");
/* harmony import */var _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/emitter.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");



var _s = $RefreshSig$(), _s1 = $RefreshSig$();



var _states = /*#__PURE__*/ new WeakMap(), _readonlyStates = /*#__PURE__*/ new WeakMap();
class PlayerStatesManager {
    get started() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).started;
    }
    set started(started) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).started = started;
        this.events.fire('started', started);
    }
    get pos() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).pos;
    }
    set pos(pos) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).pos = pos;
        this.events.fire('pos', pos);
    }
    set activeNavs(activeNavs) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).activeNavs = activeNavs;
        this.events.fire('activeNavs', activeNavs);
    }
    get loading() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).loading;
    }
    set loading(loading) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).loading = loading;
        this.events.fire('loading', loading);
    }
    get scrollPercent() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).scrollPercent;
    }
    set scrollPercent(scrollPercent) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).scrollPercent = scrollPercent;
        this.events.fire('scrollPercent', scrollPercent);
    }
    get selection() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).selection;
    }
    set selection(selection) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _states).selection = selection;
        this.events.fire('selection', selection);
    }
    get annotations() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).annotations;
    }
    get keywords() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).keywords;
    }
    get voice() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).voice;
    }
    get isPersonReplace() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).isPersonReplace;
    }
    get speechSpeed() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).speechSpeed;
    }
    get autoNextSection() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).autoNextSection;
    }
    get paragraphRepeat() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).paragraphRepeat;
    }
    get pageList() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).pageList;
    }
    get fontSize() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).fontSize;
    }
    get disabledVertical() {
        return (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates).disabledVertical;
    }
    get docVisible() {
        return document.visibilityState === 'visible';
    }
    get canManipulateDOM() {
        return this.docVisible || !_core_util_browser_js__WEBPACK_IMPORTED_MODULE_1__.isMobile;
    }
    syncUIState(name, state) {
        (0,_swc_helpers_class_private_field_get__WEBPACK_IMPORTED_MODULE_3__._)(this, _readonlyStates)[name] = state;
        this.uiEvents.fire(name, state);
    }
    constructor(){
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_4__._)(this, _states, {
            writable: true,
            value: {
                started: false,
                pos: {
                    section: 0,
                    paragraph: 0
                },
                activeNavs: [],
                loading: false,
                scrollPercent: undefined,
                selection: undefined
            }
        });
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_5__._)(this, "events", new _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_2__.ChangedEmitter());
        (0,_swc_helpers_class_private_field_init__WEBPACK_IMPORTED_MODULE_4__._)(this, _readonlyStates, {
            writable: true,
            value: {
                annotations: [],
                keywords: [],
                isPersonReplace: false,
                speechSpeed: 1,
                voice: null,
                autoNextSection: false,
                paragraphRepeat: 1,
                pageList: 'double',
                fontSize: 16,
                disabledVertical: false
            }
        });
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_5__._)(this, "uiEvents", new _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_2__.ChangedEmitter());
    }
}
function usePlayerSync(player, param) {
    let { setPos, setStarted, setActiveNavs, setLoading, setScrollPercent, setSelection } = param;
    _s();
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        const events = player.states.events;
        const disposes = [
            events.on('pos', (pos)=>{
                setPos(pos);
            }),
            events.on('started', (started)=>{
                setStarted(started);
            }),
            events.on('activeNavs', (activeNavs)=>{
                setActiveNavs(activeNavs);
            }),
            events.on('loading', (loading)=>{
                setLoading(loading);
            }),
            events.on('scrollPercent', (scrollPercent)=>{
                setScrollPercent(scrollPercent);
            }),
            events.on('selection', (selection)=>{
                setSelection(selection);
            })
        ];
        return ()=>{
            disposes.forEach((dispose)=>dispose());
        };
    }, [
        player,
        setPos,
        setStarted,
        setActiveNavs,
        setLoading,
        setScrollPercent,
        setSelection
    ]);
}
_s(usePlayerSync, "OD7bBpZva5O2jO+Puf00hKivP7c=");
function usePlayerUISync(player, param) {
    let { annotations, keywords, isPersonReplace, speechSpeed, voice, autoNextSection, paragraphRepeat, pageList, fontSize, disabledVertical } = param;
    _s1();
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('annotations', annotations);
    }, [
        player,
        annotations
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('keywords', keywords);
    }, [
        player,
        keywords
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('isPersonReplace', isPersonReplace);
    }, [
        player,
        isPersonReplace
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('speechSpeed', speechSpeed);
    }, [
        player,
        speechSpeed
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('voice', voice);
    }, [
        player,
        voice
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('autoNextSection', autoNextSection);
    }, [
        player,
        autoNextSection
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('paragraphRepeat', paragraphRepeat);
    }, [
        player,
        paragraphRepeat
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('pageList', pageList);
    }, [
        player,
        pageList
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('fontSize', fontSize);
    }, [
        player,
        fontSize
    ]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        player.states.syncUIState('disabledVertical', disabledVertical);
    }, [
        player,
        disabledVertical
    ]);
    const isFirstSection = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>player.isFirstSection, [
        player.isFirstSection
    ]);
    const isLastSection = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>player.isLastSection, [
        player.isLastSection
    ]);
    const isFirstParagraph = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>player.isFirstParagraph, [
        player.isFirstParagraph
    ]);
    const isLastParagraph = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>player.isLastParagraph, [
        player.isLastParagraph
    ]);
    return {
        isFirstSection,
        isLastSection,
        isFirstParagraph,
        isLastParagraph
    };
}
_s1(usePlayerUISync, "b9Fv5mhFI4LRiC9Iu/sCCwDFHEs=");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player-ui.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  usePlayerUI: function() { return usePlayerUI; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/popover/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/tag/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/select/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_tmp_store_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/books/tmp-store.ts");
/* harmony import */var _core_util_antd_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/util/antd.tsx");
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/util/browser.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/store.tsx");
/* harmony import */var _layout_settings_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/layout/settings.tsx");
/* harmony import */var _layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/layout/use-app-bar.tsx");
/* harmony import */var _edit_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/web/pages/books/edit.tsx");
/* harmony import */var _view_context_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/web/pages/books/view.context.ts");
/* harmony import */var _book_search_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/web/pages/books/view/book-search.tsx");
/* harmony import */var _panel_panel_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/web/pages/books/view/panel/panel.tsx");
/* harmony import */var _player_states_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/web/pages/books/view/player-states.tsx");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$(), _s4 = $RefreshSig$();



















function ControlButton(props) {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"], {
        style: {
            padding: '14px 4px'
        },
        size: "small",
        type: "primary",
        ...props
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
        lineNumber: 56,
        columnNumber: 5
    }, this);
}
_c = ControlButton;
function TooltipButton(param) {
    let { hotkey, description, ...btnProps } = param;
    _s();
    const tooltip = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_18__["default"], {
            children: [
                description,
                hotkey ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                    className: "keyboard",
                    children: hotkey
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 80,
                    columnNumber: 19
                }, this) : null
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 78,
            columnNumber: 7
        }, this), [
        description,
        hotkey
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_19__["default"], {
        style: {
            pointerEvents: 'none'
        },
        content: _core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile ? null : tooltip,
        placement: "top",
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ControlButton, {
            ...btnProps
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 91,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
        lineNumber: 86,
        columnNumber: 5
    }, this);
}
_s(TooltipButton, "FbPMI835y8nPBSZ6rJ3FjJrw8qs=");
_c1 = TooltipButton;
function TimerRemainBadge(param) {
    let { started, player, stopTimerEnabled, stopTimerSeconds } = param;
    _s1();
    const refUsedSeconds = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)();
    const [resetCount, setResetCount] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(0);
    const [remainSeconds, setRemainSeconds] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(stopTimerSeconds);
    // stop timer
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (!started) return;
        if (!stopTimerEnabled) return;
        if (!resetCount) return setResetCount((c)=>c + 1);
        const usedSeconds = refUsedSeconds.current ?? 0;
        const startAt = Date.now() / 1000;
        let timer = undefined;
        const fn = ()=>{
            const used = Date.now() / 1000 - startAt + usedSeconds;
            refUsedSeconds.current = used;
            const remain = stopTimerSeconds - used;
            if (remain <= 0) {
                player.pause();
                refUsedSeconds.current = 0;
                if (timer) clearInterval(timer);
                setRemainSeconds(0);
                return;
            }
            setRemainSeconds(remain);
        };
        fn();
        timer = setInterval(fn, 1000);
        return ()=>{
            clearInterval(timer);
        };
    }, [
        resetCount,
        player,
        started,
        stopTimerEnabled,
        stopTimerSeconds
    ]);
    const remainDisplay = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return `${Math.floor(remainSeconds / 60).toString().padStart(2, '0')}
      :${(remainSeconds % 60).toFixed(0).padStart(2, '0')}`;
    }, [
        remainSeconds
    ]);
    if (!stopTimerEnabled) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {}, void 0, false);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_20__["default"], {
        onClick: ()=>{
            refUsedSeconds.current = 0;
            setResetCount((c)=>c + 1);
            setRemainSeconds(stopTimerSeconds);
        },
        children: remainDisplay
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
        lineNumber: 151,
        columnNumber: 5
    }, this);
}
_s1(TimerRemainBadge, "XvEZmjClpUq4zIaYg+yF763KAKs=");
_c2 = TimerRemainBadge;
function BookEditButton() {
    _s2();
    const { book, reload } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext)();
    const { openBookEdit } = (0,_edit_js__WEBPACK_IMPORTED_MODULE_11__.useBookEditDialog)(reload);
    const { addHotkey } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_16__.useHotkeys)();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        return addHotkey('e', (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.editBook'), ()=>{
            openBookEdit(book.item.uuid);
        }, {
            level: 100
        });
    }, [
        addHotkey,
        book.item.uuid,
        openBookEdit
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"], {
        block: true,
        type: "primary",
        onClick: ()=>openBookEdit(book.item.uuid),
        children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('editBook')
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
        lineNumber: 180,
        columnNumber: 5
    }, this);
}
_s2(BookEditButton, "twRr8GsbqrxuerlkLoOdsHe6xDA=", false, function() {
    return [
        _view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext,
        _edit_js__WEBPACK_IMPORTED_MODULE_11__.useBookEditDialog,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_16__.useHotkeys
    ];
});
_c3 = BookEditButton;
function VoicesSelect() {
    _s3();
    const { book } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext)();
    const { voiceURI, setVoiceURI, allSortedVoices } = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useVoice)(book.item);
    const voiceOptions = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>allSortedVoices.map((v)=>({
                label: v.name,
                value: v.voiceURI
            })), [
        allSortedVoices
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_layout_settings_js__WEBPACK_IMPORTED_MODULE_9__.SettingLine, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_21__["default"], {
            showSearch: true,
            filterOption: _core_util_antd_js__WEBPACK_IMPORTED_MODULE_4__.filterOptionLabel,
            popupMatchSelectWidth: false,
            style: {
                width: '100%'
            },
            value: voiceURI,
            onChange: (value)=>setVoiceURI(value),
            options: voiceOptions
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 199,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
        lineNumber: 198,
        columnNumber: 5
    }, this);
}
_s3(VoicesSelect, "zAH0jyPC1aqpn9tVDxYuXQiSxHs=", false, function() {
    return [
        _view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useVoice
    ];
});
_c4 = VoicesSelect;
function usePlayerUI(param) {
    let { player, started, activeNavs, selection } = param;
    _s4();
    const { book, pos } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext)();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_22__.useNavigate)();
    const { annotations, keywords, setViewPanelType, BookPanelView } = (0,_panel_panel_js__WEBPACK_IMPORTED_MODULE_14__.useBookPanel)(book, player, activeNavs, pos, selection);
    const { voice } = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useVoice)(book.item);
    const [autoNextSection] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useAutoSection)();
    const [isPersonReplace] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.usePersonReplace)();
    const [stopTimerEnabled] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useStopTimer)();
    const [stopTimerSeconds] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useStopTimerSeconds)();
    const [speechSpeed] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useSpeechSpeed)();
    const [paragraphRepeat] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useParagraphRepeat)();
    const [pageList] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.usePageList)();
    const [fontSize] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useFontSize)();
    const [disabledVertical] = (0,_store_js__WEBPACK_IMPORTED_MODULE_8__.useDisabledVertical)();
    const [collapsed, setCollapsed] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile);
    const { isFirstSection, isLastSection, isFirstParagraph, isLastParagraph } = (0,_player_states_js__WEBPACK_IMPORTED_MODULE_15__.usePlayerUISync)(player, {
        annotations,
        keywords,
        autoNextSection,
        isPersonReplace,
        speechSpeed,
        voice,
        paragraphRepeat,
        pageList,
        fontSize,
        disabledVertical
    });
    const PlayerCtrlGroup = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        const buttons = [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
                hotkey: "t",
                description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('nav'),
                onClick: ()=>{
                    setViewPanelType((v)=>v === 'nav' ? 'none' : 'nav');
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faFolderTree
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 263,
                    columnNumber: 9
                }, this)
            }, "nav", false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 255,
                columnNumber: 7
            }, this),
            annotations && annotations.length > 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
                hotkey: "m",
                description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('annotation'),
                onClick: ()=>{
                    setViewPanelType((v)=>v === 'annotation' ? 'none' : 'annotation');
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faBookBookmark
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 276,
                    columnNumber: 11
                }, this)
            }, "annotations", false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 266,
                columnNumber: 9
            }, this) : null,
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
                description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.annotationToggle'),
                hotkey: "b",
                onClick: ()=>{
                    void player.annotations.toggle(pos, selection ?? null);
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faBookmark
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 287,
                    columnNumber: 9
                }, this)
            }, "annotation", false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 279,
                columnNumber: 7
            }, this),
            keywords && keywords.length > 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
                description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('keyword'),
                hotkey: "M",
                onClick: ()=>{
                    setViewPanelType((v)=>v === 'keyword' ? 'none' : 'keyword');
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faFileLines
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 298,
                    columnNumber: 11
                }, this)
            }, "keywords", false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 290,
                columnNumber: 9
            }, this) : null,
            (selection === null || selection === void 0 ? void 0 : selection.selectedText) ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
                description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.keywordAdd'),
                hotkey: "B",
                onClick: ()=>{
                    void player.keywords.add({
                        pos,
                        keyword: selection.selectedText
                    });
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faQuoteRight
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 310,
                    columnNumber: 11
                }, this)
            }, "keyword", false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 302,
                columnNumber: 9
            }, this) : null
        ];
        if (!collapsed) buttons.push(/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
            hotkey: "shift + ←",
            description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevSection'),
            disabled: isFirstSection,
            onClick: ()=>{
                player.prevSection().catch(console.error);
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faBackwardFast
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 326,
                columnNumber: 11
            }, this)
        }, "prev-section", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 317,
            columnNumber: 9
        }, this), /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
            hotkey: "↑",
            description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevParagraph'),
            disabled: isFirstSection && isFirstParagraph,
            onClick: ()=>{
                player.prevParagraph().catch(console.error);
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faBackward
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 337,
                columnNumber: 11
            }, this)
        }, "prev-paragraph", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 328,
            columnNumber: 9
        }, this));
        buttons.push(/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
            hotkey: "Space",
            description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.playToggle'),
            onClick: ()=>{
                if (started) player.pause();
                else player.start();
            },
            children: started ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faPause
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 351,
                columnNumber: 20
            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faPlay
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 351,
                columnNumber: 46
            }, this)
        }, "play", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 342,
            columnNumber: 7
        }, this));
        if (!collapsed) buttons.push(/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
            hotkey: "↓",
            description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextParagraph'),
            disabled: isLastSection && isLastParagraph,
            onClick: ()=>{
                player.nextParagraph().catch(console.error);
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faForward
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 366,
                columnNumber: 11
            }, this)
        }, "next-paragraph", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 357,
            columnNumber: 9
        }, this), /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TooltipButton, {
            hotkey: "shift + →",
            description: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextSection'),
            disabled: isLastSection,
            onClick: ()=>{
                player.nextSection().catch(console.error);
            },
            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faForwardFast
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 377,
                columnNumber: 11
            }, this)
        }, "next-section", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 368,
            columnNumber: 9
        }, this));
        if (_core_util_browser_js__WEBPACK_IMPORTED_MODULE_5__.isMobile) buttons.push(/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ControlButton, {
            onClick: ()=>{
                setCollapsed((c)=>!c);
            },
            children: collapsed ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faUpRightAndDownLeftFromCenter
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 390,
                columnNumber: 13
            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faDownLeftAndUpRightToCenter
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 392,
                columnNumber: 13
            }, this)
        }, "collapse", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 383,
            columnNumber: 9
        }, this));
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"].Group, {
            children: buttons.filter(Boolean)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 397,
            columnNumber: 12
        }, this);
    }, [
        annotations,
        collapsed,
        isFirstParagraph,
        isFirstSection,
        isLastParagraph,
        isLastSection,
        keywords,
        player,
        pos,
        selection,
        setViewPanelType,
        started
    ]);
    const TimerRemainUI = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TimerRemainBadge, {
            player: player,
            started: started,
            stopTimerEnabled: stopTimerEnabled,
            stopTimerSeconds: stopTimerSeconds
        }, "timer-remain-ui", false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 415,
            columnNumber: 7
        }, this);
    }, [
        player,
        started,
        stopTimerEnabled,
        stopTimerSeconds
    ]);
    const TmpStoreBtn = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"], {
            shape: "circle",
            type: "text",
            title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('tmpStore'),
            onClick: ()=>{
                (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_6__.async)(async ()=>{
                    const entity = await _core_api_books_tmp_store_js__WEBPACK_IMPORTED_MODULE_3__.booksTmpStoreRouter.action({});
                    nav(`/books/added-successful/${entity.uuid}`);
                });
            },
            icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_7__.Icon, {
                icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_23__.faFloppyDisk
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                lineNumber: 437,
                columnNumber: 15
            }, void 0)
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 427,
            columnNumber: 7
        }, this);
    }, [
        nav
    ]);
    const topRight = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
            children: TimerRemainUI
        }, void 0, false);
    }, [
        TimerRemainUI
    ]);
    const bottomLeft = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
            children: PlayerCtrlGroup
        }, void 0, false);
    }, [
        PlayerCtrlGroup
    ]);
    const bottomRight = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
            children: book.item.isTmp && TmpStoreBtn
        }, void 0, false);
    }, [
        TmpStoreBtn,
        book.item.isTmp
    ]);
    const appSettings = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>{
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_18__["default"], {
            direction: "vertical",
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_book_search_js__WEBPACK_IMPORTED_MODULE_13__.BookSearchButton, {
                    player: player
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 457,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(BookEditButton, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 458,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(VoicesSelect, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
                    lineNumber: 459,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/player-ui.tsx",
            lineNumber: 456,
            columnNumber: 7
        }, this);
    }, [
        player
    ]);
    (0,_layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_10__.useAppBarSync)({
        topRight,
        bottomLeft,
        bottomRight,
        settings: appSettings
    });
    return {
        voice,
        speechSpeed,
        autoNextSection,
        isPersonReplace,
        BookPanelView
    };
}
_s4(usePlayerUI, "dT0cwHSHgX+Us0qHapViT8kNpsQ=", false, function() {
    return [
        _view_context_js__WEBPACK_IMPORTED_MODULE_12__.useBookContext,
        react_router_dom__WEBPACK_IMPORTED_MODULE_22__.useNavigate,
        _panel_panel_js__WEBPACK_IMPORTED_MODULE_14__.useBookPanel,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useVoice,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useAutoSection,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.usePersonReplace,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useStopTimer,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useStopTimerSeconds,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useSpeechSpeed,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useParagraphRepeat,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.usePageList,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useFontSize,
        _store_js__WEBPACK_IMPORTED_MODULE_8__.useDisabledVertical,
        _player_states_js__WEBPACK_IMPORTED_MODULE_15__.usePlayerUISync,
        _layout_use_app_bar_js__WEBPACK_IMPORTED_MODULE_10__.useAppBarSync
    ];
});
var _c, _c1, _c2, _c3, _c4;
$RefreshReg$(_c, "ControlButton");
$RefreshReg$(_c1, "TooltipButton");
$RefreshReg$(_c2, "TimerRemainBadge");
$RefreshReg$(_c3, "BookEditButton");
$RefreshReg$(_c4, "VoicesSelect");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/player.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Player: function() { return Player; },
  useCreatePlayer: function() { return useCreatePlayer; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useUnmountEffect/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */var _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/emitter.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _player_annotations_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/pages/books/view/player-annotations.tsx");
/* harmony import */var _player_iframe_controller_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/pages/books/view/player-iframe-controller.ts");
/* harmony import */var _player_states_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/books/view/player-states.tsx");
/* harmony import */var _utterer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/pages/books/view/utterer.ts");
/* harmony import */var _player_keywords_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/pages/books/view/player-keywords.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();









class Player {
    start() {
        this.states.started = true;
        this.utterer.startLoop().catch(console.error);
    }
    pause() {
        this.states.started = false;
        this.utterer.cancel();
    }
    restart(delay) {
        this.pause();
        if (delay) setTimeout(()=>{
            this.start();
        }, delay);
        else this.start();
    }
    toggle() {
        if (this.states.started) this.pause();
        else this.start();
    }
    get isFirstSection() {
        return this.states.pos.section === 0;
    }
    get isLastSection() {
        return this.states.pos.section === this.book.spines.length - 1;
    }
    async gotoPos(param) {
        let { section, paragraph, scrollToParagraph = true, animated = true } = param;
        if (section !== undefined && (section < 0 || section >= this.book.spines.length)) return;
        section ?? (section = this.states.pos.section);
        paragraph ?? (paragraph = this.states.pos.paragraph);
        if (this.states.pos.section === section) {
            // Same section
            if (this.states.pos.paragraph === paragraph) // Skip when same position
            return;
            this.states.pos = {
                section,
                paragraph
            };
            if (scrollToParagraph) await this.iframeCtrler.scrollToCurParagraph(animated);
        } else {
            // Change section
            await this.iframeCtrler.load({
                section,
                paragraph,
                animated
            });
        }
        this.utterer.cancel();
    }
    async gotoSection(section, paragraph) {
        await this.gotoPos({
            section,
            paragraph
        });
    }
    async prevSection() {
        let paragraph = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
        await this.gotoPos({
            section: this.states.pos.section - 1,
            paragraph,
            animated: false
        });
    }
    async nextSection() {
        let paragraph = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
        await this.gotoPos({
            section: this.states.pos.section + 1,
            paragraph,
            animated: false
        });
    }
    async gotoUrlPath(urlPath) {
        await this.iframeCtrler.gotoUrlPath(urlPath);
        this.utterer.cancel();
    }
    get isFirstPage() {
        return this.iframeCtrler.isFirstPageList;
    }
    get isLastPage() {
        return this.iframeCtrler.isLastPageList;
    }
    async gotoPage(pageIndex, jump) {
        await this.iframeCtrler.pageListScrollToPage(pageIndex, jump);
    }
    async prevPage(count, jump) {
        await this.iframeCtrler.pageListPushAdjust(-count, jump);
    }
    async nextPage(count, jump) {
        await this.iframeCtrler.pageListPushAdjust(count, jump);
    }
    get isFirstParagraph() {
        return this.states.pos.paragraph <= 0;
    }
    get isLastParagraph() {
        return this.states.pos.paragraph >= this.iframeCtrler.readableParts.length - 1;
    }
    async gotoParagraph(paragraph) {
        let scrollToParagraph = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
        await this.gotoPos({
            paragraph,
            scrollToParagraph
        });
    }
    async prevParagraph() {
        let scrollToParagraph = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : true;
        if (this.states.pos.paragraph === 0) await this.prevSection(-1);
        else await this.gotoParagraph(this.states.pos.paragraph - 1, scrollToParagraph);
    }
    async nextParagraph() {
        let scrollToParagraph = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : true;
        if (this.states.pos.paragraph >= this.iframeCtrler.readableParts.length - 1) await this.nextSection();
        else await this.gotoParagraph(this.states.pos.paragraph + 1, scrollToParagraph);
    }
    constructor(book, initPos, iframeRef){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "book", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "states", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "utterer", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "iframeCtrler", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "annotations", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "keywords", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_8__._)(this, "unmount", void 0);
        this.book = book;
        this.unmount = new _core_util_emitter_js__WEBPACK_IMPORTED_MODULE_1__.SingleEmitter({
            once: true
        });
        this.states = new _player_states_js__WEBPACK_IMPORTED_MODULE_5__.PlayerStatesManager();
        this.states.pos = initPos;
        this.iframeCtrler = new _player_iframe_controller_js__WEBPACK_IMPORTED_MODULE_4__.PlayerIframeController(this, this.states, iframeRef);
        this.utterer = new _utterer_js__WEBPACK_IMPORTED_MODULE_6__.Utterer(this, this.states, this.iframeCtrler);
        this.annotations = new _player_annotations_js__WEBPACK_IMPORTED_MODULE_3__.PlayerAnnotations(this);
        this.keywords = new _player_keywords_js__WEBPACK_IMPORTED_MODULE_7__.PlayerKeywords(this);
        const onVisibilityChange = ()=>{
            // TODO
            // if (document.visibilityState === 'visible') this.reload()
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_2__.async)(async ()=>{
                // wakeLock
                let lock;
                await (lock === null || lock === void 0 ? void 0 : lock.release().catch(console.error));
                lock = undefined;
                if (this.states.started && this.states.docVisible) {
                    lock = await navigator.wakeLock.request('screen');
                }
            });
        };
        onVisibilityChange();
        document.addEventListener('visibilitychange', onVisibilityChange);
        const startedDispose = this.states.events.on('started', onVisibilityChange);
        this.unmount.on(()=>{
            document.removeEventListener('visibilitychange', onVisibilityChange);
            startedDispose();
        });
    }
}
function useCreatePlayer(book, pos, iframeRef) {
    _s();
    const player = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();
    if (!player.current) {
        player.current = new Player(book, pos, iframeRef);
    }
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useUnmountEffect)(()=>{
        var _player_current;
        (_player_current = player.current) === null || _player_current === void 0 ? void 0 : _player_current.unmount.fire();
    });
    (0,_player_iframe_controller_js__WEBPACK_IMPORTED_MODULE_4__.usePlayerIframe)(player.current);
    return player.current;
}
_s(useCreatePlayer, "gpLaOrtBiPwmSZd0+8wtVylOWFc=", false, function() {
    return [
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_9__.useUnmountEffect,
        _player_iframe_controller_js__WEBPACK_IMPORTED_MODULE_4__.usePlayerIframe
    ];
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/progress-bar.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  ViewProgressBar: function() { return ViewProgressBar; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

function ViewProgressBar(param) {
    let { player, scrollPercent } = param;
    const progress = (scrollPercent === null || scrollPercent === void 0 ? void 0 : scrollPercent.toFixed(2)) ?? '0';
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        style: {
            height: 8,
            width: '100%',
            overflow: 'hidden',
            borderRadius: 8,
            background: 'var(--main-bg-active)'
        },
        onClick: (event)=>{
            const rect = event.currentTarget.getBoundingClientRect();
            const percent = (event.clientX - rect.left) / rect.width;
            player.iframeCtrler.scrollToPercent(percent, true).catch(console.error);
        },
        title: `${progress}%`,
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
            style: {
                transition: 'width 0.2s',
                width: `${progress}%`,
                height: '100%',
                background: 'var(--main-fg-active)'
            }
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/progress-bar.tsx",
            lineNumber: 28,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/progress-bar.tsx",
        lineNumber: 13,
        columnNumber: 5
    }, this);
}
_c = ViewProgressBar;
var _c;
$RefreshReg$(_c, "ViewProgressBar");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/sound.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  nextPagePlay: function() { return nextPagePlay; },
  pressEnterPlay: function() { return pressEnterPlay; },
  rainStart: function() { return rainStart; },
  rainStop: function() { return rainStop; },
  rewindPlay: function() { return rewindPlay; },
  shutterPlay: function() { return shutterPlay; }
});
/* harmony import */var howler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/howler@2.2.4/node_modules/howler/dist/howler.js");
/* harmony import */var _sound_keyboard_mp3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/books/view/sound/keyboard.mp3");
/* harmony import */var _sound_rain_loop_mp3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/pages/books/view/sound/rain-loop.mp3");
/* harmony import */var _sound_next_page_mp3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/pages/books/view/sound/next-page.mp3");
/* harmony import */var _sound_shutter_mp3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/pages/books/view/sound/shutter.mp3");
/* harmony import */var _sound_rewind_mp3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/pages/books/view/sound/rewind.mp3");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");






const shutterSound = new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({
    src: [
        _sound_shutter_mp3__WEBPACK_IMPORTED_MODULE_4__
    ]
});
async function shutterPlay() {
    shutterSound.play();
    await new Promise((resolve)=>{
        shutterSound.once('end', resolve);
    });
}
const pressEnterSound = new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({
    src: [
        _sound_keyboard_mp3__WEBPACK_IMPORTED_MODULE_1__
    ]
});
async function pressEnterPlay() {
    pressEnterSound.play();
    await new Promise((resolve)=>{
        pressEnterSound.once('end', resolve);
    });
}
const nextPageSound = new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({
    src: [
        _sound_next_page_mp3__WEBPACK_IMPORTED_MODULE_3__
    ]
});
async function nextPagePlay() {
    nextPageSound.play();
    await new Promise((resolve)=>{
        nextPageSound.once('end', resolve);
    });
}
const rainSound = new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({
    src: [
        _sound_rain_loop_mp3__WEBPACK_IMPORTED_MODULE_2__
    ]
});
rainSound.loop(true);
rainSound.fade(0, 0.5, 500);
function rainStart() {
    if (!rainSound.playing()) {
        rainSound.play();
    }
}
function rainStop() {
    if (rainSound.playing()) {
        rainSound.pause();
    }
}
const rewindSound = new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({
    src: [
        _sound_rewind_mp3__WEBPACK_IMPORTED_MODULE_5__
    ],
    volume: 0.5
});
async function rewindPlay() {
    rewindSound.play();
    await new Promise((resolve)=>{
        rewindSound.once('end', resolve);
    });
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/utterer.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Utterer: function() { return Utterer; }
});
/* harmony import */var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@swc+helpers@0.5.13/node_modules/@swc/helpers/esm/_define_property.js");
/* harmony import */var _core_util_speech_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/util/speech.ts");
/* harmony import */var _sound_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/pages/books/view/sound.ts");
/* harmony import */var _highlight_utterer_highlight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/pages/books/view/highlight/utterer-highlight.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");




const speakRetriedMax = 3;
class Utterer {
    cancel() {
        this.speech.cancel();
    }
    async speakNode(node) {
        if (!this.states.voice) return 'done';
        return this.speech.speak(node.text, {
            voice: this.states.voice,
            speed: this.states.speechSpeed,
            isPersonReplace: this.states.isPersonReplace,
            alias: this.player.iframeCtrler.alias,
            onBoundary: (event)=>{
                this.hl.highlight([
                    {
                        node,
                        charIndex: event.charIndex,
                        charLength: event.charLength
                    }
                ], true);
            }
        });
    }
    async speakText(text) {
        if (!this.states.voice) return 'done';
        return this.speech.speak(text, {
            voice: this.states.voice,
            speed: this.states.speechSpeed,
            isPersonReplace: this.states.isPersonReplace,
            alias: this.player.iframeCtrler.alias
        });
    }
    async nextPart() {
        // end of section
        if (this.states.pos.paragraph >= this.player.iframeCtrler.readableParts.length - 1) {
            // next section
            if (this.states.pos.section < this.player.book.spines.length - 1 && this.states.autoNextSection) {
                await this.player.nextSection();
                await (0,_sound_js__WEBPACK_IMPORTED_MODULE_1__.nextPagePlay)();
            } else {
                this.player.pause();
            }
        } else {
            // next paragraph
            await this.player.nextParagraph();
            await (0,_sound_js__WEBPACK_IMPORTED_MODULE_1__.pressEnterPlay)();
        }
    }
    async startLoop() {
        let retriedCount = 0;
        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition, no-constant-condition
        while(true){
            if (!this.states.started) return;
            try {
                const node = this.player.iframeCtrler.readableParts.at(this.states.pos.paragraph);
                if (node) {
                    switch(node.type){
                        case 'text':
                            {
                                let isCancel = false;
                                for(let i = 0; i < this.states.paragraphRepeat; i++){
                                    const ret = await this.speakNode(node);
                                    if (ret === 'cancel') {
                                        isCancel = true;
                                        break;
                                    } else if (i !== this.states.paragraphRepeat - 1) {
                                        await (0,_sound_js__WEBPACK_IMPORTED_MODULE_1__.rewindPlay)();
                                    }
                                }
                                // May pause, jumps to other paragraphs, leave page.
                                // Continue is necessary, when the user jumps to other paragraphs
                                if (isCancel) continue;
                                break;
                            }
                        case 'image':
                            {
                                await (0,_sound_js__WEBPACK_IMPORTED_MODULE_1__.shutterPlay)();
                                break;
                            }
                    }
                }
                await this.nextPart();
            } catch (err) {
                console.error(err);
                retriedCount += 1;
                if (retriedCount > speakRetriedMax) {
                    await this.nextPart();
                    retriedCount = 0;
                }
            }
        }
    }
    constructor(player, states, iframeCtrler){
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "player", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "hl", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "states", void 0);
        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, "speech", void 0);
        this.player = player;
        this.states = states;
        this.hl = new _highlight_utterer_highlight_js__WEBPACK_IMPORTED_MODULE_2__.UttererHighlight(iframeCtrler, states);
        this.speech = new _core_util_speech_js__WEBPACK_IMPORTED_MODULE_0__.Speech();
    }
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/books/view/viewer.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useViewer: function() { return useViewer; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useUnmountEffect/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/spin.tsx");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/store.tsx");
/* harmony import */var _theme_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/theme.tsx");
/* harmony import */var _view_context_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/pages/books/view.context.ts");
/* harmony import */var _player_states_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/books/view/player-states.tsx");
/* harmony import */var _player_ui_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/books/view/player-ui.tsx");
/* harmony import */var _player_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/web/pages/books/view/player.tsx");
/* harmony import */var _progress_bar_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/web/pages/books/view/progress-bar.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();














function useViewer() {
    _s();
    const { book, pos, setPos } = (0,_view_context_js__WEBPACK_IMPORTED_MODULE_8__.useBookContext)();
    const iframeRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);
    const [started, setStarted] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [activeNavs, setActiveNavs] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const [scrollPercent, setScrollPercent] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const [selection, setSelection] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__.useHotkeys)();
    const [, setViewPanelType] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useViewPanelType)();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_13__.useNavigate)();
    const player = (0,_player_js__WEBPACK_IMPORTED_MODULE_11__.useCreatePlayer)(book, pos, iframeRef);
    (0,_player_states_js__WEBPACK_IMPORTED_MODULE_9__.usePlayerSync)(player, {
        setPos,
        setStarted,
        setActiveNavs,
        setLoading,
        setScrollPercent,
        setSelection
    });
    // dark scheme
    const theme = (0,_theme_js__WEBPACK_IMPORTED_MODULE_7__.useColorScheme)();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        player.iframeCtrler.updateColorTheme(theme);
    }, [
        player.iframeCtrler,
        theme
    ]);
    const { BookPanelView } = (0,_player_ui_js__WEBPACK_IMPORTED_MODULE_10__.usePlayerUI)({
        player,
        started,
        activeNavs,
        selection
    });
    const MainContent = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(()=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_3__.FlexBox, {
            flex: 1,
            style: {
                position: 'relative'
            },
            children: [
                loading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    style: {
                        position: 'absolute',
                        zIndex: 2,
                        width: '100%',
                        display: 'flex',
                        justifyContent: 'center'
                    },
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_4__.SpinCenter, {}, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/viewer.tsx",
                        lineNumber: 68,
                        columnNumber: 13
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/viewer.tsx",
                    lineNumber: 59,
                    columnNumber: 11
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("iframe", {
                    style: {
                        padding: '0 4px'
                    },
                    title: "viewer",
                    ref: iframeRef
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/viewer.tsx",
                    lineNumber: 72,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_progress_bar_js__WEBPACK_IMPORTED_MODULE_12__.ViewProgressBar, {
                    player: player,
                    scrollPercent: scrollPercent
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/viewer.tsx",
                    lineNumber: 77,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/books/view/viewer.tsx",
            lineNumber: 57,
            columnNumber: 7
        }, this), [
        loading,
        scrollPercent,
        player
    ]);
    // hotkey
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        const jumpPrevPage = ()=>player.prevPage(1, true);
        const jumpNextPage = ()=>player.nextPage(1, true);
        const firstPage = ()=>player.gotoPage(0, true);
        const lastPage = ()=>player.gotoPage(-1, true);
        const prevPage = ()=>player.prevPage(1, false);
        const nextPage = ()=>player.nextPage(1, false);
        const prevSection = ()=>player.prevSection();
        const nextSection = ()=>player.nextSection();
        const firstParagraph = ()=>player.gotoParagraph(0);
        const lastParagraph = ()=>player.gotoParagraph(-1);
        const prevParagraph = ()=>player.prevParagraph();
        const nextParagraph = ()=>player.nextParagraph();
        return addHotkeys([
            // panel
            [
                't',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.navToggle'),
                ()=>setViewPanelType((v)=>v === 'nav' ? 'none' : 'nav')
            ],
            [
                'm',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.annotationsPanelToggle'),
                ()=>setViewPanelType((v)=>v === 'annotation' ? 'none' : 'annotation')
            ],
            [
                'b',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.annotationToggle'),
                ()=>player.annotations.toggle(pos, selection ?? null)
            ],
            [
                {
                    shift: true,
                    key: 'm'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.keywordPanelToggle'),
                ()=>setViewPanelType((v)=>v === 'keyword' ? 'none' : 'keyword')
            ],
            [
                {
                    shift: true,
                    key: 'b'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.keywordAdd'),
                ()=>(selection === null || selection === void 0 ? void 0 : selection.selectedText) && player.keywords.add({
                        pos,
                        keyword: selection.selectedText
                    })
            ],
            // navigation
            [
                'u',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goBack'),
                ()=>nav('../')
            ],
            // play
            [
                ' ',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.playToggle'),
                ()=>player.toggle()
            ],
            [
                {
                    shift: true,
                    key: 'h'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevSection'),
                prevSection
            ],
            [
                {
                    shift: true,
                    key: 'l'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextSection'),
                nextSection
            ],
            [
                {
                    shift: true,
                    key: 'ArrowLeft'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevSection'),
                prevSection
            ],
            [
                {
                    shift: true,
                    key: 'ArrowRight'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextSection'),
                nextSection
            ],
            [
                'h',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.jumpPrevPage'),
                jumpPrevPage
            ],
            [
                'l',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.jumpNextPage'),
                jumpNextPage
            ],
            [
                'k',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevParagraph'),
                prevParagraph
            ],
            [
                'j',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextParagraph'),
                nextParagraph
            ],
            [
                'ArrowLeft',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.jumpPrevPage'),
                jumpPrevPage
            ],
            [
                'ArrowRight',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.jumpNextPage'),
                jumpNextPage
            ],
            [
                'ArrowUp',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevParagraph'),
                prevParagraph
            ],
            [
                'ArrowDown',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextParagraph'),
                nextParagraph
            ],
            [
                'Home',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.firstPage'),
                firstPage
            ],
            [
                'End',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.lastPage'),
                lastPage
            ],
            [
                'PageUp',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.prevPage'),
                prevPage
            ],
            [
                'PageDown',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.nextPage'),
                nextPage
            ],
            [
                [
                    'g',
                    'g'
                ],
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.firstParagraph'),
                firstParagraph
            ],
            [
                {
                    shift: true,
                    key: 'G'
                },
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.lastParagraph'),
                lastParagraph
            ]
        ]);
    }, [
        addHotkeys,
        book,
        nav,
        player,
        pos,
        selection,
        setViewPanelType
    ]);
    // leave
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_14__.useUnmountEffect)(()=>{
        player.pause();
    });
    return {
        activeNavs,
        BookPanelView,
        MainContent
    };
}
_s(useViewer, "b25XaM/2dSy+H0UWatfc5crGa+w=", false, function() {
    return [
        _view_context_js__WEBPACK_IMPORTED_MODULE_8__.useBookContext,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_5__.useHotkeys,
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useViewPanelType,
        react_router_dom__WEBPACK_IMPORTED_MODULE_13__.useNavigate,
        _player_js__WEBPACK_IMPORTED_MODULE_11__.useCreatePlayer,
        _player_states_js__WEBPACK_IMPORTED_MODULE_9__.usePlayerSync,
        _theme_js__WEBPACK_IMPORTED_MODULE_7__.useColorScheme,
        _player_ui_js__WEBPACK_IMPORTED_MODULE_10__.usePlayerUI,
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_14__.useUnmountEffect
    ];
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/entry.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  RootEntry: function() { return RootEntry; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/react-router-dom@6.26.2_react-dom@18.3.1_react@18.3.1/node_modules/react-router-dom/dist/index.js");
/* harmony import */var _core_api_user_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/api/user.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/route/action.ts");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/store.tsx");
/* harmony import */var _books_entry_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/pages/books/entry.tsx");
/* harmony import */var _layout_layout_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/pages/layout/layout.tsx");
/* harmony import */var _login_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/pages/login.tsx");
/* harmony import */var _not_found_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/not-found.tsx");
/* harmony import */var _common_hint_text_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/common/hint-text.tsx");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$();












function Books() {
    _s();
    const { data: user } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_3__.useAction)(_core_api_user_js__WEBPACK_IMPORTED_MODULE_2__.userRouter, null);
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_12__.useNavigate)();
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        if (user && !user.info) {
            nav('/login');
        }
    }, [
        nav,
        user
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_layout_layout_js__WEBPACK_IMPORTED_MODULE_7__.Layout, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_books_entry_js__WEBPACK_IMPORTED_MODULE_6__.BooksEntry, {}, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
            lineNumber: 31,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
        lineNumber: 30,
        columnNumber: 5
    }, this);
}
_s(Books, "XEyq2APkSbiiNUjojmL1KXiVN0U=", false, function() {
    return [
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_3__.useAction,
        react_router_dom__WEBPACK_IMPORTED_MODULE_12__.useNavigate
    ];
});
_c = Books;
function Main() {
    _s1();
    const [, setSpeechSpeed] = (0,_store_js__WEBPACK_IMPORTED_MODULE_5__.useSpeechSpeed)();
    const [, setFontSize] = (0,_store_js__WEBPACK_IMPORTED_MODULE_5__.useFontSize)();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys)();
    const { openHint } = (0,_common_hint_text_js__WEBPACK_IMPORTED_MODULE_10__.useHintText)();
    // hotkey
    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{
        return addHotkeys([
            [
                '[',
                (0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('hotkey.speedDown'),
                ()=>setSpeechSpeed((v)=>{
                        const n = (v * 10 - 1) / 10;
                        openHint(`${(0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('speed')}: ${n}`);
                        return n;
                    })
            ],
            [
                ']',
                (0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('hotkey.speedUp'),
                ()=>setSpeechSpeed((v)=>{
                        const n = (v * 10 + 1) / 10;
                        openHint(`${(0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('speed')}: ${n}`);
                        return n;
                    })
            ],
            [
                '-',
                (0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('hotkey.fontSizeDown'),
                ()=>setFontSize((v)=>{
                        const n = v - 1;
                        openHint(`${(0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('fontSize')}: ${n}`);
                        return n;
                    })
            ],
            [
                '=',
                (0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('hotkey.fontSizeUp'),
                ()=>setFontSize((v)=>{
                        const n = v + 1;
                        openHint(`${(0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('fontSize')}: ${n}`);
                        return n;
                    })
            ],
            [
                'r',
                (0,i18next__WEBPACK_IMPORTED_MODULE_11__.t)('hotkey.reload'),
                ()=>{
                    location.reload();
                }
            ]
        ]);
    }, [
        addHotkeys,
        openHint,
        setFontSize,
        setSpeechSpeed
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Routes, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Route, {
                path: "/login",
                element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_login_js__WEBPACK_IMPORTED_MODULE_8__.Login, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                    lineNumber: 97,
                    columnNumber: 37
                }, void 0)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                lineNumber: 97,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Route, {
                path: "/books/*",
                element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Books, {}, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                    lineNumber: 98,
                    columnNumber: 39
                }, void 0)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                lineNumber: 98,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Route, {
                path: "/",
                element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Navigate, {
                    to: "/books"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                    lineNumber: 99,
                    columnNumber: 32
                }, void 0)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                lineNumber: 99,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Route, {
                path: "*",
                element: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_layout_layout_js__WEBPACK_IMPORTED_MODULE_7__.Layout, {
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_not_found_js__WEBPACK_IMPORTED_MODULE_9__.NotFound, {
                        title: "page"
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                        lineNumber: 104,
                        columnNumber: 13
                    }, void 0)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                    lineNumber: 103,
                    columnNumber: 11
                }, void 0)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
                lineNumber: 100,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
        lineNumber: 96,
        columnNumber: 5
    }, this);
}
_s1(Main, "18NiKUdE9XzbaFl7d5dzA9HOAFU=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_5__.useSpeechSpeed,
        _store_js__WEBPACK_IMPORTED_MODULE_5__.useFontSize,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_4__.useHotkeys,
        _common_hint_text_js__WEBPACK_IMPORTED_MODULE_10__.useHintText
    ];
});
_c1 = Main;
function RootEntry() {
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_router_dom__WEBPACK_IMPORTED_MODULE_13__.HashRouter, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Main, {}, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
            lineNumber: 115,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/entry.tsx",
        lineNumber: 114,
        columnNumber: 5
    }, this);
}
_c2 = RootEntry;
var _c, _c1, _c2;
$RefreshReg$(_c, "Books");
$RefreshReg$(_c1, "Main");
$RefreshReg$(_c2, "RootEntry");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/layout/drag-file.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  DragFile: function() { return DragFile; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/@file-services+path@9.4.1/node_modules/@file-services/path/browser-path.js");
/* harmony import */var _file_services_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_file_services_path__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/books/create-by-url.ts");
/* harmony import */var _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/api/books/create.ts");
/* harmony import */var _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/core/api/books/fetch-url-info.ts");
/* harmony import */var _core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/core/book/book-epub.ts");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _core_lang_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/core/lang.ts");
/* harmony import */var _core_util_converter_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/core/util/converter.ts");
/* harmony import */var _core_util_dom_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/core/util/dom.ts");
/* harmony import */var _core_util_promise_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/core/util/promise.ts");
/* harmony import */var _core_util_url_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/core/util/url.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _components_language_select_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/web/components/language-select.tsx");
/* harmony import */var _components_spin_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./src/web/components/spin.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();




















function hasFileOrUrl(event) {
    const items = filterFileOrUrl(event);
    return !!items.length;
}
function filterFileOrUrl(event) {
    const items = [
        ...event.dataTransfer.items
    ];
    return items.filter((it)=>{
        if (it.kind === 'file') return true;
        if (it.kind === 'string' && it.type === 'text/uri-list') return true;
        return false;
    });
}
function DragFile(param) {
    let { children } = param;
    _s();
    const [dragOver, setDragOver] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(0);
    const [dragItem, setDragItem] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);
    const [isInputLangCode, setIsInputLangCode] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_18__.useNavigate)();
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{
        (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_12__.async)(async ()=>{
            if (!dragItem) return;
            if (!dragItem.langCode) {
                setIsInputLangCode(true);
                return;
            }
            setLoading(true);
            switch(dragItem.type){
                case 'file-epub':
                    await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_5__.booksCreateRouter.action({
                        bufferBase64: dragItem.bufferBase64,
                        langCode: dragItem.langCode,
                        name: dragItem.title,
                        type: 'epub',
                        isTmp: true
                    });
                    break;
                case 'file-text':
                    await _core_api_books_create_js__WEBPACK_IMPORTED_MODULE_5__.booksCreateRouter.action({
                        bufferBase64: dragItem.bufferBase64,
                        langCode: dragItem.langCode,
                        name: dragItem.title,
                        type: 'text',
                        isTmp: true
                    });
                    break;
                case 'url':
                    await _core_api_books_create_by_url_js__WEBPACK_IMPORTED_MODULE_4__.booksCreateByUrlRouter.action({
                        url: dragItem.url,
                        langCode: dragItem.langCode,
                        name: dragItem.title,
                        isTmp: true
                    });
                    break;
            }
            setLoading(false);
            setDragItem(null);
            nav(`/books/view/${_core_consts_js__WEBPACK_IMPORTED_MODULE_8__.TMP_UUID}`);
        });
    }, [
        dragItem,
        nav
    ]);
    if (loading) return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_spin_js__WEBPACK_IMPORTED_MODULE_17__.SpinFullscreen, {}, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
        lineNumber: 109,
        columnNumber: 23
    }, this);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_14__.FlexBox, {
        style: {
            width: '100%',
            height: '100%',
            position: 'relative'
        },
        gap: 0,
        onDragEnter: (event)=>{
            if (!hasFileOrUrl(event)) return;
            setDragOver((c)=>c + 1);
        },
        onDragLeave: (event)=>{
            if (!hasFileOrUrl(event)) return;
            setDragOver((c)=>c - 1);
        },
        onDragOver: (event)=>{
            (0,_core_util_dom_js__WEBPACK_IMPORTED_MODULE_11__.eventBan)(event);
        },
        onDrop: (event)=>{
            event.preventDefault();
            (0,_core_util_promise_js__WEBPACK_IMPORTED_MODULE_12__.async)(async ()=>{
                setDragOver(0);
                setLoading(true);
                try {
                    for (const item of filterFileOrUrl(event)){
                        if (item.kind === 'file') {
                            const file = item.getAsFile();
                            if (!file) continue;
                            const buf = await file.arrayBuffer();
                            const epub = await _core_book_book_epub_js__WEBPACK_IMPORTED_MODULE_7__.BookEpub.read(buf);
                            if (!epub) continue;
                            const langCode = (0,_core_lang_js__WEBPACK_IMPORTED_MODULE_9__.parseLangCode)(epub.language);
                            const ext = _file_services_path__WEBPACK_IMPORTED_MODULE_2___default().extname(file.name);
                            const basename = _file_services_path__WEBPACK_IMPORTED_MODULE_2___default().basename(file.name, ext);
                            const bufferBase64 = (0,_core_util_converter_js__WEBPACK_IMPORTED_MODULE_10__.arrayBufferToBase64)(buf);
                            if (ext === '.epub') return setDragItem({
                                bufferBase64,
                                title: epub.title ?? basename,
                                type: 'file-epub',
                                langCode
                            });
                            else if (ext === '.txt' || ext === '.text') return setDragItem({
                                bufferBase64,
                                title: basename,
                                type: 'file-text',
                                langCode
                            });
                        } else if (item.kind === 'string') {
                            const url = await new Promise((resolve)=>{
                                item.getAsString(resolve);
                            });
                            if (!(0,_core_util_url_js__WEBPACK_IMPORTED_MODULE_13__.isUrl)(url)) continue;
                            const info = await _core_api_books_fetch_url_info_js__WEBPACK_IMPORTED_MODULE_6__.booksFetchUrlInfoRouter.action({
                                url
                            });
                            return setDragItem({
                                type: 'url',
                                url,
                                title: info.title,
                                langCode: info.lang
                            });
                        }
                    }
                } finally{
                    setLoading(false);
                }
            });
        },
        children: [
            !!dragOver && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_14__.FlexBox, {
                style: {
                    width: '100%',
                    height: '100%',
                    position: 'absolute',
                    justifyContent: 'center',
                    alignItems: 'center',
                    zIndex: 1,
                    backgroundColor: 'var(--main-bg)'
                },
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.dropHere')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                lineNumber: 182,
                columnNumber: 9
            }, this),
            isInputLangCode && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                style: {
                    width: '100%',
                    height: '100%',
                    position: 'absolute',
                    zIndex: 2,
                    backgroundColor: 'var(--main-bg)',
                    padding: 40
                },
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_14__.FlexBox, {
                        dir: "row",
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_19__["default"], {
                                style: {
                                    flex: 1
                                },
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.selectLanguage')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                                lineNumber: 208,
                                columnNumber: 13
                            }, this),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_20__["default"], {
                                shape: "circle",
                                type: "text",
                                onClick: ()=>{
                                    setDragItem(null);
                                    setIsInputLangCode(false);
                                },
                                icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_15__.Icon, {
                                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_21__.faClose
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                                    lineNumber: 218,
                                    columnNumber: 21
                                }, void 0)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                                lineNumber: 211,
                                columnNumber: 13
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                        lineNumber: 207,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_22__["default"].Item, {
                        label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('language'),
                        name: "langCode",
                        required: true,
                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_language_select_js__WEBPACK_IMPORTED_MODULE_16__.LanguageSelect, {
                            onChange: (value)=>{
                                if (!dragItem || !value) return;
                                setDragItem({
                                    ...dragItem,
                                    langCode: value
                                });
                                setIsInputLangCode(false);
                            }
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                            lineNumber: 222,
                            columnNumber: 13
                        }, this)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                        lineNumber: 221,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
                lineNumber: 197,
                columnNumber: 9
            }, this),
            children
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/drag-file.tsx",
        lineNumber: 112,
        columnNumber: 5
    }, this);
}
_s(DragFile, "mwgWK7MNwsw1MmZGtf+sDcWx8jQ=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_18__.useNavigate
    ];
});
_c = DragFile;
var _c;
$RefreshReg$(_c, "DragFile");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/layout/layout.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Layout: function() { return Layout; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/modal/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/drawer/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_logout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/logout.ts");
/* harmony import */var _core_env_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/env.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _components_link_wrap_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/web/components/link-wrap.tsx");
/* harmony import */var _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/web/hooks/use-title.tsx");
/* harmony import */var _drag_file_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/web/pages/layout/drag-file.tsx");
/* harmony import */var _layout_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/web/pages/layout/layout.module.scss?68dd");
/* harmony import */var _settings_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/web/pages/layout/settings.tsx");
/* harmony import */var _use_app_bar_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/web/pages/layout/use-app-bar.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();
















const Layout = (param)=>{
    let { children } = param;
    _s();
    const title = (0,_hooks_use_title_js__WEBPACK_IMPORTED_MODULE_8__.useTitle)() ?? _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_8__.defaultTitle;
    const [appBarStates] = (0,jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom)(_use_app_bar_js__WEBPACK_IMPORTED_MODULE_12__.appBarStatesAtom);
    const [showSettings, setShowSettings] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_14__.useNavigate)();
    const [openedBookTitle, setOpenedBookTitle] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);
    const appBar = /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
        className: [
            _layout_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].appBar,
            'top'
        ].join(' '),
        dir: "row",
        style: {
            justifyContent: 'end'
        },
        gap: 4,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                dir: "row",
                style: {
                    overflow: 'hidden',
                    alignItems: 'center'
                },
                gap: 4,
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_link_wrap_js__WEBPACK_IMPORTED_MODULE_7__.LinkWrap, {
                        to: "/books",
                        children: (href)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_15__["default"], {
                                type: "link",
                                size: "small",
                                href: href,
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_6__.Icon, {
                                    size: "2xl",
                                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_16__.faBook
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                    lineNumber: 45,
                                    columnNumber: 15
                                }, undefined)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                lineNumber: 44,
                                columnNumber: 13
                            }, undefined)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                        lineNumber: 42,
                        columnNumber: 9
                    }, undefined),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"], {
                        style: {
                            flex: 1,
                            whiteSpace: 'nowrap',
                            overflow: 'hidden',
                            textOverflow: 'ellipsis',
                            cursor: 'pointer'
                        },
                        title: title,
                        onClick: ()=>{
                            setOpenedBookTitle(true);
                        },
                        children: title
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                        lineNumber: 49,
                        columnNumber: 9
                    }, undefined),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_18__["default"], {
                        title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('bookName'),
                        open: openedBookTitle,
                        footer: false,
                        onCancel: ()=>setOpenedBookTitle(false),
                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_17__["default"], {
                            children: title
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                            lineNumber: 70,
                            columnNumber: 11
                        }, undefined)
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                        lineNumber: 64,
                        columnNumber: 9
                    }, undefined)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                lineNumber: 34,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                dir: "row",
                style: {
                    alignItems: 'center',
                    flex: 1
                },
                gap: 4,
                children: appBarStates.topLeft
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                lineNumber: 73,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                dir: "row",
                style: {
                    alignItems: 'center'
                },
                gap: 4,
                children: appBarStates.topRight
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                lineNumber: 76,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
        lineNumber: 26,
        columnNumber: 5
    }, undefined);
    const appBarBottom = /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
        className: [
            _layout_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].appBar,
            'bottom'
        ].join(' '),
        dir: "row",
        style: {
            flexWrap: 'wrap',
            justifyContent: 'end'
        },
        gap: 4,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                dir: "row",
                style: {
                    alignItems: 'center',
                    flex: 1
                },
                gap: 4,
                children: appBarStates.bottomLeft
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                lineNumber: 92,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                dir: "row",
                style: {
                    alignItems: 'center'
                },
                gap: 4,
                children: [
                    appBarStates.bottomRight,
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                        dir: "row",
                        style: {
                            alignItems: 'center'
                        },
                        gap: 4,
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_15__["default"], {
                                shape: "circle",
                                type: "text",
                                onClick: ()=>{
                                    setShowSettings((v)=>!v);
                                },
                                icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_6__.Icon, {
                                    icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_16__.faGear
                                }, void 0, false, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                    lineNumber: 111,
                                    columnNumber: 19
                                }, void 0)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                lineNumber: 105,
                                columnNumber: 11
                            }, undefined),
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_19__["default"], {
                                placement: "right",
                                open: showSettings,
                                onClose: ()=>setShowSettings(false),
                                title: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.title'),
                                forceRender: true,
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                                    style: {
                                        flex: 1,
                                        minWidth: 300,
                                        gap: 6
                                    },
                                    children: [
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                                            style: {
                                                flex: 1,
                                                gap: 6
                                            },
                                            children: [
                                                appBarStates.settings,
                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_settings_js__WEBPACK_IMPORTED_MODULE_11__.GlobalSettings, {}, void 0, false, {
                                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                                    lineNumber: 123,
                                                    columnNumber: 17
                                                }, undefined)
                                            ]
                                        }, void 0, true, {
                                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                            lineNumber: 121,
                                            columnNumber: 15
                                        }, undefined),
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
                                            children: _core_env_js__WEBPACK_IMPORTED_MODULE_4__.env.appMode === 'server' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_settings_js__WEBPACK_IMPORTED_MODULE_11__.SettingLine, {
                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_15__["default"], {
                                                    type: "primary",
                                                    block: true,
                                                    onClick: ()=>{
                                                        _core_api_logout_js__WEBPACK_IMPORTED_MODULE_3__.logoutRouter.action().then(()=>{
                                                            nav('/');
                                                        }).catch(console.error);
                                                    },
                                                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('logout')
                                                }, void 0, false, {
                                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                                    lineNumber: 128,
                                                    columnNumber: 21
                                                }, undefined)
                                            }, void 0, false, {
                                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                                lineNumber: 127,
                                                columnNumber: 19
                                            }, undefined)
                                        }, void 0, false, {
                                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                            lineNumber: 125,
                                            columnNumber: 15
                                        }, undefined)
                                    ]
                                }, void 0, true, {
                                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                    lineNumber: 120,
                                    columnNumber: 13
                                }, undefined)
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                                lineNumber: 113,
                                columnNumber: 11
                            }, undefined)
                        ]
                    }, void 0, true, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                        lineNumber: 104,
                        columnNumber: 9
                    }, undefined)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                lineNumber: 102,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
        lineNumber: 83,
        columnNumber: 5
    }, undefined);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_drag_file_js__WEBPACK_IMPORTED_MODULE_9__.DragFile, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_5__.FlexBox, {
            style: {
                width: '100%',
                height: '100%',
                alignContent: 'space-around',
                justifyContent: 'space-around'
            },
            children: [
                appBar,
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    style: {
                        flex: 1,
                        padding: 8,
                        overflow: 'hidden',
                        overflowY: 'auto'
                    },
                    children: children
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
                    lineNumber: 163,
                    columnNumber: 9
                }, undefined),
                appBarBottom
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
            lineNumber: 154,
            columnNumber: 7
        }, undefined)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/layout.tsx",
        lineNumber: 153,
        columnNumber: 5
    }, undefined);
};
_s(Layout, "m/WfOnTm0+nnPN8GV7ApMB4V8x4=", false, function() {
    return [
        _hooks_use_title_js__WEBPACK_IMPORTED_MODULE_8__.useTitle,
        jotai__WEBPACK_IMPORTED_MODULE_13__.useAtom,
        react_router_dom__WEBPACK_IMPORTED_MODULE_14__.useNavigate
    ];
});
_c = Layout;
var _c;
$RefreshReg$(_c, "Layout");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/layout/settings.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  GlobalSettings: function() { return GlobalSettings; },
  SettingLabel: function() { return SettingLabel; },
  SettingLine: function() { return SettingLine; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./node_modules/.pnpm/@fortawesome+free-solid-svg-icons@6.6.0/node_modules/@fortawesome/free-solid-svg-icons/index.mjs");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/typography/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/checkbox/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/popover/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/list/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/space/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/slider/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/radio/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/core/consts.ts");
/* harmony import */var _components_flex_box_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/components/flex-box.tsx");
/* harmony import */var _components_icon_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/web/components/icon.tsx");
/* harmony import */var _components_input_number_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/web/components/input-number.tsx");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/web/store.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$(), _s3 = $RefreshSig$(), _s4 = $RefreshSig$(), _s5 = $RefreshSig$(), _s6 = $RefreshSig$(), _s7 = $RefreshSig$(), _s8 = $RefreshSig$();








function SettingLine(param) {
    let { children } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_3__.FlexBox, {
        dir: "row",
        gap: 8,
        style: {
            alignItems: 'center',
            width: '100%'
        },
        children: children
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 30,
        columnNumber: 5
    }, this);
}
_c = SettingLine;
function SettingLabel(param) {
    let { style, children } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"], {
        style: {
            alignSelf: 'start',
            ...style
        },
        children: children
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 51,
        columnNumber: 5
    }, this);
}
_c1 = SettingLabel;
const AutoSectionCheckBox = ()=>{
    _s();
    const [autoNextSection, setAutoNextSection] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useAutoSection)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
            checked: autoNextSection,
            onChange: (e)=>setAutoNextSection(e.target.checked),
            children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.autoNextSection')
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
            lineNumber: 59,
            columnNumber: 7
        }, undefined)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 58,
        columnNumber: 5
    }, undefined);
};
_s(AutoSectionCheckBox, "OvqdwExVt+v8gBXzsAuVWm2j4lc=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useAutoSection
    ];
});
_c2 = AutoSectionCheckBox;
const TimerInput = ()=>{
    _s1();
    const [stopTimerEnabled, setStopTimerEnabled] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useStopTimer)();
    const [stopTimerSeconds, setStopTimerSeconds] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useStopTimerSeconds)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
                checked: stopTimerEnabled,
                onChange: (e)=>{
                    setStopTimerEnabled(e.target.checked);
                },
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.timer')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 74,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_input_number_js__WEBPACK_IMPORTED_MODULE_5__.RInputNumber, {
                style: {
                    width: '80px'
                },
                disabled: !stopTimerEnabled,
                value: Math.floor(stopTimerSeconds / 60),
                onChange: (v)=>{
                    if (v === null) return;
                    setStopTimerSeconds(Math.floor(v * 60));
                }
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 82,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 73,
        columnNumber: 5
    }, undefined);
};
_s1(TimerInput, "ON3C/Dsyc7aA8u/rAXb5ENkTWAk=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useStopTimer,
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useStopTimerSeconds
    ];
});
_c3 = TimerInput;
function PersonReplaceCheckBox(param) {
    let { checked, onChange } = param;
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
                checked: checked,
                onChange: (e)=>{
                    onChange(e.target.checked);
                },
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.personReplace')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 104,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
                style: {
                    pointerEvents: 'none'
                },
                content: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"], {
                    children: Object.entries(_core_consts_js__WEBPACK_IMPORTED_MODULE_2__.ZH_PERSON_RULES).map((param, idx)=>{
                        let [from, to] = param;
                        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_10__["default"].Item, {
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                                children: [
                                    from,
                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_4__.Icon, {
                                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_12__.faArrowRight
                                    }, void 0, false, {
                                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                                        lineNumber: 121,
                                        columnNumber: 21
                                    }, void 0),
                                    to.word,
                                    " (",
                                    to.pinyin,
                                    ")"
                                ]
                            }, void 0, true, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                                lineNumber: 119,
                                columnNumber: 19
                            }, void 0)
                        }, idx, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                            lineNumber: 118,
                            columnNumber: 17
                        }, void 0);
                    })
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                    lineNumber: 115,
                    columnNumber: 11
                }, void 0),
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_icon_js__WEBPACK_IMPORTED_MODULE_4__.Icon, {
                        size: "lg",
                        icon: _fortawesome_free_solid_svg_icons__WEBPACK_IMPORTED_MODULE_12__.faQuestionCircle
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                        lineNumber: 131,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                    lineNumber: 130,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 112,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true);
}
_c4 = PersonReplaceCheckBox;
const PersonReplaceUI = ()=>{
    _s2();
    const [isPersonReplace, setIsPersonReplace] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.usePersonReplace)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(PersonReplaceCheckBox, {
            checked: isPersonReplace,
            onChange: (v)=>{
                setIsPersonReplace(v);
            }
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
            lineNumber: 143,
            columnNumber: 7
        }, undefined)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 142,
        columnNumber: 5
    }, undefined);
};
_s2(PersonReplaceUI, "qiquZmh+ZPXHMGchSWdOvOj7toc=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.usePersonReplace
    ];
});
_c5 = PersonReplaceUI;
function DisabledVerticalCheckbox() {
    _s3();
    const [disabledVertical, setDisabledVertical] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useDisabledVertical)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
            checked: disabledVertical,
            onChange: (e)=>{
                setDisabledVertical(e.target.checked);
            },
            children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.disabledVertical')
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
            lineNumber: 157,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 156,
        columnNumber: 5
    }, this);
}
_s3(DisabledVerticalCheckbox, "JHpnfhZIGHtIHKPfNVBZtnUYvjI=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useDisabledVertical
    ];
});
_c6 = DisabledVerticalCheckbox;
const PlaySpeed = ()=>{
    _s4();
    const [speechSpeed, setSpeechSpeed] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useSpeechSpeed)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLabel, {
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.speed')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 173,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_flex_box_js__WEBPACK_IMPORTED_MODULE_3__.FlexBox, {
                style: {
                    flex: 1
                },
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_13__["default"], {
                        value: speechSpeed,
                        onChange: (v)=>{
                            setSpeechSpeed(v);
                        },
                        step: 0.1,
                        min: 0.1,
                        max: 5.0
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                        lineNumber: 175,
                        columnNumber: 9
                    }, undefined),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_input_number_js__WEBPACK_IMPORTED_MODULE_5__.RInputNumber, {
                        type: "number",
                        value: speechSpeed,
                        step: 0.1,
                        onChange: (v)=>{
                            if (v === null) return;
                            setSpeechSpeed(v);
                        }
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                        lineNumber: 184,
                        columnNumber: 9
                    }, undefined)
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 174,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 172,
        columnNumber: 5
    }, undefined);
};
_s4(PlaySpeed, "JWHiZNjFXgr0iDTPo1O8X9ETF7A=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useSpeechSpeed
    ];
});
_c7 = PlaySpeed;
const ColorSchemeSelect = ()=>{
    _s5();
    const [userColorScheme, setUserColorScheme] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useUserColorScheme)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLabel, {
                    style: {
                        paddingTop: '4px'
                    },
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.userColorScheme')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                    lineNumber: 203,
                    columnNumber: 9
                }, undefined),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_14__["default"].Group, {
                    value: userColorScheme,
                    onChange: (e)=>{
                        setUserColorScheme(e.target.value);
                    },
                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                        direction: "vertical",
                        children: _store_js__WEBPACK_IMPORTED_MODULE_6__.USER_COLOR_SCHEMES.map((value)=>{
                            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_14__["default"], {
                                value: value,
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)(value)
                            }, value, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                                lineNumber: 215,
                                columnNumber: 17
                            }, undefined);
                        })
                    }, void 0, false, {
                        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                        lineNumber: 212,
                        columnNumber: 11
                    }, undefined)
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                    lineNumber: 206,
                    columnNumber: 9
                }, undefined)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
            lineNumber: 202,
            columnNumber: 7
        }, undefined)
    }, void 0, false);
};
_s5(ColorSchemeSelect, "YafItn0kIHZgQFSbf1QTmKwBIJg=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useUserColorScheme
    ];
});
_c8 = ColorSchemeSelect;
const ParagraphRepeatInput = ()=>{
    _s6();
    const [paragraphRepeat, setParagraphRepeat] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useParagraphRepeat)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                children: [
                    (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.paragraphRepeat'),
                    ":"
                ]
            }, void 0, true, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 231,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_input_number_js__WEBPACK_IMPORTED_MODULE_5__.RInputNumber, {
                style: {
                    width: 80
                },
                value: paragraphRepeat,
                onChange: (v)=>{
                    if (!v) return;
                    setParagraphRepeat(v < 1 ? 1 : Math.floor(v));
                }
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 232,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 230,
        columnNumber: 5
    }, undefined);
};
_s6(ParagraphRepeatInput, "pUTPg4T0W9Qhlhd21wfhqxRaqMA=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useParagraphRepeat
    ];
});
_c9 = ParagraphRepeatInput;
function PageListCheckBox() {
    _s7();
    const [pageList, setPageList] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.usePageList)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLabel, {
                style: {
                    paddingTop: '4px'
                },
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.pageList')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 248,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_14__["default"].Group, {
                value: pageList,
                onChange: (e)=>{
                    setPageList(e.target.value);
                },
                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
                    direction: "vertical",
                    children: _store_js__WEBPACK_IMPORTED_MODULE_6__.SPLIT_PAGE_TYPES.map((value)=>{
                        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_14__["default"], {
                            value: value,
                            children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)(`setting.pageListType.${value}`)
                        }, value, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                            lineNumber: 260,
                            columnNumber: 15
                        }, this);
                    })
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                    lineNumber: 257,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 251,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 247,
        columnNumber: 5
    }, this);
}
_s7(PageListCheckBox, "1KyhCNXQpjpCpJ31lGgqMu4ZjuQ=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.usePageList
    ];
});
_c10 = PageListCheckBox;
function FontSizeInput() {
    _s8();
    const [fontSize, setFontSize] = (0,_store_js__WEBPACK_IMPORTED_MODULE_6__.useFontSize)();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingLine, {
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("span", {
                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('setting.fontSize')
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 275,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_input_number_js__WEBPACK_IMPORTED_MODULE_5__.RInputNumber, {
                style: {
                    width: 80
                },
                value: fontSize,
                onChange: (v)=>{
                    if (v === null) return;
                    setFontSize(v < 1 ? 1 : Math.floor(v));
                }
            }, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 276,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 274,
        columnNumber: 5
    }, this);
}
_s8(FontSizeInput, "LhVv2BlDpjae2Kzh5bhkIfT1yYI=", false, function() {
    return [
        _store_js__WEBPACK_IMPORTED_MODULE_6__.useFontSize
    ];
});
_c11 = FontSizeInput;
const GlobalSettings = ()=>{
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_11__["default"], {
        direction: "vertical",
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AutoSectionCheckBox, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 291,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(TimerInput, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 292,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(PersonReplaceUI, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 293,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(DisabledVerticalCheckbox, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 294,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(PlaySpeed, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 295,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ColorSchemeSelect, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 296,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ParagraphRepeatInput, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 297,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(PageListCheckBox, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 298,
                columnNumber: 7
            }, undefined),
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(FontSizeInput, {}, void 0, false, {
                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
                lineNumber: 299,
                columnNumber: 7
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/layout/settings.tsx",
        lineNumber: 290,
        columnNumber: 5
    }, undefined);
};
_c12 = GlobalSettings;
var _c, _c1, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12;
$RefreshReg$(_c, "SettingLine");
$RefreshReg$(_c1, "SettingLabel");
$RefreshReg$(_c2, "AutoSectionCheckBox");
$RefreshReg$(_c3, "TimerInput");
$RefreshReg$(_c4, "PersonReplaceCheckBox");
$RefreshReg$(_c5, "PersonReplaceUI");
$RefreshReg$(_c6, "DisabledVerticalCheckbox");
$RefreshReg$(_c7, "PlaySpeed");
$RefreshReg$(_c8, "ColorSchemeSelect");
$RefreshReg$(_c9, "ParagraphRepeatInput");
$RefreshReg$(_c10, "PageListCheckBox");
$RefreshReg$(_c11, "FontSizeInput");
$RefreshReg$(_c12, "GlobalSettings");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/layout/use-app-bar.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  appBarStatesAtom: function() { return appBarStatesAtom; },
  useAppBarSync: function() { return useAppBarSync; }
});
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useUnmountEffect/index.js");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
var _s = $RefreshSig$();



const appBarStatesAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_1__.atom)({
    topLeft: null,
    topRight: null,
    settings: null,
    bottomLeft: null,
    bottomRight: null
});
const useAppBarSync = (param)=>{
    let { topLeft, topRight, settings, bottomLeft, bottomRight } = param;
    _s();
    const [, setAppBarStates] = (0,jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom)(appBarStatesAtom);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{
        setAppBarStates({
            topLeft,
            topRight,
            settings,
            bottomLeft,
            bottomRight
        });
    }, [
        topLeft,
        topRight,
        settings,
        bottomLeft,
        bottomRight,
        setAppBarStates
    ]);
    (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_3__.useUnmountEffect)(()=>{
        setAppBarStates({
            topLeft: null,
            topRight: null,
            settings: null,
            bottomLeft: null,
            bottomRight: null
        });
    });
};
_s(useAppBarSync, "H2rN3dW8Y1J5BKPVWurEI83JlVU=", false, function() {
    return [
        jotai__WEBPACK_IMPORTED_MODULE_2__.useAtom,
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_3__.useUnmountEffect
    ];
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/login.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Login: function() { return Login; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/form/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/input/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/button/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _core_api_login_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/api/login.ts");
/* harmony import */var _core_api_user_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/core/api/user.ts");
/* harmony import */var _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/core/route/action.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();







function Login() {
    _s();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_6__.useNavigate)();
    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();
    const { data: user } = (0,_core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction)(_core_api_user_js__WEBPACK_IMPORTED_MODULE_4__.userRouter, null);
    const [form] = antd__WEBPACK_IMPORTED_MODULE_7__["default"].useForm();
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        if (user) {
            if (user.info) {
                nav('/');
            }
        }
    }, [
        nav,
        user
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
            style: {
                maxWidth: 300,
                margin: '50px auto 0'
            },
            children: [
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("h2", {
                    children: "Auditory Reader"
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                    lineNumber: 31,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("h4", {
                    children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('login')
                }, void 0, false, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                    lineNumber: 32,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"], {
                    form: form,
                    initialValues: {
                        account: '',
                        password: ''
                    },
                    onFinish: (values)=>{
                        _core_api_login_js__WEBPACK_IMPORTED_MODULE_3__.loginRouter.action(values).then(async (res)=>{
                            if (res.ok) {
                                nav('/');
                            } else {
                                setError((0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('error.login'));
                            }
                        }).catch(console.error);
                    },
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('account'),
                            name: "account",
                            rules: [
                                {
                                    required: true
                                }
                            ],
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
                                placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputAccount')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                                lineNumber: 55,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                            lineNumber: 50,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"].Item, {
                            label: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('password'),
                            name: "password",
                            rules: [
                                {
                                    required: true
                                }
                            ],
                            validateStatus: error ? 'error' : undefined,
                            help: error,
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_8__["default"], {
                                type: "password",
                                placeholder: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('prompt.inputPassword')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                                lineNumber: 64,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                            lineNumber: 57,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_7__["default"].Item, {
                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_9__["default"], {
                                type: "primary",
                                block: true,
                                htmlType: "submit",
                                children: (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('submit')
                            }, void 0, false, {
                                fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                                lineNumber: 70,
                                columnNumber: 13
                            }, this)
                        }, void 0, false, {
                            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                            lineNumber: 69,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
                    lineNumber: 34,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/login.tsx",
            lineNumber: 30,
            columnNumber: 7
        }, this)
    }, void 0, false);
}
_s(Login, "1VCqHYrkx4g7tXbV3Mu4zBVuExM=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_6__.useNavigate,
        _core_route_action_js__WEBPACK_IMPORTED_MODULE_5__.useAction,
        antd__WEBPACK_IMPORTED_MODULE_7__["default"].useForm
    ];
});
_c = Login;
var _c;
$RefreshReg$(_c, "Login");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/pages/not-found.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  NotFound: function() { return NotFound; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/alert/index.js");
/* harmony import */var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./node_modules/.pnpm/i18next@23.15.1/node_modules/i18next/dist/esm/i18next.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */var react_router_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/react-router@6.26.2_react@18.3.1/node_modules/react-router/dist/index.js");
/* harmony import */var _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/web/hotkey/hotkey-state.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();





function NotFound(param) {
    let { title } = param;
    _s();
    const nav = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_4__.useNavigate)();
    const { addHotkeys } = (0,_hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_3__.useHotkeys)();
    // hotkey
    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{
        return addHotkeys([
            [
                'u',
                (0,i18next__WEBPACK_IMPORTED_MODULE_1__.t)('hotkey.goBack'),
                ()=>nav('../../')
            ]
        ]);
    }, [
        addHotkeys,
        nav
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_5__["default"], {
        type: "error",
        message: `The ${title} not found`,
        description: `The ${title} not found`
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/pages/not-found.tsx",
        lineNumber: 17,
        columnNumber: 5
    }, this);
}
_s(NotFound, "15LeuoYWXo6ceMDCWM8cljAla5U=", false, function() {
    return [
        react_router_dom__WEBPACK_IMPORTED_MODULE_4__.useNavigate,
        _hotkey_hotkey_state_js__WEBPACK_IMPORTED_MODULE_3__.useHotkeys
    ];
});
_c = NotFound;
var _c;
$RefreshReg$(_c, "NotFound");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/service-worker/register.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  registerAPI: function() { return registerAPI; }
});
/* harmony import */var _core_env_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/env.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

async function unregister() {
    if (!('serviceWorker' in navigator)) return;
    const registrations = await navigator.serviceWorker.getRegistrations();
    for (const registration of registrations){
        await registration.unregister();
    }
}
async function registerAPI() {
    if (_core_env_js__WEBPACK_IMPORTED_MODULE_0__.env.appMode === 'server') {
        await unregister();
        return 'successful';
    }
    if (!('serviceWorker' in navigator)) {
        // eslint-disable-next-line no-console
        console.log('service-worker: unsupported');
        return 'unsupported';
    }
    await unregister();
    const service = await navigator.serviceWorker.register(new URL(/* worker import */__webpack_require__.p + __webpack_require__.u("src_web_service-worker_api_ts"), __webpack_require__.b), Object.assign({}, {
        scope: env.appPublicRoot
    }, { type: undefined }));
    await navigator.serviceWorker.ready;
    if (service.active) {
        // eslint-disable-next-line no-console
        console.log('service-worker: registered');
        return 'successful';
    }
    return 'failed';
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/store.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  COLOR_SCHEMES: function() { return COLOR_SCHEMES; },
  SPLIT_PAGE_TYPES: function() { return SPLIT_PAGE_TYPES; },
  USER_COLOR_SCHEMES: function() { return USER_COLOR_SCHEMES; },
  useAutoSection: function() { return useAutoSection; },
  useDisabledVertical: function() { return useDisabledVertical; },
  useFontSize: function() { return useFontSize; },
  useGetVoice: function() { return useGetVoice; },
  usePageList: function() { return usePageList; },
  useParagraphRepeat: function() { return useParagraphRepeat; },
  usePersonReplace: function() { return usePersonReplace; },
  useSpeechSpeed: function() { return useSpeechSpeed; },
  useStopTimer: function() { return useStopTimer; },
  useStopTimerSeconds: function() { return useStopTimerSeconds; },
  useUserColorScheme: function() { return useUserColorScheme; },
  useViewPanelType: function() { return useViewPanelType; },
  useVoice: function() { return useVoice; }
});
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* harmony import */var jotai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/jotai@2.10.0_@types+react@18.3.9_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* harmony import */var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */var _core_util_collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/core/util/collection.ts");
/* harmony import */var _store_global_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/web/store/global.ts");
/* harmony import */var _core_util_browser_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/core/util/browser.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");
var _s = $RefreshSig$(), _s1 = $RefreshSig$(), _s2 = $RefreshSig$();





const allVoicesAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_4__.atom)([]);
if (_core_util_browser_js__WEBPACK_IMPORTED_MODULE_3__.isBrowser) {
    const loadVoices = ()=>{
        _store_global_js__WEBPACK_IMPORTED_MODULE_2__.globalStore.set(allVoicesAtom, speechSynthesis.getVoices());
    };
    loadVoices();
    if ('addEventListener' in window.speechSynthesis) {
        window.speechSynthesis.addEventListener('voiceschanged', loadVoices);
    }
}
function createStore(options) {
    var _s = $RefreshSig$();
    const { storeKey, read, write } = options;
    const getOriginStoredValue = ()=>localStorage.getItem(storeKey);
    const globalAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_4__.atom)(read(getOriginStoredValue()));
    return _s(()=>{
        _s();
        const [inner, setInner] = (0,jotai__WEBPACK_IMPORTED_MODULE_5__.useAtom)(globalAtom);
        const setValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((getValue)=>{
            let value;
            if (typeof getValue === 'function') {
                value = getValue(inner);
            } else {
                value = getValue;
            }
            setInner(value);
            const writeValue = write(value);
            if (writeValue) localStorage.setItem(storeKey, writeValue);
            else localStorage.removeItem(storeKey);
        }, [
            inner,
            setInner
        ]);
        return [
            inner,
            setValue
        ];
    }, "yAguJ8eJG0TcTb4i6It8GPEmwJY=", false, function() {
        return [
            jotai__WEBPACK_IMPORTED_MODULE_5__.useAtom
        ];
    });
}
const limitViewPanelType = (v)=>v === 'nav' || v === 'annotation' || v === 'keyword' ? v : 'none';
const useViewPanelType = createStore({
    storeKey: 'viewPanelType',
    read: limitViewPanelType,
    write: limitViewPanelType
});
/**
 * Dict[book-lang] = voiceURI
 */ const useLangVoiceURIDict = createStore({
    storeKey: 'langVoiceURIDict',
    read: (uriDictStr)=>uriDictStr ? JSON.parse(uriDictStr) : {},
    write: (uriDict)=>JSON.stringify(uriDict)
});
const useGetVoice = ()=>{
    _s();
    const [dict] = useLangVoiceURIDict();
    const [allVoices] = (0,jotai__WEBPACK_IMPORTED_MODULE_5__.useAtom)(allVoicesAtom);
    const getAllSortedVoices = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((book)=>{
        return (0,_core_util_collection_js__WEBPACK_IMPORTED_MODULE_1__.orderBy)(allVoices, 'desc', (v)=>[
                v.lang.startsWith(`${book.langCode}-`),
                !v.localService
            ]);
    }, [
        allVoices
    ]);
    const getVoice = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((book)=>{
        const allSortedVoices = getAllSortedVoices(book);
        const uri = dict[book.langCode];
        const voice = uri ? allSortedVoices.find((v)=>v.voiceURI === uri) : null;
        return voice ?? allSortedVoices.at(0) ?? null;
    }, [
        dict,
        getAllSortedVoices
    ]);
    return {
        getVoice,
        getAllSortedVoices
    };
};
_s(useGetVoice, "UyCFIld4k9rxWyYYPh5VB/r4svg=", false, function() {
    return [
        useLangVoiceURIDict,
        jotai__WEBPACK_IMPORTED_MODULE_5__.useAtom
    ];
});
const useLangVoiceURI = (book)=>{
    _s1();
    const [dict, setDict] = useLangVoiceURIDict();
    const langURI = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>dict[book.langCode] ?? null, [
        book.langCode,
        dict
    ]);
    const setLangURI = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((langURI)=>{
        const newDict = {
            ...dict
        };
        if (langURI) newDict[book.langCode] = langURI;
        else delete newDict[book.langCode];
        setDict(newDict);
    }, [
        book.langCode,
        dict,
        setDict
    ]);
    return [
        langURI,
        setLangURI
    ];
};
_s1(useLangVoiceURI, "HOXnZ9QGLnfUQPrJg9OZcyiVqSI=", false, function() {
    return [
        useLangVoiceURIDict
    ];
});
const useVoice = (book)=>{
    _s2();
    const [langVoiceURI, setLangVoiceURI] = useLangVoiceURI(book);
    const { getAllSortedVoices, getVoice } = useGetVoice();
    const allSortedVoices = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>{
        return getAllSortedVoices(book);
    }, [
        book,
        getAllSortedVoices
    ]);
    const voiceURI = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>{
        var _allSortedVoices_;
        return langVoiceURI ?? ((_allSortedVoices_ = allSortedVoices[0]) === null || _allSortedVoices_ === void 0 ? void 0 : _allSortedVoices_.voiceURI) ?? null;
    }, [
        allSortedVoices,
        langVoiceURI
    ]);
    const setVoiceURI = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((voiceURI)=>{
        setLangVoiceURI(voiceURI);
    }, [
        setLangVoiceURI
    ]);
    const voice = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>{
        return getVoice(book) ?? null;
    }, [
        book,
        getVoice
    ]);
    const setVoice = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((voice)=>{
        setVoiceURI((voice === null || voice === void 0 ? void 0 : voice.voiceURI) ?? null);
    }, [
        setVoiceURI
    ]);
    return {
        voiceURI,
        setVoiceURI,
        voice,
        setVoice,
        allSortedVoices
    };
};
_s2(useVoice, "vc93bwAxt06HN/V5BsXy1Mghc28=", false, function() {
    return [
        useLangVoiceURI,
        useGetVoice
    ];
});
const useAutoSection = createStore({
    storeKey: 'autoSection',
    read: (v)=>v ? v === '1' : true,
    write: (v)=>v ? '1' : '0'
});
const useStopTimer = createStore({
    storeKey: 'stopTimer',
    read: (v)=>v ? v === '1' : true,
    write: (v)=>v ? '1' : '0'
});
const useStopTimerSeconds = createStore({
    storeKey: 'stopTimerSeconds',
    read: (v)=>v ? Number(v) : 30 * 60,
    write: (v)=>v.toString()
});
const usePersonReplace = createStore({
    storeKey: 'personReplace',
    read: (v)=>v ? v === '1' : false,
    write: (v)=>v ? '1' : '0'
});
const useSpeechSpeed = createStore({
    storeKey: 'speechSpeed',
    read: (v)=>v ? Number(v) : 1,
    write: (v)=>v.toString()
});
const COLOR_SCHEMES = [
    'dark',
    'light'
];
const USER_COLOR_SCHEMES = [
    'system',
    ...COLOR_SCHEMES
];
const useUserColorScheme = createStore({
    storeKey: 'userColorScheme',
    read: (v)=>v ?? 'system',
    write: (v)=>v
});
const useParagraphRepeat = createStore({
    storeKey: 'paragraphRepeat',
    read: (v)=>v ? Number(v) : 1,
    write: (v)=>v.toString()
});
const SPLIT_PAGE_TYPES = [
    'none',
    'auto',
    'single',
    'double'
];
const usePageList = createStore({
    storeKey: 'pageList',
    read: (v)=>SPLIT_PAGE_TYPES.includes(v) ? v : 'auto',
    write: (v)=>v
});
const useFontSize = createStore({
    storeKey: 'fontSize',
    read: (v)=>v ? Math.min(Math.max(Number(v), 8), 30) : 16,
    write: (v)=>v.toString()
});
const useDisabledVertical = createStore({
    storeKey: 'disabledVertical',
    read: (v)=>v ? v === '1' : false,
    write: (v)=>v ? '1' : '0'
});

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/style.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  globalStyle: function() { return globalStyle; }
});
/* harmony import */var _core_consts_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/core/consts.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

const globalStyle = `
  :root {
    --main-bg: white;
    --main-bg-active: #ddd;
    --main-bg-hover: #e3e3e3;
    --main-fg: #111;
    --main-fg-active: #111;
    --main-fg-hover: #111;
    --main-border: #666;
    --main-bg-blue: #03c;
    --main-fg-blue: #DDD;
    --main-bg-highlight: rgba(10, 120, 220, 0.3);
    --main-fg-highlight: var(--main-fg);
  }
  :root.${_core_consts_js__WEBPACK_IMPORTED_MODULE_0__.COLOR_SCHEME_DARK_CLASS}  {
    --main-bg: #1a1b1e;
    --main-bg-active: #555;
    --main-bg-hover: #444;
    --main-fg: #ccc;
    --main-fg-active: #ccc;
    --main-fg-hover: #ccc;
    --main-border: #777;
  }
`;

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/web/theme.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  AntdConfigProvider: function() { return AntdConfigProvider; },
  useColorScheme: function() { return useColorScheme; }
});
/* harmony import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* harmony import */var _react_hookz_web__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./node_modules/.pnpm/@react-hookz+web@24.0.4_react-dom@18.3.1_react@18.3.1/node_modules/@react-hookz/web/src/useMediaQuery/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/theme/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/config-provider/index.js");
/* harmony import */var antd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./node_modules/.pnpm/antd@5.21.1_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/app/index.js");
/* harmony import */var _store_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/web/store.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$(), _s1 = $RefreshSig$();



const { defaultAlgorithm, darkAlgorithm } = antd__WEBPACK_IMPORTED_MODULE_2__["default"];
const useColorScheme = ()=>{
    _s();
    const prefersDarkMode = (0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_3__.useMediaQuery)('(prefers-color-scheme: dark)');
    const [userColorScheme] = (0,_store_js__WEBPACK_IMPORTED_MODULE_1__.useUserColorScheme)();
    const mode = userColorScheme === 'system' ? prefersDarkMode ? 'dark' : 'light' : userColorScheme;
    return mode;
};
_s(useColorScheme, "eYCps7m4xxYymLDIOdBD3/VLwPA=", false, function() {
    return [
        _react_hookz_web__WEBPACK_IMPORTED_MODULE_3__.useMediaQuery,
        _store_js__WEBPACK_IMPORTED_MODULE_1__.useUserColorScheme
    ];
});
const AntdConfigProvider = (param)=>{
    let { children } = param;
    _s1();
    const colorScheme = useColorScheme();
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_4__["default"], {
        theme: {
            algorithm: colorScheme === 'dark' ? darkAlgorithm : defaultAlgorithm,
            components: {
                InputNumber: {
                    handleVisible: true
                }
            }
        },
        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(antd__WEBPACK_IMPORTED_MODULE_5__["default"], {
            className: "app",
            children: children
        }, void 0, false, {
            fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/theme.tsx",
            lineNumber: 38,
            columnNumber: 7
        }, undefined)
    }, void 0, false, {
        fileName: "/home/runner/work/auditory-reader/auditory-reader/src/web/theme.tsx",
        lineNumber: 28,
        columnNumber: 5
    }, undefined);
};
_s1(AntdConfigProvider, "ADSDo7sFobczRMTAjM/1utmWxIE=", false, function() {
    return [
        useColorScheme
    ];
});
_c = AntdConfigProvider;
var _c;
$RefreshReg$(_c, "AntdConfigProvider");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),

});
/************************************************************************/
// The module cache
var __webpack_module_cache__ = {};

// The require function
function __webpack_require__(moduleId) {

// Check if module is in cache
var cachedModule = __webpack_module_cache__[moduleId];
if (cachedModule !== undefined) {
if (cachedModule.error !== undefined) throw cachedModule.error;
return cachedModule.exports;
}
// Create a new module (and put it into the cache)
var module = (__webpack_module_cache__[moduleId] = {
id: moduleId,
loaded: false,
exports: {}
});
// Execute the module function
try {

var execOptions = { id: moduleId, module: module, factory: __webpack_modules__[moduleId], require: __webpack_require__ };
__webpack_require__.i.forEach(function(handler) { handler(execOptions); });
module = execOptions.module;
if (!execOptions.factory) {
  console.error("undefined factory", moduleId)
}
execOptions.factory.call(module.exports, module, module.exports, execOptions.require);

} catch (e) {
module.error = e;
throw e;
}
// Flag the module as loaded
module.loaded = true;
// Return the exports of the module
return module.exports;

}

// expose the modules object (__webpack_modules__)
__webpack_require__.m = __webpack_modules__;

// expose the module cache
__webpack_require__.c = __webpack_module_cache__;

// expose the module execution interceptor
__webpack_require__.i = [];

/************************************************************************/
// webpack/runtime/compat_get_default_export
(() => {
// getDefaultExport function for compatibility with non-harmony modules
__webpack_require__.n = function (module) {
	var getter = module && module.__esModule ?
		function () { return module['default']; } :
		function () { return module; };
	__webpack_require__.d(getter, { a: getter });
	return getter;
};




})();
// webpack/runtime/create_fake_namespace_object
(() => {
var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__ };
var leafPrototypes;
// create a fake namespace object
// mode & 1: value is a module id, require it
// mode & 2: merge all properties of value into the ns
// mode & 4: return value when already ns object
// mode & 16: return value when it's Promise-like
// mode & 8|1: behave like require
__webpack_require__.t = function(value, mode) {
	if(mode & 1) value = this(value);
	if(mode & 8) return value;
	if(typeof value === 'object' && value) {
		if((mode & 4) && value.__esModule) return value;
		if((mode & 16) && typeof value.then === 'function') return value;
	}
	var ns = Object.create(null);
	__webpack_require__.r(ns);
	var def = {};
	leafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];
	for(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {
		Object.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return  value[key]; } });
	}
	def['default'] = function() { return value };
	__webpack_require__.d(ns, def);
	return ns;
};
})();
// webpack/runtime/define_property_getters
(() => {
__webpack_require__.d = function(exports, definition) {
	for(var key in definition) {
        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
        }
    }
};
})();
// webpack/runtime/get javascript chunk filename
(() => {
// This function allow to reference chunks
        __webpack_require__.u = function (chunkId) {
          // return url for filenames not based on template
          
          // return url for filenames based on template
          return "static/js/async/" + chunkId + ".js";
        };
      
})();
// webpack/runtime/get mini-css chunk filename
(() => {
// This function allow to reference chunks
        __webpack_require__.miniCssF = function (chunkId) {
          // return url for filenames not based on template
          
          // return url for filenames based on template
          return "" + chunkId + ".css";
        };
      
})();
// webpack/runtime/get_chunk_update_filename
(() => {
__webpack_require__.hu = function (chunkId) {
            return '' + chunkId + '.' + __webpack_require__.h() + '.hot-update.js';
         };
        
})();
// webpack/runtime/get_full_hash
(() => {
__webpack_require__.h = function () {
	return "104b90b2efb00369";
};

})();
// webpack/runtime/get_main_filename/update manifest
(() => {
__webpack_require__.hmrF = function () {
            return "index." + __webpack_require__.h() + ".hot-update.json";
         };
        
})();
// webpack/runtime/global
(() => {
__webpack_require__.g = (function () {
	if (typeof globalThis === 'object') return globalThis;
	try {
		return this || new Function('return this')();
	} catch (e) {
		if (typeof window === 'object') return window;
	}
})();

})();
// webpack/runtime/harmony_module_decorator
(() => {
__webpack_require__.hmd = function (module) {
    module = Object.create(module);
    if (!module.children) module.children = [];
    Object.defineProperty(module, 'exports', {
        enumerable: true,
        set: function () {
            throw new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);
        }
    });
    return module;
};
})();
// webpack/runtime/has_own_property
(() => {
__webpack_require__.o = function (obj, prop) {
	return Object.prototype.hasOwnProperty.call(obj, prop);
};

})();
// webpack/runtime/hot_module_replacement
(() => {
var currentModuleData = {};
var installedModules = __webpack_require__.c;

// module and require creation
var currentChildModule;
var currentParents = [];

// status
var registeredStatusHandlers = [];
var currentStatus = "idle";

// while downloading
var blockingPromises = 0;
var blockingPromisesWaiting = [];

// The update info
var currentUpdateApplyHandlers;
var queuedInvalidatedModules;

__webpack_require__.hmrD = currentModuleData;
__webpack_require__.i.push(function (options) {
	var module = options.module;
	var require = createRequire(options.require, options.id);
	module.hot = createModuleHotObject(options.id, module);
	module.parents = currentParents;
	module.children = [];
	currentParents = [];
	options.require = require;
});

__webpack_require__.hmrC = {};
__webpack_require__.hmrI = {};

function createRequire(require, moduleId) {
	var me = installedModules[moduleId];
	if (!me) return require;
	var fn = function (request) {
		if (me.hot.active) {
			if (installedModules[request]) {
				var parents = installedModules[request].parents;
				if (parents.indexOf(moduleId) === -1) {
					parents.push(moduleId);
				}
			} else {
				currentParents = [moduleId];
				currentChildModule = request;
			}
			if (me.children.indexOf(request) === -1) {
				me.children.push(request);
			}
		} else {
			console.warn(
				"[HMR] unexpected require(" +
				request +
				") from disposed module " +
				moduleId
			);
			currentParents = [];
		}
		return require(request);
	};
	var createPropertyDescriptor = function (name) {
		return {
			configurable: true,
			enumerable: true,
			get: function () {
				return require[name];
			},
			set: function (value) {
				require[name] = value;
			}
		};
	};
	for (var name in require) {
		if (Object.prototype.hasOwnProperty.call(require, name) && name !== "e") {
			Object.defineProperty(fn, name, createPropertyDescriptor(name));
		}
	}

	fn.e = function (chunkId, fetchPriority) {
		return trackBlockingPromise(require.e(chunkId, fetchPriority));
	};

	return fn;
}

function createModuleHotObject(moduleId, me) {
	var _main = currentChildModule !== moduleId;
	var hot = {
		_acceptedDependencies: {},
		_acceptedErrorHandlers: {},
		_declinedDependencies: {},
		_selfAccepted: false,
		_selfDeclined: false,
		_selfInvalidated: false,
		_disposeHandlers: [],
		_main: _main,
		_requireSelf: function () {
			currentParents = me.parents.slice();
			currentChildModule = _main ? undefined : moduleId;
			__webpack_require__(moduleId);
		},
		active: true,
		accept: function (dep, callback, errorHandler) {
			if (dep === undefined) hot._selfAccepted = true;
			else if (typeof dep === "function") hot._selfAccepted = dep;
			else if (typeof dep === "object" && dep !== null) {
				for (var i = 0; i < dep.length; i++) {
					hot._acceptedDependencies[dep[i]] = callback || function () { };
					hot._acceptedErrorHandlers[dep[i]] = errorHandler;
				}
			} else {
				hot._acceptedDependencies[dep] = callback || function () { };
				hot._acceptedErrorHandlers[dep] = errorHandler;
			}
		},
		decline: function (dep) {
			if (dep === undefined) hot._selfDeclined = true;
			else if (typeof dep === "object" && dep !== null)
				for (var i = 0; i < dep.length; i++)
					hot._declinedDependencies[dep[i]] = true;
			else hot._declinedDependencies[dep] = true;
		},
		dispose: function (callback) {
			hot._disposeHandlers.push(callback);
		},
		addDisposeHandler: function (callback) {
			hot._disposeHandlers.push(callback);
		},
		removeDisposeHandler: function (callback) {
			var idx = hot._disposeHandlers.indexOf(callback);
			if (idx >= 0) hot._disposeHandlers.splice(idx, 1);
		},
		invalidate: function () {
			this._selfInvalidated = true;
			switch (currentStatus) {
				case "idle":
					currentUpdateApplyHandlers = [];
					Object.keys(__webpack_require__.hmrI).forEach(function (key) {
						__webpack_require__.hmrI[key](moduleId, currentUpdateApplyHandlers);
					});
					setStatus("ready");
					break;
				case "ready":
					Object.keys(__webpack_require__.hmrI).forEach(function (key) {
						__webpack_require__.hmrI[key](moduleId, currentUpdateApplyHandlers);
					});
					break;
				case "prepare":
				case "check":
				case "dispose":
				case "apply":
					(queuedInvalidatedModules = queuedInvalidatedModules || []).push(
						moduleId
					);
					break;
				default:
					break;
			}
		},
		check: hotCheck,
		apply: hotApply,
		status: function (l) {
			if (!l) return currentStatus;
			registeredStatusHandlers.push(l);
		},
		addStatusHandler: function (l) {
			registeredStatusHandlers.push(l);
		},
		removeStatusHandler: function (l) {
			var idx = registeredStatusHandlers.indexOf(l);
			if (idx >= 0) registeredStatusHandlers.splice(idx, 1);
		},
		data: currentModuleData[moduleId]
	};
	currentChildModule = undefined;
	return hot;
}

function setStatus(newStatus) {
	currentStatus = newStatus; 
	var results = [];
	for (var i = 0; i < registeredStatusHandlers.length; i++)
		results[i] = registeredStatusHandlers[i].call(null, newStatus);

	return Promise.all(results).then(function () { });
}

function unblock() {
	if (--blockingPromises === 0) {
		setStatus("ready").then(function () {
			if (blockingPromises === 0) {
				var list = blockingPromisesWaiting;
				blockingPromisesWaiting = [];
				for (var i = 0; i < list.length; i++) {
					list[i]();
				}
			}
		});
	}
}

function trackBlockingPromise(promise) {
	switch (currentStatus) {
		case "ready":
			setStatus("prepare");
		case "prepare":
			blockingPromises++;
			promise.then(unblock, unblock);
			return promise;
		default:
			return promise;
	}
}

function waitForBlockingPromises(fn) {
	if (blockingPromises === 0) return fn();
	return new Promise(function (resolve) {
		blockingPromisesWaiting.push(function () {
			resolve(fn());
		});
	});
}

function hotCheck(applyOnUpdate) {
	if (currentStatus !== "idle") {
		throw new Error("check() is only allowed in idle status");
	} 
	return setStatus("check")
		.then(__webpack_require__.hmrM)
		.then(function (update) {
			if (!update) {
				return setStatus(applyInvalidatedModules() ? "ready" : "idle").then(
					function () {
						return null;
					}
				);
			}

			return setStatus("prepare").then(function () {
				var updatedModules = [];
				currentUpdateApplyHandlers = [];

				return Promise.all(
					Object.keys(__webpack_require__.hmrC).reduce(function (
						promises,
						key
					) {
						__webpack_require__.hmrC[key](
							update.c,
							update.r,
							update.m,
							promises,
							currentUpdateApplyHandlers,
							updatedModules
						);
						return promises;
					},
						[])
				).then(function () {
					return waitForBlockingPromises(function () {
						if (applyOnUpdate) {
							return internalApply(applyOnUpdate);
						}
						return setStatus("ready").then(function () {
							return updatedModules;
						});
					});
				});
			});
		});
}

function hotApply(options) {
	if (currentStatus !== "ready") {
		return Promise.resolve().then(function () {
			throw new Error(
				"apply() is only allowed in ready status (state: " + currentStatus + ")"
			);
		});
	}
	return internalApply(options);
}

function internalApply(options) {
	options = options || {};
	applyInvalidatedModules();
	var results = currentUpdateApplyHandlers.map(function (handler) {
		return handler(options);
	});
	currentUpdateApplyHandlers = undefined;
	var errors = results
		.map(function (r) {
			return r.error;
		})
		.filter(Boolean);

	if (errors.length > 0) {
		return setStatus("abort").then(function () {
			throw errors[0];
		});
	}

	var disposePromise = setStatus("dispose");

	results.forEach(function (result) {
		if (result.dispose) result.dispose();
	});

	var applyPromise = setStatus("apply");

	var error;
	var reportError = function (err) {
		if (!error) error = err;
	};

	var outdatedModules = [];
	results.forEach(function (result) {
		if (result.apply) {
			var modules = result.apply(reportError);
			if (modules) {
				for (var i = 0; i < modules.length; i++) {
					outdatedModules.push(modules[i]);
				}
			}
		}
	});

	return Promise.all([disposePromise, applyPromise]).then(function () {
		if (error) {
			return setStatus("fail").then(function () {
				throw error;
			});
		}

		if (queuedInvalidatedModules) {
			return internalApply(options).then(function (list) {
				outdatedModules.forEach(function (moduleId) {
					if (list.indexOf(moduleId) < 0) list.push(moduleId);
				});
				return list;
			});
		}

		return setStatus("idle").then(function () {
			return outdatedModules;
		});
	});
}

function applyInvalidatedModules() {
	if (queuedInvalidatedModules) {
		if (!currentUpdateApplyHandlers) currentUpdateApplyHandlers = [];
		Object.keys(__webpack_require__.hmrI).forEach(function (key) {
			queuedInvalidatedModules.forEach(function (moduleId) {
				__webpack_require__.hmrI[key](moduleId, currentUpdateApplyHandlers);
			});
		});
		queuedInvalidatedModules = undefined;
		return true;
	}
}

})();
// webpack/runtime/load_script
(() => {
var inProgress = {};

var dataWebpackPrefix = "auditory-reader:";
// loadScript function to load a script via script tag
__webpack_require__.l = function (url, done, key, chunkId) {
	if (inProgress[url]) {
		inProgress[url].push(done);
		return;
	}
	var script, needAttach;
	if (key !== undefined) {
		var scripts = document.getElementsByTagName("script");
		for (var i = 0; i < scripts.length; i++) {
			var s = scripts[i];
			if (s.getAttribute("src") == url || s.getAttribute("data-webpack") == dataWebpackPrefix + key) {
				script = s;
				break;
			}
		}
	}
	if (!script) {
		needAttach = true;
		script = document.createElement('script');
		
		script.charset = 'utf-8';
		script.timeout = 120;
		if (__webpack_require__.nc) {
			script.setAttribute("nonce", __webpack_require__.nc);
		}
		script.setAttribute("data-webpack", dataWebpackPrefix + key);
		
		script.src = url;

		
	}
	inProgress[url] = [done];
	var onScriptComplete = function (prev, event) {
		script.onerror = script.onload = null;
		clearTimeout(timeout);
		var doneFns = inProgress[url];
		delete inProgress[url];
		script.parentNode && script.parentNode.removeChild(script);
		doneFns &&
			doneFns.forEach(function (fn) {
				return fn(event);
			});
		if (prev) return prev(event);
	};
	var timeout = setTimeout(
		onScriptComplete.bind(null, undefined, {
			type: 'timeout',
			target: script
		}),
		120000
	);
	script.onerror = onScriptComplete.bind(null, script.onerror);
	script.onload = onScriptComplete.bind(null, script.onload);
	needAttach && document.head.appendChild(script);
};

})();
// webpack/runtime/make_namespace_object
(() => {
// define __esModule on exports
__webpack_require__.r = function(exports) {
	if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
		Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
	}
	Object.defineProperty(exports, '__esModule', { value: true });
};

})();
// webpack/runtime/node_module_decorator
(() => {
__webpack_require__.nmd = function (module) {
    module.paths = [];
    if (!module.children) module.children = [];
    return module;
};
})();
// webpack/runtime/on_chunk_loaded
(() => {
var deferred = [];
__webpack_require__.O = function (result, chunkIds, fn, priority) {
	if (chunkIds) {
		priority = priority || 0;
		for (var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--)
			deferred[i] = deferred[i - 1];
		deferred[i] = [chunkIds, fn, priority];
		return;
	}
	var notFulfilled = Infinity;
	for (var i = 0; i < deferred.length; i++) {
		var chunkIds = deferred[i][0],
			fn = deferred[i][1],
			priority = deferred[i][2];
		var fulfilled = true;
		for (var j = 0; j < chunkIds.length; j++) {
			if (
				(priority & (1 === 0) || notFulfilled >= priority) &&
				Object.keys(__webpack_require__.O).every(function (key) {
					return __webpack_require__.O[key](chunkIds[j]);
				})
			) {
				chunkIds.splice(j--, 1);
			} else {
				fulfilled = false;
				if (priority < notFulfilled) notFulfilled = priority;
			}
		}
		if (fulfilled) {
			deferred.splice(i--, 1);
			var r = fn();
			if (r !== undefined) result = r;
		}
	}
	return result;
};

})();
// webpack/runtime/public_path
(() => {
__webpack_require__.p = "/";

})();
// webpack/runtime/rspack_version
(() => {
__webpack_require__.rv = function () {
	return "1.0.8";
};

})();
// webpack/runtime/css loading
(() => {
if (typeof document === "undefined") return;
var createStylesheet = function (
	chunkId, fullhref, oldTag, resolve, reject
) {
	var linkTag = document.createElement("link");
	
	linkTag.rel = "stylesheet";
	linkTag.type="text/css";
	if (__webpack_require__.nc) {
		linkTag.nonce = __webpack_require__.nc;
	}
	var onLinkComplete = function (event) {
		// avoid mem leaks.
		linkTag.onerror = linkTag.onload = null;
		if (event.type === 'load') {
			resolve();
		} else {
			var errorType = event && (event.type === 'load' ? 'missing' : event.type);
			var realHref = event && event.target && event.target.href || fullhref;
			var err = new Error("Loading CSS chunk " + chunkId + " failed.\\n(" + realHref + ")");
			err.code = "CSS_CHUNK_LOAD_FAILED";
			err.type = errorType;
			err.request = realHref;
			if (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)
			reject(err);
		}
	}

	linkTag.onerror = linkTag.onload = onLinkComplete;
	linkTag.href = fullhref;
	
	if (oldTag) {
  oldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);
} else {
  document.head.appendChild(linkTag);
}
	return linkTag;
}
var findStylesheet = function (href, fullhref) {
	var existingLinkTags = document.getElementsByTagName("link");
	for (var i = 0; i < existingLinkTags.length; i++) {
		var tag = existingLinkTags[i];
		var dataHref = tag.getAttribute("data-href") || tag.getAttribute("href");
		if (tag.rel === "stylesheet" && (dataHref === href || dataHref === fullhref)) return tag;
	}

	var existingStyleTags = document.getElementsByTagName("style");
	for (var i = 0; i < existingStyleTags.length; i++) {
		var tag = existingStyleTags[i];
		var dataHref = tag.getAttribute("data-href");
		if (dataHref === href || dataHref === fullhref) return tag;
	}
}

var loadStylesheet = function (chunkId) {
	return new Promise(function (resolve, reject) {
		var href = __webpack_require__.miniCssF(chunkId);
		var fullhref = __webpack_require__.p + href;
		if (findStylesheet(href, fullhref)) return resolve();
		createStylesheet(chunkId, fullhref, null, resolve, reject);
	})
}

// no chunk loading
var oldTags = [];
var newTags = [];
var applyHandler = function (options) {
	return {
		dispose: function () {
			for (var i = 0; i < oldTags.length; i++) {
				var oldTag = oldTags[i];
				if (oldTag.parentNode) oldTag.parentNode.removeChild(oldTag);
			}
			oldTags.length = 0;
		},
		apply: function () {
			for (var i = 0; i < newTags.length; i++) newTags[i].rel = "stylesheet";
			newTags.length = 0;
		}
	}
}
__webpack_require__.hmrC.miniCss = function (chunkIds, removedChunks, removedModules, promises, applyHandlers, updatedModulesList) {
	applyHandlers.push(applyHandler);
	chunkIds.forEach(function (chunkId) {
		var href = __webpack_require__.miniCssF(chunkId);
		var fullhref = __webpack_require__.p + href;
		var oldTag = findStylesheet(href, fullhref);
		if (!oldTag) return;
		promises.push(new Promise(function (resolve, reject) {
			var tag = createStylesheet(
				chunkId,
				fullhref,
				oldTag,
				function () {
					tag.as = "style";
					tag.rel = "preload";
					resolve();
				},
				reject
			);
			oldTags.push(oldTag);
			newTags.push(tag);
		}))
	});
}


})();
// webpack/runtime/jsonp_chunk_loading
(() => {
__webpack_require__.b = document.baseURI || self.location.href;

      // object to store loaded and loading chunks
      // undefined = chunk not loaded, null = chunk preloaded/prefetched
      // [resolve, reject, Promise] = chunk loading, 0 = chunk loaded
      var installedChunks = __webpack_require__.hmrS_jsonp = __webpack_require__.hmrS_jsonp || {"index": 0,};
      var currentUpdatedModulesList;
var waitingUpdateResolves = {};
function loadUpdateChunk(chunkId, updatedModulesList) {
	currentUpdatedModulesList = updatedModulesList;
	return new Promise(function (resolve, reject) {
		waitingUpdateResolves[chunkId] = resolve;
		// start update chunk loading
		var url = __webpack_require__.p + __webpack_require__.hu(chunkId);
		// create error before stack unwound to get useful stacktrace later
		var error = new Error();
		var loadingEnded = function (event) {
			if (waitingUpdateResolves[chunkId]) {
				waitingUpdateResolves[chunkId] = undefined;
				var errorType =
					event && (event.type === 'load' ? 'missing' : event.type);
				var realSrc = event && event.target && event.target.src;
				error.message =
					'Loading hot update chunk ' +
					chunkId +
					' failed.\n(' +
					errorType +
					': ' +
					realSrc +
					')';
				error.name = 'ChunkLoadError';
				error.type = errorType;
				error.request = realSrc;
				reject(error);
			}
		};
		__webpack_require__.l(url, loadingEnded);
	});
}

self["webpackHotUpdateauditory_reader"] = function (chunkId, moreModules, runtime) {
	for (var moduleId in moreModules) {
		if (__webpack_require__.o(moreModules, moduleId)) {
			currentUpdate[moduleId] = moreModules[moduleId];
			if (currentUpdatedModulesList) currentUpdatedModulesList.push(moduleId);
		}
	}
	if (runtime) currentUpdateRuntime.push(runtime);
	if (waitingUpdateResolves[chunkId]) {
		waitingUpdateResolves[chunkId]();
		waitingUpdateResolves[chunkId] = undefined;
	}
};
var currentUpdateChunks;
var currentUpdate;
var currentUpdateRemovedChunks;
var currentUpdateRuntime;
function applyHandler(options) {
	if (__webpack_require__.f) delete __webpack_require__.f.jsonpHmr;
	currentUpdateChunks = undefined;
	function getAffectedModuleEffects(updateModuleId) {
		var outdatedModules = [updateModuleId];
		var outdatedDependencies = {};
		var queue = outdatedModules.map(function (id) {
			return {
				chain: [id],
				id: id
			};
		});
		while (queue.length > 0) {
			var queueItem = queue.pop();
			var moduleId = queueItem.id;
			var chain = queueItem.chain;
			var module = __webpack_require__.c[moduleId];
			if (
				!module ||
				(module.hot._selfAccepted && !module.hot._selfInvalidated)
			) {
				continue;
			}

			if (module.hot._selfDeclined) {
				return {
					type: "self-declined",
					chain: chain,
					moduleId: moduleId
				};
			}

			if (module.hot._main) {
				return {
					type: "unaccepted",
					chain: chain,
					moduleId: moduleId
				};
			}

			for (var i = 0; i < module.parents.length; i++) {
				var parentId = module.parents[i];
				var parent = __webpack_require__.c[parentId];
				if (!parent) {
					continue;
				}
				if (parent.hot._declinedDependencies[moduleId]) {
					return {
						type: "declined",
						chain: chain.concat([parentId]),
						moduleId: moduleId,
						parentId: parentId
					};
				}
				if (outdatedModules.indexOf(parentId) !== -1) {
					continue;
				}
				if (parent.hot._acceptedDependencies[moduleId]) {
					if (!outdatedDependencies[parentId]) {
						outdatedDependencies[parentId] = [];
					}
					addAllToSet(outdatedDependencies[parentId], [moduleId]);
					continue;
				}
				delete outdatedDependencies[parentId];
				outdatedModules.push(parentId);
				queue.push({
					chain: chain.concat([parentId]),
					id: parentId
				});
			}
		}

		return {
			type: "accepted",
			moduleId: updateModuleId,
			outdatedModules: outdatedModules,
			outdatedDependencies: outdatedDependencies
		};
	}

	function addAllToSet(a, b) {
		for (var i = 0; i < b.length; i++) {
			var item = b[i];
			if (a.indexOf(item) === -1) a.push(item);
		}
	}

	var outdatedDependencies = {};
	var outdatedModules = [];
	var appliedUpdate = {};

	var warnUnexpectedRequire = function warnUnexpectedRequire(module) {
		console.warn(
			"[HMR] unexpected require(" + module.id + ") to disposed module"
		);
	};

	for (var moduleId in currentUpdate) {
		if (__webpack_require__.o(currentUpdate, moduleId)) {
			var newModuleFactory = currentUpdate[moduleId];
			var result = newModuleFactory ? getAffectedModuleEffects(moduleId) : {
				type: "disposed",
				moduleId: moduleId
			};
			var abortError = false;
			var doApply = false;
			var doDispose = false;
			var chainInfo = "";
			if (result.chain) {
				chainInfo = "\nUpdate propagation: " + result.chain.join(" -> ");
			}
			switch (result.type) {
				case "self-declined":
					if (options.onDeclined) options.onDeclined(result);
					if (!options.ignoreDeclined)
						abortError = new Error(
							"Aborted because of self decline: " + result.moduleId + chainInfo
						);
					break;
				case "declined":
					if (options.onDeclined) options.onDeclined(result);
					if (!options.ignoreDeclined)
						abortError = new Error(
							"Aborted because of declined dependency: " +
							result.moduleId +
							" in " +
							result.parentId +
							chainInfo
						);
					break;
				case "unaccepted":
					if (options.onUnaccepted) options.onUnaccepted(result);
					if (!options.ignoreUnaccepted)
						abortError = new Error(
							"Aborted because " + moduleId + " is not accepted" + chainInfo
						);
					break;
				case "accepted":
					if (options.onAccepted) options.onAccepted(result);
					doApply = true;
					break;
				case "disposed":
					if (options.onDisposed) options.onDisposed(result);
					doDispose = true;
					break;
				default:
					throw new Error("Unexception type " + result.type);
			}
			if (abortError) {
				return {
					error: abortError
				};
			}
			if (doApply) {
				appliedUpdate[moduleId] = newModuleFactory;
				addAllToSet(outdatedModules, result.outdatedModules);
				for (moduleId in result.outdatedDependencies) {
					if (__webpack_require__.o(result.outdatedDependencies, moduleId)) {
						if (!outdatedDependencies[moduleId])
							outdatedDependencies[moduleId] = [];
						addAllToSet(
							outdatedDependencies[moduleId],
							result.outdatedDependencies[moduleId]
						);
					}
				}
			}
			if (doDispose) {
				addAllToSet(outdatedModules, [result.moduleId]);
				appliedUpdate[moduleId] = warnUnexpectedRequire;
			}
		}
	}
	currentUpdate = undefined;

	var outdatedSelfAcceptedModules = [];
	for (var j = 0; j < outdatedModules.length; j++) {
		var outdatedModuleId = outdatedModules[j];
		var module = __webpack_require__.c[outdatedModuleId];
		if (
			module &&
			(module.hot._selfAccepted || module.hot._main) &&
			// removed self-accepted modules should not be required
			appliedUpdate[outdatedModuleId] !== warnUnexpectedRequire &&
			// when called invalidate self-accepting is not possible
			!module.hot._selfInvalidated
		) {
			outdatedSelfAcceptedModules.push({
				module: outdatedModuleId,
				require: module.hot._requireSelf,
				errorHandler: module.hot._selfAccepted
			});
		}
	} 

	var moduleOutdatedDependencies;
	return {
		dispose: function () {
			currentUpdateRemovedChunks.forEach(function (chunkId) {
				delete installedChunks[chunkId];
			});
			currentUpdateRemovedChunks = undefined;

			var idx;
			var queue = outdatedModules.slice();
			while (queue.length > 0) {
				var moduleId = queue.pop();
				var module = __webpack_require__.c[moduleId];
				if (!module) continue;

				var data = {};

				// Call dispose handlers
				var disposeHandlers = module.hot._disposeHandlers; 
				for (j = 0; j < disposeHandlers.length; j++) {
					disposeHandlers[j].call(null, data);
				}
				__webpack_require__.hmrD[moduleId] = data;

				module.hot.active = false;

				delete __webpack_require__.c[moduleId];

				delete outdatedDependencies[moduleId];

				for (j = 0; j < module.children.length; j++) {
					var child = __webpack_require__.c[module.children[j]];
					if (!child) continue;
					idx = child.parents.indexOf(moduleId);
					if (idx >= 0) {
						child.parents.splice(idx, 1);
					}
				}
			}

			var dependency;
			for (var outdatedModuleId in outdatedDependencies) {
				if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
					module = __webpack_require__.c[outdatedModuleId];
					if (module) {
						moduleOutdatedDependencies = outdatedDependencies[outdatedModuleId];
						for (j = 0; j < moduleOutdatedDependencies.length; j++) {
							dependency = moduleOutdatedDependencies[j];
							idx = module.children.indexOf(dependency);
							if (idx >= 0) module.children.splice(idx, 1);
						}
					}
				}
			}
		},
		apply: function (reportError) {
			// insert new code
			for (var updateModuleId in appliedUpdate) {
				if (__webpack_require__.o(appliedUpdate, updateModuleId)) {
					__webpack_require__.m[updateModuleId] = appliedUpdate[updateModuleId]; 
				}
			}

			// run new runtime modules
			for (var i = 0; i < currentUpdateRuntime.length; i++) {
				currentUpdateRuntime[i](__webpack_require__);
			}

			// call accept handlers
			for (var outdatedModuleId in outdatedDependencies) {
				if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
					var module = __webpack_require__.c[outdatedModuleId];
					if (module) {
						moduleOutdatedDependencies = outdatedDependencies[outdatedModuleId];
						var callbacks = [];
						var errorHandlers = [];
						var dependenciesForCallbacks = [];
						for (var j = 0; j < moduleOutdatedDependencies.length; j++) {
							var dependency = moduleOutdatedDependencies[j];
							var acceptCallback = module.hot._acceptedDependencies[dependency];
							var errorHandler = module.hot._acceptedErrorHandlers[dependency];
							if (acceptCallback) {
								if (callbacks.indexOf(acceptCallback) !== -1) continue;
								callbacks.push(acceptCallback);
								errorHandlers.push(errorHandler); 
								dependenciesForCallbacks.push(dependency);
							}
						}
						for (var k = 0; k < callbacks.length; k++) {
							try {
								callbacks[k].call(null, moduleOutdatedDependencies);
							} catch (err) {
								if (typeof errorHandlers[k] === "function") {
									try {
										errorHandlers[k](err, {
											moduleId: outdatedModuleId,
											dependencyId: dependenciesForCallbacks[k]
										});
									} catch (err2) {
										if (options.onErrored) {
											options.onErrored({
												type: "accept-error-handler-errored",
												moduleId: outdatedModuleId,
												dependencyId: dependenciesForCallbacks[k],
												error: err2,
												originalError: err
											});
										}
										if (!options.ignoreErrored) {
											reportError(err2);
											reportError(err);
										}
									}
								} else {
									if (options.onErrored) {
										options.onErrored({
											type: "accept-errored",
											moduleId: outdatedModuleId,
											dependencyId: dependenciesForCallbacks[k],
											error: err
										});
									}
									if (!options.ignoreErrored) {
										reportError(err);
									}
								}
							}
						}
					}
				}
			}

			// Load self accepted modules
			for (var o = 0; o < outdatedSelfAcceptedModules.length; o++) {
				var item = outdatedSelfAcceptedModules[o];
				var moduleId = item.module;
				try {
					item.require(moduleId);
				} catch (err) {
					if (typeof item.errorHandler === "function") {
						try {
							item.errorHandler(err, {
								moduleId: moduleId,
								module: __webpack_require__.c[moduleId]
							});
						} catch (err1) {
							if (options.onErrored) {
								options.onErrored({
									type: "self-accept-error-handler-errored",
									moduleId: moduleId,
									error: err1,
									originalError: err
								});
							}
							if (!options.ignoreErrored) {
								reportError(err1);
								reportError(err);
							}
						}
					} else {
						if (options.onErrored) {
							options.onErrored({
								type: "self-accept-errored",
								moduleId: moduleId,
								error: err
							});
						}
						if (!options.ignoreErrored) {
							reportError(err);
						}
					}
				}
			}

			return outdatedModules;
		}
	};
}

__webpack_require__.hmrI.jsonp = function (moduleId, applyHandlers) {
	if (!currentUpdate) {
		currentUpdate = {};
		currentUpdateRuntime = [];
		currentUpdateRemovedChunks = [];
		applyHandlers.push(applyHandler);
	}
	if (!__webpack_require__.o(currentUpdate, moduleId)) {
		currentUpdate[moduleId] = __webpack_require__.m[moduleId];
	}
};

__webpack_require__.hmrC.jsonp = function (
	chunkIds,
	removedChunks,
	removedModules,
	promises,
	applyHandlers,
	updatedModulesList
) {
	applyHandlers.push(applyHandler);
	currentUpdateChunks = {};
	currentUpdateRemovedChunks = removedChunks;
	currentUpdate = removedModules.reduce(function (obj, key) {
		obj[key] = false;
		return obj;
	}, {});
	currentUpdateRuntime = [];
	chunkIds.forEach(function (chunkId) {
		if (
			__webpack_require__.o(installedChunks, chunkId) &&
			installedChunks[chunkId] !== undefined
		) {
			promises.push(loadUpdateChunk(chunkId, updatedModulesList));
			currentUpdateChunks[chunkId] = true;
		} else {
			currentUpdateChunks[chunkId] = false;
		}
	});
	if (__webpack_require__.f) {
		__webpack_require__.f.jsonpHmr = function (chunkId, promises) {
			if (
				currentUpdateChunks &&
				__webpack_require__.o(currentUpdateChunks, chunkId) &&
				!currentUpdateChunks[chunkId]
			) {
				promises.push(loadUpdateChunk(chunkId));
				currentUpdateChunks[chunkId] = true;
			}
		};
	}
};
__webpack_require__.hmrM = function () {
	if (typeof fetch === "undefined")
		throw new Error("No browser support: need fetch API");
	return fetch(__webpack_require__.p + __webpack_require__.hmrF()).then(
		function (response) {
			if (response.status === 404) return; // no update available
			if (!response.ok)
				throw new Error(
					"Failed to fetch update manifest " + response.statusText
				);
			return response.json();
		}
	);
};
__webpack_require__.O.j = function (chunkId) {
	return installedChunks[chunkId] === 0;
};
// install a JSONP callback for chunk loading
var webpackJsonpCallback = function (parentChunkLoadingFunction, data) {
	var chunkIds = data[0];
	var moreModules = data[1];
	var runtime = data[2];
	// add "moreModules" to the modules object,
	// then flag all "chunkIds" as loaded and fire callback
	var moduleId,
		chunkId,
		i = 0;
	if (chunkIds.some(function (id) { return installedChunks[id] !== 0 })) {
		for (moduleId in moreModules) {
			if (__webpack_require__.o(moreModules, moduleId)) {
				__webpack_require__.m[moduleId] = moreModules[moduleId];
			}
		}
		if (runtime) var result = runtime(__webpack_require__);
	}
	if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);
	for (; i < chunkIds.length; i++) {
		chunkId = chunkIds[i];
		if (
			__webpack_require__.o(installedChunks, chunkId) &&
			installedChunks[chunkId]
		) {
			installedChunks[chunkId][0]();
		}
		installedChunks[chunkId] = 0;
	}
	return __webpack_require__.O(result);
};

var chunkLoadingGlobal = self["webpackChunkauditory_reader"] = self["webpackChunkauditory_reader"] || [];
chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));
chunkLoadingGlobal.push = webpackJsonpCallback.bind(
	null,
	chunkLoadingGlobal.push.bind(chunkLoadingGlobal)
);

})();
// webpack/runtime/rspack_unique_id
(() => {
__webpack_require__.ruid = "bundler=rspack@1.0.8";

})();
/************************************************************************/
// module cache are used so entry inlining is disabled
// startup
// Load entry module and return exports
__webpack_require__.O(undefined, ["lib-react", "lib-router", "vendors-node_modules_pnpm_mozilla_readability_0_5_0_node_modules_mozilla_readability_index_js-9ac323", "vendors-node_modules_pnpm_fortawesome_react-fontawesome_0_2_2__fortawesome_fontawesome-svg-co-7eefaf", "src_core_api_books_annotations-delete_ts-src_core_api_books_annotations-upsert_ts-src_core_ap-ec553f"], function() { return __webpack_require__("./node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.0_react-refresh@0.14.2/node_modules/@rspack/plugin-react-refresh/client/reactRefreshEntry.js") });
var __webpack_exports__ = __webpack_require__.O(undefined, ["lib-react", "lib-router", "vendors-node_modules_pnpm_mozilla_readability_0_5_0_node_modules_mozilla_readability_index_js-9ac323", "vendors-node_modules_pnpm_fortawesome_react-fontawesome_0_2_2__fortawesome_fontawesome-svg-co-7eefaf", "src_core_api_books_annotations-delete_ts-src_core_api_books_annotations-upsert_ts-src_core_ap-ec553f"], function() { return __webpack_require__("./src/web/index.tsx") });
__webpack_exports__ = __webpack_require__.O(__webpack_exports__);
})()
;
//# sourceMappingURL=index.js.map