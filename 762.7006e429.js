(()=>{"use strict";var e={9237:function(e,n,t){t.d(n,{P:function(){return _}});var r=t(2790),a=t(3747),o=t(1479),i=t(3062),s=t(6513),d=t.n(s),u=t(4210),c=t.n(u),l=t(6092),m=t(891);function*f(e,n,t){let[r,...a]=n;if(!r){if(t)for(let n of e.querySelectorAll(t))yield n;else yield e;return}for(let n of e.children)("*"===r||n.tagName.toLowerCase()===r.toLowerCase())&&(yield*f(n,a,t))}var h=new WeakMap,p=new WeakMap,v=new WeakMap,g=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,k=new WeakMap;class _{static async getRootPath(e){var n;let t=await e.htmlDom("META-INF/container.xml");if(!t){console.error("Parse META-INF/container.xml error");return}let r=null===(n=t.querySelector("rootfile"))||void 0===n?void 0:n.getAttribute("full-path");if(!r){console.error("rootfile full-path not found");return}return d().join("/",r)}static async read(e){let n=await c().loadAsync(e),t=new m.H(n),r=await this.getRootPath(t);if(!r){console.error(`epub root-path(${r}) not found`);return}let a=await t.xmlDom(r);if(!a){console.error("epub root document not found");return}return new _(n,t,a,d().dirname(r))}get version(){if(!(0,r._)(this,h)){let e=this.rootPkg.getAttribute("version")??"2.0";(0,o._)(this,h,parseFloat(e)>=3?3:2)}return(0,r._)(this,h)}get title(){if(!(0,r._)(this,p)){var e,n;let t=null===(e=this.rootPkg.findDescendant("metadata"))||void 0===e?void 0:e.findDescendant("dc:title");(0,o._)(this,p,(null==t?void 0:null===(n=t.text())||void 0===n?void 0:n.trim())??null)}return(0,r._)(this,p)}get language(){if(!(0,r._)(this,v)){var e,n;let t=null===(e=this.rootPkg.findDescendant("metadata"))||void 0===e?void 0:e.findDescendant("dc:language");(0,o._)(this,v,(null==t?void 0:null===(n=t.text())||void 0===n?void 0:n.trim())??null)}return(0,r._)(this,v)}get manifestItems(){if(!(0,r._)(this,g)){var e;let n=(null===(e=this.rootPkg.findDescendant("manifest"))||void 0===e?void 0:e.childrenFilter("item"))??[];(0,o._)(this,g,n.map(e=>({id:e.getAttribute("id"),href:d().join(this.rootDir,e.getAttribute("href")),mediaType:e.getAttribute("media-type"),properties:e.getAttribute("properties")??void 0})))}return(0,r._)(this,g)}get spine(){if(!(0,r._)(this,w)&&((0,o._)(this,w,this.rootPkg.findDescendant("spine")??void 0),!(0,r._)(this,w)))throw Error("spine not found");return(0,r._)(this,w)}get spineItems(){return!(0,r._)(this,y)&&(0,o._)(this,y,(0,l.oA)([...this.spine.childrenFilter("itemref")].map(e=>{let n=e.getAttribute("idref"),t=this.manifestItems.find(e=>e.id===n);if(t)return{manifest:t,idref:n,linear:e.getAttribute("linear")}}))),(0,r._)(this,y)}get spines(){return!(0,r._)(this,b)&&(0,o._)(this,b,this.spineItems.map(e=>({href:e.manifest.href,id:e.idref}))),(0,r._)(this,b)}async file(e){let n=await this.xmlLoader.file(e);if(!n)return;let t=await n.arrayBuffer(),r=e.startsWith("/")?e:`/${e}`,a=this.manifestItems.find(e=>e.href==r);return{buffer:t,mediaType:null==a?void 0:a.mediaType}}async cover(){var e;let n=null===(e=this.rootPkg.findDescendant("metadata"))||void 0===e?void 0:e.findDescendants("meta").find(e=>"cover"===e.getAttribute("name"));if(!n)return;let t=n.getAttribute("content");if(!t)return;let r=this.manifestItems.find(e=>e.id===t);if(!(null==r?void 0:r.href))return;let a=await this.xmlLoader.file(r.href);if(!!a)return{buffer:await a.arrayBuffer(),mediaType:r.mediaType}}async content(e){return this.xmlLoader.content(e)}async xmlDom(e){return this.xmlLoader.xmlDom(e)}async htmlDom(e){return this.xmlLoader.htmlDom(e)}dirBySpineIndex(e){let n=this.spineItems[e];if(n)return d().dirname(n.manifest.href)}getSpineIndexByHref(e){let n=this.spineItems.findIndex(n=>n.manifest.href===e);if(-1!==n)return n}async loadNav3(){let e=this.manifestItems.find(e=>"nav"===e.properties);if(!e)return this.loadNav2();let n=await this.htmlDom(e.href),t=d().dirname(e.href);if(!n)return[];let r=n.querySelector('nav[epub\\:type="toc"]>ol');return r?this.parseNav3(r,t):[]}parseNav3(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,l.oA)(Array.from(f(e,["li"])).map(e=>{var r;let a,o,i,s;let u=Array.from(e.children).find(e=>"ol"!==e.tagName.toLowerCase());if(!u)return;let c=u.textContent??"";if("a"===u.tagName.toLowerCase()){let e=u.getAttribute("href");e&&(a=d().join(n,e),[o,i]=a.split("#",2),o&&(s=this.getSpineIndexByHref(o)))}let l=f(e,["ol"],void 0).next().value??null;return{level:t,label:c,href:a,hrefBase:o,hrefAnchor:i,spineIndex:s,children:l?this.parseNav3(l,n,t+1):[]}}))}async loadNav2(){let e=this.spine.getAttribute("toc")??"ncx",n=this.manifestItems.find(n=>n.id===e);if(!n)return[];let t=await this.xmlDom(n.href),r=d().dirname(n.href);if(!t)return[];let a=t.findDescendant("navMap");return a?this.parseNav2(a,r):[]}parseNav2(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,l.oA)(e.childrenFilter("navPoint").map(e=>{var r,a,o;let i,s,u,c;let l=null===(a=e.findChild("navLabel"))||void 0===a?void 0:null===(r=a.findChild("text"))||void 0===r?void 0:r.text();if(!l)return;let m=null===(o=e.findChild("content"))||void 0===o?void 0:o.getAttribute("src");return m&&(i=d().join(n,m),[s,u]=i.split("#",2),s&&(c=this.getSpineIndexByHref(s))),{level:t,label:l,href:i,hrefBase:s,hrefAnchor:u,spineIndex:c,children:this.parseNav2(e,n,t+1)}}))}async navs(){return!(0,r._)(this,k)&&(this.version>=3?(0,o._)(this,k,await this.loadNav3()):(0,o._)(this,k,await this.loadNav2())),(0,r._)(this,k)}constructor(e,n,t,r){(0,i._)(this,"zip",void 0),(0,i._)(this,"xmlLoader",void 0),(0,i._)(this,"rootPkg",void 0),(0,i._)(this,"rootDir",void 0),(0,a._)(this,h,{writable:!0,value:void 0}),(0,a._)(this,p,{writable:!0,value:void 0}),(0,a._)(this,v,{writable:!0,value:void 0}),(0,a._)(this,g,{writable:!0,value:void 0}),(0,a._)(this,w,{writable:!0,value:void 0}),(0,a._)(this,y,{writable:!0,value:void 0}),(0,a._)(this,b,{writable:!0,value:void 0}),(0,a._)(this,k,{writable:!0,value:void 0}),this.zip=e,this.xmlLoader=n,this.rootPkg=t,this.rootDir=r}}},107:function(e,n,t){t.d(n,{DJ:function(){return r},Xp:function(){return o},b6:function(){return a},n1:function(){return i}});let r="auditory-reader",a="__para_box__",o="__para_ignore__",i="$tmp"},5860:function(e,n,t){t.d(n,{M:function(){return s}});var r=t(4933),a=t(5224),o=t(6836),i=t(107);async function s(e,n,t){let s=(0,a.rV)(e),d=await (0,a.w8)(s.doc),u=(0,r.Z)(),c=new Date;return await new o.k({title:s.doc.title,date:c,htmlContent:d,lang:n,publisher:i.DJ,sourceURL:t,uuid:u}).gen()}},3098:function(e,n,t){t.d(n,{Wx:function(){return a}}),t(5271);let r=[{code:"ab",name:"Abkhazian"},{code:"aa",name:"Afar"},{code:"af",name:"Afrikaans"},{code:"ak",name:"Akan"},{code:"sq",name:"Albanian"},{code:"am",name:"Amharic"},{code:"ar",name:"Arabic"},{code:"an",name:"Aragonese"},{code:"hy",name:"Armenian"},{code:"as",name:"Assamese"},{code:"av",name:"Avaric"},{code:"ae",name:"Avestan"},{code:"ay",name:"Aymara"},{code:"az",name:"Azerbaijani"},{code:"bm",name:"Bambara"},{code:"ba",name:"Bashkir"},{code:"eu",name:"Basque"},{code:"be",name:"Belarusian"},{code:"bn",name:"Bengali (Bangla)"},{code:"bh",name:"Bihari"},{code:"bi",name:"Bislama"},{code:"bs",name:"Bosnian"},{code:"br",name:"Breton"},{code:"bg",name:"Bulgarian"},{code:"my",name:"Burmese"},{code:"ca",name:"Catalan"},{code:"ch",name:"Chamorro"},{code:"ce",name:"Chechen"},{code:"ny",name:"Chichewa, Chewa, Nyanja"},{code:"zh",name:"Chinese"},{code:"cv",name:"Chuvash"},{code:"kw",name:"Cornish"},{code:"co",name:"Corsican"},{code:"cr",name:"Cree"},{code:"hr",name:"Croatian"},{code:"cs",name:"Czech"},{code:"da",name:"Danish"},{code:"dv",name:"Divehi, Dhivehi, Maldivian"},{code:"nl",name:"Dutch"},{code:"dz",name:"Dzongkha"},{code:"en",name:"English"},{code:"eo",name:"Esperanto"},{code:"et",name:"Estonian"},{code:"ee",name:"Ewe"},{code:"fo",name:"Faroese"},{code:"fj",name:"Fijian"},{code:"fi",name:"Finnish"},{code:"fr",name:"French"},{code:"ff",name:"Fula, Fulah, Pulaar, Pular"},{code:"gl",name:"Galician"},{code:"gd",name:"Gaelic (Scottish)"},{code:"gv",name:"Gaelic (Manx)"},{code:"ka",name:"Georgian"},{code:"de",name:"German"},{code:"el",name:"Greek"},{code:"kl",name:"Greenlandic"},{code:"gn",name:"Guarani"},{code:"gu",name:"Gujarati"},{code:"ht",name:"Haitian Creole"},{code:"ha",name:"Hausa"},{code:"he",name:"Hebrew"},{code:"hz",name:"Herero"},{code:"hi",name:"Hindi"},{code:"ho",name:"Hiri Motu"},{code:"hu",name:"Hungarian"},{code:"is",name:"Icelandic"},{code:"io",name:"Ido"},{code:"ig",name:"Igbo"},{code:"id, in",name:"Indonesian"},{code:"ia",name:"Interlingua"},{code:"ie",name:"Interlingue"},{code:"iu",name:"Inuktitut"},{code:"ik",name:"Inupiak"},{code:"ga",name:"Irish"},{code:"it",name:"Italian"},{code:"ja",name:"Japanese"},{code:"jv",name:"Javanese"},{code:"kl",name:"Kalaallisut, Greenlandic"},{code:"kn",name:"Kannada"},{code:"kr",name:"Kanuri"},{code:"ks",name:"Kashmiri"},{code:"kk",name:"Kazakh"},{code:"km",name:"Khmer"},{code:"ki",name:"Kikuyu"},{code:"rw",name:"Kinyarwanda (Rwanda)"},{code:"rn",name:"Kirundi"},{code:"ky",name:"Kyrgyz"},{code:"kv",name:"Komi"},{code:"kg",name:"Kongo"},{code:"ko",name:"Korean"},{code:"ku",name:"Kurdish"},{code:"kj",name:"Kwanyama"},{code:"lo",name:"Lao"},{code:"la",name:"Latin"},{code:"lv",name:"Latvian (Lettish)"},{code:"li",name:"Limburgish ( Limburger)"},{code:"ln",name:"Lingala"},{code:"lt",name:"Lithuanian"},{code:"lu",name:"Luga-Katanga"},{code:"lg",name:"Luganda, Ganda"},{code:"lb",name:"Luxembourgish"},{code:"gv",name:"Manx"},{code:"mk",name:"Macedonian"},{code:"mg",name:"Malagasy"},{code:"ms",name:"Malay"},{code:"ml",name:"Malayalam"},{code:"mt",name:"Maltese"},{code:"mi",name:"Maori"},{code:"mr",name:"Marathi"},{code:"mh",name:"Marshallese"},{code:"mo",name:"Moldavian"},{code:"mn",name:"Mongolian"},{code:"na",name:"Nauru"},{code:"nv",name:"Navajo"},{code:"ng",name:"Ndonga"},{code:"nd",name:"Northern Ndebele"},{code:"ne",name:"Nepali"},{code:"no",name:"Norwegian"},{code:"nb",name:"Norwegian bokm\xe5l"},{code:"nn",name:"Norwegian nynorsk"},{code:"ii",name:"Nuosu"},{code:"oc",name:"Occitan"},{code:"oj",name:"Ojibwe"},{code:"cu",name:"Old Church Slavonic, Old Bulgarian"},{code:"or",name:"Oriya"},{code:"om",name:"Oromo (Afaan Oromo)"},{code:"os",name:"Ossetian"},{code:"pi",name:"PÄli"},{code:"ps",name:"Pashto, Pushto"},{code:"fa",name:"Persian (Farsi)"},{code:"pl",name:"Polish"},{code:"pt",name:"Portuguese"},{code:"pa",name:"Punjabi (Eastern)"},{code:"qu",name:"Quechua"},{code:"rm",name:"Romansh"},{code:"ro",name:"Romanian"},{code:"ru",name:"Russian"},{code:"se",name:"Sami"},{code:"sm",name:"Samoan"},{code:"sg",name:"Sango"},{code:"sa",name:"Sanskrit"},{code:"sr",name:"Serbian"},{code:"sh",name:"Serbo-Croatian"},{code:"st",name:"Sesotho"},{code:"tn",name:"Setswana"},{code:"sn",name:"Shona"},{code:"ii",name:"Sichuan Yi"},{code:"sd",name:"Sindhi"},{code:"si",name:"Sinhalese"},{code:"ss",name:"Siswati"},{code:"sk",name:"Slovak"},{code:"sl",name:"Slovenian"},{code:"so",name:"Somali"},{code:"nr",name:"Southern Ndebele"},{code:"es",name:"Spanish"},{code:"su",name:"Sundanese"},{code:"sw",name:"Swahili (Kiswahili)"},{code:"ss",name:"Swati"},{code:"sv",name:"Swedish"},{code:"tl",name:"Tagalog"},{code:"ty",name:"Tahitian"},{code:"tg",name:"Tajik"},{code:"ta",name:"Tamil"},{code:"tt",name:"Tatar"},{code:"te",name:"Telugu"},{code:"th",name:"Thai"},{code:"bo",name:"Tibetan"},{code:"ti",name:"Tigrinya"},{code:"to",name:"Tonga"},{code:"ts",name:"Tsonga"},{code:"tr",name:"Turkish"},{code:"tk",name:"Turkmen"},{code:"tw",name:"Twi"},{code:"ug",name:"Uyghur"},{code:"uk",name:"Ukrainian"},{code:"ur",name:"Urdu"},{code:"uz",name:"Uzbek"},{code:"ve",name:"Venda"},{code:"vi",name:"Vietnamese"},{code:"vo",name:"Volap\xfck"},{code:"wa",name:"Wallon"},{code:"cy",name:"Welsh"},{code:"wo",name:"Wolof"},{code:"fy",name:"Western Frisian"},{code:"xh",name:"Xhosa"},{code:"yi",name:"Yiddish"},{code:"ji",name:"Yiddish"},{code:"yo",name:"Yoruba"},{code:"za",name:"Zhuang, Chuang"},{code:"zu",name:"Zulu"}].map(e=>e.code),a=e=>{if(!e)return;if(e.includes("-")&&(e=e.split("-")[0]),!!e){if(e.includes("_")&&(e=e.split("_")[0]),e){if(e=e.toLowerCase(),!r.includes(e))return;return e}}}},5016:function(e,n,t){t.d(n,{A9:function(){return s},Pk:function(){return d},Pq:function(){return c},sN:function(){return u}});var r=t(3062),a=t(6513),o=t.n(a);t(5271);var i=t(3448);class s extends Error{constructor(){super()}}class d extends Error{constructor(e){super(),(0,r._)(this,"message",void 0),this.message=e}}class u extends Error{constructor(e){super(),(0,r._)(this,"data",void 0),this.data=e}}function c(e){return o().join(i.O.appApiRoot,e)}},6689:function(e,n,t){t.d(n,{pF:function(){return i},xx:function(){return o}});var r=t(3062),a=t(3448);class o extends Error{}class i{static fromNode(e){return new this(e,null)}static fromBrowser(){return new this(null,{account:"anonymous"})}userInfo(){return this.browserUser?this.browserUser:this.nodeSession?this.nodeSession.user?{account:this.nodeSession.user}:void 0:void 0}async userLogin(e,n){return!!this.nodeSession&&!!a.O.accounts.find(t=>t.account===e&&t.password===n)&&(this.nodeSession.user=e,this.nodeSession.save(),!0)}async userLogout(){this.nodeSession&&(this.nodeSession.user=void 0,this.nodeSession.save())}userLogined(){return!!this.userInfo()}async save(){this.nodeSession&&this.nodeSession.save()}constructor(e,n){(0,r._)(this,"nodeSession",void 0),(0,r._)(this,"browserUser",void 0),this.nodeSession=e,this.browserUser=n}}},5128:function(e,n,t){t.d(n,{K3:function(){return i},jI:function(){return a},xS:function(){return o}});var r=t(6092);function a(){return".epub"}function o(e){return{name:e.name,langCode:e.langCode,isFavorited:e.isFavorited,isArchived:!!e.isArchived,uuid:e.uuid,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),isTmp:e.isTmp,position:e.position??null,pageParagraphs:e.pageParagraphs??null}}t(5224);function i(e,n){let{withPageParagraphs:t}=n,a=null;return e.position&&e.pageParagraphs&&(a=function(e,n){let t=n.section,a=(0,r.Sm)(e.slice(0,t).map(e=>e.paragraphCount))+n.paragraph;return a/(0,r.Sm)(e.map(e=>e.paragraphCount))}(e.pageParagraphs,e.position)),{name:e.name,langCode:e.langCode,isFavorited:e.isFavorited,isArchived:!!e.isArchived,uuid:e.uuid,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),isTmp:e.isTmp,position:e.position,pageParagraphs:t?e.pageParagraphs:null,progress:a}}},9835:function(e,n,t){t.d(n,{jU:function(){return a}});var r=t(2257);let a="undefined"!=typeof self;a&&(0,r.Z)(navigator.userAgent).any,a&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a&&navigator.userAgent.toLowerCase().includes("firefox")},6092:function(e,n,t){function r(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e<n?1:-1,r=[];if(t>0)for(let a=e;a<n;a+=t)r.push(a);else if(t<0)for(let a=e;a>n;a+=t)r.push(a);return r}function a(e){return e.filter(e=>!!e)}function o(e,n,t){let r=[...e.entries()],a=(e,n)=>{if("string"==typeof e&&"string"==typeof n)return e.localeCompare(n);if("number"==typeof e&&"number"==typeof n)return e-n;if("boolean"==typeof e&&"boolean"==typeof n)return Number(e)-Number(n);else if(Array.isArray(e)&&Array.isArray(n)){for(let[t,r]of e.entries()){let e=n.at(t);if(void 0===e)break;let o=a(r,e);if(0!==o)return o}return 0}else throw Error(`no support order by type(${typeof e} vs ${typeof n})`)};return r.sort((n,r)=>{let[o,i]=n,[s,d]=r,u=t(i,o,e);return a(u,t(d,s,e))}),"desc"===n&&r.reverse(),r.map(e=>e[1])}function i(e){return e.reduce((e,n)=>e+n,0)}t.d(n,{Sm:function(){return i},Xo:function(){return o},oA:function(){return a},w6:function(){return r}})},9883:function(e,n,t){t.d(n,{RG:function(){return a},lE:function(){return o}});var r=t(9835);function a(e){return r.jU?Uint8Array.from(self.atob(e),e=>e.charCodeAt(0)):Uint8Array.from(Buffer.from(e,"base64"))}function o(e){return new TextDecoder().decode(e)}},5224:function(e,n,t){t.d(n,{BM:function(){return c},PB:function(){return p},Wt:function(){return function e(n){for(let t of n.childNodes)if(l(t)&&("br"===t.tagName.toLowerCase()||e(t)))return!0;return!1}},jZ:function(){return function e(n){let t=[],r=[];for(let a of n.childNodes)r.push(a),l(a)&&("br"===a.tagName.toLowerCase()?(t.push(r),r=[]):(r.pop(),t.push(...e(a))));return r.length>0&&t.push(r),t}},kK:function(){return l},pC:function(){return m},rV:function(){return s},tp:function(){return u},w8:function(){return f}});var r=t(7791),a=t(2479),o=t(3448);let i=Symbol("DOMView");function s(e){let n=new globalThis.JSDOM("",{pretendToBeVisual:!0}),t=new n.window.DOMParser().parseFromString(e,"text/html");return t[i]=n.window,{view:n.window,doc:t}}function d(e){var n,t;return(null==e?void 0:e.defaultView)||(null==e?void 0:null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)||(null==e?void 0:null===(t=e.ownerDocument)||void 0===t?void 0:t[i])}function u(e){let n=d(e);if(!n)throw Error("no dom view");return n}function c(e){let n=d(e);return!!n&&e instanceof n.Text}function l(e){let n=d(e);return!!n&&e instanceof n.HTMLElement}function m(e){let n=d(e);return!!n&&e instanceof n.HTMLImageElement}async function f(e,n){let t=new a.Readability(e).parse();if(!t)throw Error("parse article error");let r=s(t.content),i=r.doc;return"server"===o.O.appMode&&await h(i.body,{baseURL:n}),function(e){let{view:n,doc:t}=e,r=Array.from(t.body.childNodes),a="";for(let e of r)e.nodeType===n.Node.TEXT_NODE?a+=e.textContent:a+=new n.XMLSerializer().serializeToString(e);return a}(r)}async function h(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.baseURL?new URL(n.baseURL):void 0,a=[...e.querySelectorAll("img")],o=new Headers({...n.referrer?{Referer:n.referrer??void 0}:{}});for(let e of a){let n=e.src||e.getAttribute("data-src")||e.getAttribute("data-original");if(!!n){if(!n.startsWith("data:"))try{if(n.startsWith("//")&&t&&(n=`${t.protocol}:${n}`),!(0,r.C)(n))return;let a=await fetch(n,{headers:o}),i=a.headers.get("Content-Type"),s=await a.arrayBuffer();e.src=`data:${i};base64,${Buffer.from(s).toString("base64")}`}catch(e){console.error(e)}}}}function p(e,n){if(!e[0])throw Error("no nodes");let t=d(e[0]);if(!t)throw Error("no dom view");let r=t.document.createElement(n);for(let n of(e[0].before(r),e))r.appendChild(n);return r}},1999:function(e,n,t){t.d(n,{mX:function(){return d}});var r=t(2790),a=t(3747),o=t(1479),i=t(3062),s=new WeakMap;class d{on(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={cb:e,options:{...this.defaultOptions,...n}};return(0,r._)(this,s).push(t),()=>{this.off(t)}}fire(e){for(let n of[...(0,r._)(this,s)])n.options.once&&this.off(n),Promise.resolve(n.cb(e)).catch(console.error)}off(e){let n=(0,r._)(this,s).findIndex(()=>e);-1!==n&&(0,r._)(this,s).splice(n,1)}constructor(e={}){(0,i._)(this,"defaultOptions",void 0),(0,a._)(this,s,{writable:!0,value:void 0}),this.defaultOptions=e,(0,o._)(this,s,[])}}},4310:function(e,n,t){t.d(n,{Y3:function(){return r}});let r=()=>new Promise(e=>{setTimeout(()=>{e()})})},7791:function(e,n,t){t.d(n,{C:function(){return r}});function r(e){try{return new URL(e),!0}catch{return!1}}},33:function(e,n,t){t.d(n,{E8:function(){return s}});var r=t(4601),a=t(1593),o=t(2854);t(5271);let i=(0,r.cn)(null),s=()=>{let e=o.c.get(i);return e?e:a.ZP};(0,r.cn)(null)},7607:function(e,n,t){t("5167");var r=t("7751"),a=t("887"),o=t("8954"),i=t("6903"),s=t("3815"),d=t("6504"),u=t("6689");let c=new d.p("books/cover",{method:"get"}).routeLogined(async e=>{let{req:n,res:t,userInfo:r}=e,a=n.searchParams.get("uuid");if(!a)throw new u.xx("uuid parameter required");let o=await s.E.book(r.account,a),i=await o.cover();if(!i)throw new u.xx("cover in book not found");return i.mediaType&&t.header("Content-Type",i.mediaType.toString()),i.buffer});var l=t("9202"),m=t("5811"),f=t("6444"),h=t("7864"),p=t("5683"),v=t("86"),g=t("3918"),w=t("945"),y=t("6049"),b=t("9619"),k=t("5719"),_=t("4790"),S=t("9878"),A=t("3130"),x=t("5627"),P=t("1054"),C=t("390"),T=t("4667"),L=t("6513"),N=t.n(L);let O=new d.p("books/render",{method:"get",isDynamic:!0}).routeLogined(async e=>{let{req:n,res:t,userInfo:r}=e,[a,...o]=n.paths;if(!a)throw new u.xx("uuid not found");let i=await s.E.book(r.account,a),d=decodeURI(N().join(...o)),c=await i.file(d);if(!c)throw new u.xx("Path in book not found");let l=c.mediaType??T.contentType(N().basename(d));return l&&t.header("Content-Type",l),c.buffer});var j=t("5291"),D=t("4254"),M=t("1142"),I=t("7363"),B=t("1832"),E=t("7071"),F=t("7497"),U=t("6917");let R=[E.t,F.Z,U.O,f.Z,p.z,M.F,m.f,l.t,k.y,_.s,S.N,b.V,C.f,D._,h.c,v.P,x.C,A.u,P.o,i.i,o.I,a.v,y.a,w.L,g.p,I.r,B.X,c,O,j.g];var W=t("5016"),z=t("3062");class K{static fromNode(e,n){let t=new URLSearchParams;for(let[n,r]of Object.entries(e.query))if("string"==typeof r)t.append(n,r);else if(Array.isArray(r))for(let e of r)"string"==typeof e&&t.append(n,e);return new this({searchParams:()=>t,body:()=>e.body,url:()=>e.url,session:()=>u.pF.fromNode(e.session),paths:()=>n})}static fromBrowser(e,n){return new this({searchParams:()=>new URLSearchParams(e.url.split("?")[1]),body:async()=>await e.json(),url:()=>e.url,session:()=>u.pF.fromBrowser(),paths:()=>n})}get searchParams(){return this.getter.searchParams()}get body(){return this.getter.body()}get url(){return this.getter.url()}get paths(){return this.getter.paths()}get session(){return this.getter.session()}constructor(e){(0,z._)(this,"getter",void 0),this.getter=e}}class H{constructor(){(0,z._)(this,"headers",{}),(0,z._)(this,"status",void 0)}}class q{static fromNode(e){return new this({header:(n,t)=>e.setHeader(n,t),status:n=>e.status(n)})}static fromBrowser(e){return new this({header:(n,t)=>e.headers[n]=t.toString(),status:n=>e.status=n})}header(e,n){return this.setter.header(e,n),this}status(e){return this.setter.status(e),this}constructor(e){(0,z._)(this,"setter",void 0),this.setter=e}}self.addEventListener("install",e=>{console.log("service-worker: installed"),e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",e=>{console.log("service-worker: activate event in progress."),e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",e=>{let n=e.request,t=new URL(n.url);if(t.hostname!==location.hostname||!t.pathname.startsWith((0,W.Pq)("")))return;let a=R.find(e=>e.isMatch({method:n.method,pathname:t.pathname}));if(null==a?void 0:a.handler){let o=new H;e.respondWith(Promise.resolve(a.handler({req:K.fromBrowser(n,a.getDynamicPaths(t.pathname)),res:q.fromBrowser(o)})).then(e=>new Response((0,r.Z)(e)?JSON.stringify(e):e,{status:o.status??200,headers:o.headers})).catch(e=>{if(e instanceof u.xx)return new Response(JSON.stringify({message:e.message}),{status:400,headers:o.headers});{let n=e instanceof Error?e.message:null==e?void 0:e.toString();return console.error(e),new Response(JSON.stringify({message:n}),{status:500,headers:o.headers})}}))}})},2854:function(e,n,t){t.d(n,{c:function(){return r}});let r=(0,t(4601).MT)()}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,t.x=()=>{var e=t.O(void 0,["361","434","199","949"],function(){return t("7607")});return e=t.O(e)},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},(()=>{var e,n=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};t.t=function(r,a){if(1&a&&(r=this(r)),8&a||"object"==typeof r&&r&&(4&a&&r.__esModule||16&a&&"function"==typeof r.then))return r;var o=Object.create(null);t.r(o);var i={};e=e||[null,n({}),n([]),n(n)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach(function(e){i[e]=function(){return r[e]}});return i.default=function(){return r},t.d(o,i),o}})(),t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce(function(n,r){return t.f[r](e,n),n},[]))},t.u=function(e){return""+("361"===e?"lib-react":e)+"."+({199:"e32f2fdc",361:"023f7fec",434:"ebcfedb9",949:"5af5cf8b"})[e]+".js"},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];t.O=function(n,r,a,o){if(r){o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[r,a,o];return}for(var s=1/0,i=0;i<e.length;i++){for(var r=e[i][0],a=e[i][1],o=e[i][2],d=!0,u=0;u<r.length;u++)(!1&o||s>=o)&&Object.keys(t.O).every(function(e){return t.O[e](r[u])})?r.splice(u--,1):(d=!1,o<s&&(s=o));if(d){e.splice(i--,1);var c=a();void 0!==c&&(n=c)}}return n}})(),t.p="/auditory-reader/",t.rv=function(){return"1.0.8"},(()=>{var e=t.x;t.x=function(){return Promise.all(["361","434","199","949"].map(t.e,t)).then(e)}})(),(()=>{var e={762:1};t.f.i=function(n,r){!e[n]&&importScripts(t.p+t.u(n))};var n=self.webpackChunkauditory_reader=self.webpackChunkauditory_reader||[],r=n.push.bind(n);n.push=function(n){var a=n[0],o=n[1],i=n[2];for(var s in o)t.o(o,s)&&(t.m[s]=o[s]);for(i&&i(t);a.length;)e[a.pop()]=1;r(n)}})(),t.ruid="bundler=rspack@1.0.8",t.x()})();